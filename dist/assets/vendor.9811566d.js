var Ih=function(){function n(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}return n.prototype.preventDefault=function(){this.defaultPrevented=!0},n.prototype.stopPropagation=function(){this.propagationStopped=!0},n}(),ue=Ih,fe={PROPERTYCHANGE:"propertychange"},Oh=function(){function n(){this.disposed=!1}return n.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.disposeInternal())},n.prototype.disposeInternal=function(){},n}(),rr=Oh;function Rh(n,e,t){for(var i,r,a=t||vi,s=0,o=n.length,h=!1;s<o;)i=s+(o-s>>1),r=+a(n[i],e),r<0?s=i+1:(o=i,h=!r);return h?s:~s}function vi(n,e){return n>e?1:n<e?-1:0}function Oa(n,e,t){var i=n.length;if(n[0]<=e)return 0;if(e<=n[i-1])return i-1;var r=void 0;if(t>0){for(r=1;r<i;++r)if(n[r]<e)return r-1}else if(t<0){for(r=1;r<i;++r)if(n[r]<=e)return r}else for(r=1;r<i;++r){if(n[r]==e)return r;if(n[r]<e)return typeof t=="function"?t(e,n[r-1],n[r])>0?r-1:r:n[r-1]-e<e-n[r]?r-1:r}return i-1}function wh(n,e,t){for(;e<t;){var i=n[e];n[e]=n[t],n[t]=i,++e,--t}}function Ut(n,e){for(var t=Array.isArray(e)?e:[e],i=t.length,r=0;r<i;r++)n[n.length]=t[r]}function Ae(n,e){var t=n.length;if(t!==e.length)return!1;for(var i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function Le(){return!0}function nn(){return!1}function ce(){}function Sh(n){var e=!1,t,i,r;return function(){var a=Array.prototype.slice.call(arguments);return(!e||this!==r||!Ae(a,i))&&(e=!0,r=this,i=a,t=n.apply(this,arguments)),t}}var pt=typeof Object.assign=="function"?Object.assign:function(n,e){if(n==null)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(n),i=1,r=arguments.length;i<r;++i){var a=arguments[i];if(a!=null)for(var s in a)a.hasOwnProperty(s)&&(t[s]=a[s])}return t};function pi(n){for(var e in n)delete n[e]}var Ra=typeof Object.values=="function"?Object.values:function(n){var e=[];for(var t in n)e.push(n[t]);return e};function Ne(n){var e;for(e in n)return!1;return!e}var Th=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ph=function(n){Th(e,n);function e(t){var i=n.call(this)||this;return i.eventTarget_=t,i.pendingRemovals_=null,i.dispatching_=null,i.listeners_=null,i}return e.prototype.addEventListener=function(t,i){if(!(!t||!i)){var r=this.listeners_||(this.listeners_={}),a=r[t]||(r[t]=[]);a.indexOf(i)===-1&&a.push(i)}},e.prototype.dispatchEvent=function(t){var i=typeof t=="string"?new ue(t):t,r=i.type;i.target||(i.target=this.eventTarget_||this);var a=this.listeners_&&this.listeners_[r],s;if(a){var o=this.dispatching_||(this.dispatching_={}),h=this.pendingRemovals_||(this.pendingRemovals_={});r in o||(o[r]=0,h[r]=0),++o[r];for(var l=0,u=a.length;l<u;++l)if("handleEvent"in a[l]?s=a[l].handleEvent(i):s=a[l].call(this,i),s===!1||i.propagationStopped){s=!1;break}if(--o[r],o[r]===0){var f=h[r];for(delete h[r];f--;)this.removeEventListener(r,ce);delete o[r]}return s}},e.prototype.disposeInternal=function(){this.listeners_&&pi(this.listeners_)},e.prototype.getListeners=function(t){return this.listeners_&&this.listeners_[t]||void 0},e.prototype.hasListener=function(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1},e.prototype.removeEventListener=function(t,i){var r=this.listeners_&&this.listeners_[t];if(r){var a=r.indexOf(i);a!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(r[a]=ce,++this.pendingRemovals_[t]):(r.splice(a,1),r.length===0&&delete this.listeners_[t]))}},e}(rr),_i=Ph,b={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function B(n,e,t,i,r){if(i&&i!==n&&(t=t.bind(i)),r){var a=t;t=function(){n.removeEventListener(e,t),a.apply(this,arguments)}}var s={target:n,type:e,listener:t};return n.addEventListener(e,t),s}function rn(n,e,t,i){return B(n,e,t,i,!0)}function Z(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),pi(n))}var Ah=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),an=function(n){Ah(e,n);function e(){var t=n.call(this)||this;return t.on=t.onInternal,t.once=t.onceInternal,t.un=t.unInternal,t.revision_=0,t}return e.prototype.changed=function(){++this.revision_,this.dispatchEvent(b.CHANGE)},e.prototype.getRevision=function(){return this.revision_},e.prototype.onInternal=function(t,i){if(Array.isArray(t)){for(var r=t.length,a=new Array(r),s=0;s<r;++s)a[s]=B(this,t[s],i);return a}else return B(this,t,i)},e.prototype.onceInternal=function(t,i){var r;if(Array.isArray(t)){var a=t.length;r=new Array(a);for(var s=0;s<a;++s)r[s]=rn(this,t[s],i)}else r=rn(this,t,i);return i.ol_key=r,r},e.prototype.unInternal=function(t,i){var r=i.ol_key;if(r)Lh(r);else if(Array.isArray(t))for(var a=0,s=t.length;a<s;++a)this.removeEventListener(t[a],i);else this.removeEventListener(t,i)},e}(_i);an.prototype.on;an.prototype.once;an.prototype.un;function Lh(n){if(Array.isArray(n))for(var e=0,t=n.length;e<t;++e)Z(n[e]);else Z(n)}var wa=an;function A(){return function(){throw new Error("Unimplemented abstract method.")}()}var Nh=0;function it(n){return n.ol_uid||(n.ol_uid=String(++Nh))}var Dh="6.9.0",Sa=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ta=function(n){Sa(e,n);function e(t,i,r){var a=n.call(this,t)||this;return a.key=i,a.oldValue=r,a}return e}(ue),Fh=function(n){Sa(e,n);function e(t){var i=n.call(this)||this;return i.on,i.once,i.un,it(i),i.values_=null,t!==void 0&&i.setProperties(t),i}return e.prototype.get=function(t){var i;return this.values_&&this.values_.hasOwnProperty(t)&&(i=this.values_[t]),i},e.prototype.getKeys=function(){return this.values_&&Object.keys(this.values_)||[]},e.prototype.getProperties=function(){return this.values_&&pt({},this.values_)||{}},e.prototype.hasProperties=function(){return!!this.values_},e.prototype.notify=function(t,i){var r;r="change:"+t,this.dispatchEvent(new Ta(r,t,i)),r=fe.PROPERTYCHANGE,this.dispatchEvent(new Ta(r,t,i))},e.prototype.addChangeListener=function(t,i){this.addEventListener("change:"+t,i)},e.prototype.removeChangeListener=function(t,i){this.removeEventListener("change:"+t,i)},e.prototype.set=function(t,i,r){var a=this.values_||(this.values_={});if(r)a[t]=i;else{var s=a[t];a[t]=i,s!==i&&this.notify(t,s)}},e.prototype.setProperties=function(t,i){for(var r in t)this.set(r,t[r],i)},e.prototype.applyProperties=function(t){!t.values_||pt(this.values_||(this.values_={}),t.values_)},e.prototype.unset=function(t,i){if(this.values_&&t in this.values_){var r=this.values_[t];delete this.values_[t],Ne(this.values_)&&(this.values_=null),i||this.notify(t,r)}},e}(wa),Pt=Fh,Gh=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),bh=function(n){Gh(e,n);function e(t){var i=this,r="v"+Dh.split("-")[0],a="Assertion failed. See https://openlayers.org/en/"+r+"/doc/errors/#"+t+" for details.";return i=n.call(this,a)||this,i.code=t,i.name="AssertionError",i.message=a,i}return e}(Error),Pa=bh;function X(n,e){if(!n)throw new Pa(e)}var kh=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Bh=function(n){kh(e,n);function e(t){var i=n.call(this)||this;if(i.on,i.once,i.un,i.id_=void 0,i.geometryName_="geometry",i.style_=null,i.styleFunction_=void 0,i.geometryChangeKey_=null,i.addChangeListener(i.geometryName_,i.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){var r=t;i.setGeometry(r)}else{var a=t;i.setProperties(a)}return i}return e.prototype.clone=function(){var t=new e(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());var i=this.getGeometry();i&&t.setGeometry(i.clone());var r=this.getStyle();return r&&t.setStyle(r),t},e.prototype.getGeometry=function(){return this.get(this.geometryName_)},e.prototype.getId=function(){return this.id_},e.prototype.getGeometryName=function(){return this.geometryName_},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.handleGeometryChange_=function(){this.changed()},e.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(Z(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=B(t,b.CHANGE,this.handleGeometryChange_,this)),this.changed()},e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},e.prototype.setStyle=function(t){this.style_=t,this.styleFunction_=t?jh(t):void 0,this.changed()},e.prototype.setId=function(t){this.id_=t,this.changed()},e.prototype.setGeometryName=function(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()},e}(Pt);function jh(n){if(typeof n=="function")return n;var e;if(Array.isArray(n))e=n;else{X(typeof n.getZIndex=="function",41);var t=n;e=[t]}return function(){return e}}var $h=Bh,De={RADIANS:"radians",DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},de={};de[De.RADIANS]=6370997/(2*Math.PI);de[De.DEGREES]=2*Math.PI*6370997/360;de[De.FEET]=.3048;de[De.METERS]=1;de[De.USFEET]=1200/3937;var Fe=De,Ge=typeof navigator!="undefined"&&typeof navigator.userAgent!="undefined"?navigator.userAgent.toLowerCase():"",Uh=Ge.indexOf("firefox")!==-1;Ge.indexOf("safari")!==-1&&Ge.indexOf("chrom")==-1;var zh=Ge.indexOf("webkit")!==-1&&Ge.indexOf("edge")==-1,Xh=Ge.indexOf("macintosh")!==-1,Aa=typeof devicePixelRatio!="undefined"?devicePixelRatio:1,sn=typeof WorkerGlobalScope!="undefined"&&typeof OffscreenCanvas!="undefined"&&self instanceof WorkerGlobalScope,Wh=typeof Image!="undefined"&&Image.prototype.decode,La=function(){var n=!1;try{var e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(t){}return n}();new Array(6);function At(){return[1,0,0,1,0,0]}function Yh(n,e,t,i,r,a,s){return n[0]=e,n[1]=t,n[2]=i,n[3]=r,n[4]=a,n[5]=s,n}function Vh(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function ot(n,e){var t=e[0],i=e[1];return e[0]=n[0]*t+n[2]*i+n[4],e[1]=n[1]*t+n[3]*i+n[5],e}function Kh(n,e,t){return Yh(n,e,0,0,t,0,0)}function ve(n,e,t,i,r,a,s,o){var h=Math.sin(a),l=Math.cos(a);return n[0]=i*l,n[1]=r*h,n[2]=-i*h,n[3]=r*l,n[4]=s*i*l-o*i*h+e,n[5]=s*r*h+o*r*l+t,n}function Na(n,e){var t=qh(e);X(t!==0,32);var i=e[0],r=e[1],a=e[2],s=e[3],o=e[4],h=e[5];return n[0]=s/t,n[1]=-r/t,n[2]=-a/t,n[3]=i/t,n[4]=(a*h-s*o)/t,n[5]=-(i*h-r*o)/t,n}function qh(n){return n[0]*n[3]-n[1]*n[2]}var Da;function Hh(n){var e="matrix("+n.join(", ")+")";if(sn)return e;var t=Da||(Da=document.createElement("div"));return t.style.transform=e,t.style.transform}var ht={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function ar(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function Fa(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function pe(n,e,t){var i,r;return e<n[0]?i=n[0]-e:n[2]<e?i=e-n[2]:i=0,t<n[1]?r=n[1]-t:n[3]<t?r=t-n[3]:r=0,i*i+r*r}function Ga(n,e){return sr(n,e[0],e[1])}function be(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function sr(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function or(n,e){var t=n[0],i=n[1],r=n[2],a=n[3],s=e[0],o=e[1],h=ht.UNKNOWN;return s<t?h=h|ht.LEFT:s>r&&(h=h|ht.RIGHT),o<i?h=h|ht.BELOW:o>a&&(h=h|ht.ABOVE),h===ht.UNKNOWN&&(h=ht.INTERSECTING),h}function Qt(){return[1/0,1/0,-1/0,-1/0]}function ke(n,e,t,i,r){return r?(r[0]=n,r[1]=e,r[2]=t,r[3]=i,r):[n,e,t,i]}function gi(n){return ke(1/0,1/0,-1/0,-1/0,n)}function Zh(n,e){var t=n[0],i=n[1];return ke(t,i,t,i,e)}function ba(n,e,t,i,r){var a=gi(r);return ka(a,n,e,t,i)}function on(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function Jh(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function Qh(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function ka(n,e,t,i,r){for(;t<i;t+=r)tl(n,e[t],e[t+1]);return n}function tl(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function el(n,e){var t;return t=e(Ba(n)),t||(t=e(ja(n)),t)||(t=e(Ua(n)),t)||(t=e($a(n)),t)?t:!1}function Ba(n){return[n[0],n[1]]}function ja(n){return[n[2],n[1]]}function Be(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function hr(n,e,t,i,r){var a=e*i[0]/2,s=e*i[1]/2,o=Math.cos(t),h=Math.sin(t),l=a*o,u=a*h,f=s*o,c=s*h,d=n[0],v=n[1],p=d-l+c,_=d-l-c,y=d+l-c,g=d+l+c,m=v-u-f,M=v-u+f,E=v+u+f,C=v+u-f;return ke(Math.min(p,_,y,g),Math.min(m,M,E,C),Math.max(p,_,y,g),Math.max(m,M,E,C),r)}function _e(n){return n[3]-n[1]}function il(n,e,t){var i=t||Qt();return It(n,e)?(n[0]>e[0]?i[0]=n[0]:i[0]=e[0],n[1]>e[1]?i[1]=n[1]:i[1]=e[1],n[2]<e[2]?i[2]=n[2]:i[2]=e[2],n[3]<e[3]?i[3]=n[3]:i[3]=e[3]):gi(i),i}function $a(n){return[n[0],n[3]]}function Ua(n){return[n[2],n[3]]}function xt(n){return n[2]-n[0]}function It(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function za(n){return n[2]<n[0]||n[3]<n[1]}function nl(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function rl(n,e,t){var i=!1,r=or(n,e),a=or(n,t);if(r===ht.INTERSECTING||a===ht.INTERSECTING)i=!0;else{var s=n[0],o=n[1],h=n[2],l=n[3],u=e[0],f=e[1],c=t[0],d=t[1],v=(d-f)/(c-u),p=void 0,_=void 0;!!(a&ht.ABOVE)&&!(r&ht.ABOVE)&&(p=c-(d-l)/v,i=p>=s&&p<=h),!i&&!!(a&ht.RIGHT)&&!(r&ht.RIGHT)&&(_=d-(c-h)*v,i=_>=o&&_<=l),!i&&!!(a&ht.BELOW)&&!(r&ht.BELOW)&&(p=c-(d-o)/v,i=p>=s&&p<=h),!i&&!!(a&ht.LEFT)&&!(r&ht.LEFT)&&(_=d-(c-s)*v,i=_>=o&&_<=l)}return i}function al(n,e){var t=e.getExtent(),i=Be(n);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){var r=xt(t),a=Math.floor((i[0]-t[0])/r),s=a*r;n[0]-=s,n[2]-=s}return n}var sl=function(){function n(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}return n.prototype.canWrapX=function(){return this.canWrapX_},n.prototype.getCode=function(){return this.code_},n.prototype.getExtent=function(){return this.extent_},n.prototype.getUnits=function(){return this.units_},n.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||de[this.units_]},n.prototype.getWorldExtent=function(){return this.worldExtent_},n.prototype.getAxisOrientation=function(){return this.axisOrientation_},n.prototype.isGlobal=function(){return this.global_},n.prototype.setGlobal=function(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)},n.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},n.prototype.setDefaultTileGrid=function(e){this.defaultTileGrid_=e},n.prototype.setExtent=function(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)},n.prototype.setWorldExtent=function(e){this.worldExtent_=e},n.prototype.setGetPointResolution=function(e){this.getPointResolutionFunc_=e},n.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},n}(),lr=sl;function at(n,e,t){return Math.min(Math.max(n,e),t)}var ol=function(){var n;return"cosh"in Math?n=Math.cosh:n=function(e){var t=Math.exp(e);return(t+1/t)/2},n}();function hl(n,e,t,i,r,a){var s=r-t,o=a-i;if(s!==0||o!==0){var h=((n-t)*s+(e-i)*o)/(s*s+o*o);h>1?(t=r,i=a):h>0&&(t+=s*h,i+=o*h)}return ge(n,e,t,i)}function ge(n,e,t,i){var r=t-n,a=i-e;return r*r+a*a}function ll(n){return n*Math.PI/180}function Xa(n,e){var t=n%e;return t*e<0?t+e:t}function zt(n,e,t){return n+t*(e-n)}var ul=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),yi=6378137,je=Math.PI*yi,fl=[-je,-je,je,je],cl=[-180,-85,180,85],hn=yi*Math.log(Math.tan(Math.PI/2)),$e=function(n){ul(e,n);function e(t){return n.call(this,{code:t,units:Fe.METERS,extent:fl,global:!0,worldExtent:cl,getPointResolution:function(i,r){return i/ol(r[1]/yi)}})||this}return e}(lr),Wa=[new $e("EPSG:3857"),new $e("EPSG:102100"),new $e("EPSG:102113"),new $e("EPSG:900913"),new $e("http://www.opengis.net/def/crs/EPSG/0/3857"),new $e("http://www.opengis.net/gml/srs/epsg.xml#3857")];function dl(n,e,t){var i=n.length,r=t>1?t:2,a=e;a===void 0&&(r>2?a=n.slice():a=new Array(i));for(var s=0;s<i;s+=r){a[s]=je*n[s]/180;var o=yi*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>hn?o=hn:o<-hn&&(o=-hn),a[s+1]=o}return a}function vl(n,e,t){var i=n.length,r=t>1?t:2,a=e;a===void 0&&(r>2?a=n.slice():a=new Array(i));for(var s=0;s<i;s+=r)a[s]=180*n[s]/je,a[s+1]=360*Math.atan(Math.exp(n[s+1]/yi))/Math.PI-90;return a}var pl=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),_l=6378137,Ya=[-180,-90,180,90],gl=Math.PI*_l/180,ye=function(n){pl(e,n);function e(t,i){return n.call(this,{code:t,units:Fe.DEGREES,extent:Ya,axisOrientation:i,global:!0,metersPerUnit:gl,worldExtent:Ya})||this}return e}(lr),Va=[new ye("CRS:84"),new ye("EPSG:4326","neu"),new ye("urn:ogc:def:crs:OGC:1.3:CRS84"),new ye("urn:ogc:def:crs:OGC:2:84"),new ye("http://www.opengis.net/def/crs/OGC/1.3/CRS84","neu"),new ye("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new ye("http://www.opengis.net/def/crs/EPSG/0/4326","neu")],ur={};function yl(n){return ur[n]||ur[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function ml(n,e){ur[n]=e}var Ue={};function ze(n,e,t){var i=n.getCode(),r=e.getCode();i in Ue||(Ue[i]={}),Ue[i][r]=t}function Ka(n,e){var t;return n in Ue&&e in Ue[n]&&(t=Ue[n][e]),t}var T={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"};function Ml(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function fr(n,e){for(var t=!0,i=n.length-1;i>=0;--i)if(n[i]!=e[i]){t=!1;break}return t}function cr(n,e){var t=Math.cos(e),i=Math.sin(e),r=n[0]*t-n[1]*i,a=n[1]*t+n[0]*i;return n[0]=r,n[1]=a,n}function El(n,e){return n[0]*=e,n[1]*=e,n}function qa(n,e){if(e.canWrapX()){var t=xt(e.getExtent()),i=Ha(n,e,t);i&&(n[0]-=i*t)}return n}function Ha(n,e,t){var i=e.getExtent(),r=0;if(e.canWrapX()&&(n[0]<i[0]||n[0]>i[2])){var a=t||xt(i);r=Math.floor((n[0]-i[0])/a)}return r}function dr(n,e,t){var i;if(e!==void 0){for(var r=0,a=n.length;r<a;++r)e[r]=n[r];i=e}else i=n.slice();return i}function xl(n,e,t){if(e!==void 0&&n!==e){for(var i=0,r=n.length;i<r;++i)e[i]=n[i];n=e}return n}function Za(n){ml(n.getCode(),n),ze(n,n,dr)}function Cl(n){n.forEach(Za)}function st(n){return typeof n=="string"?yl(n):n||null}function vr(n){Cl(n),n.forEach(function(e){n.forEach(function(t){e!==t&&ze(e,t,dr)})})}function Il(n,e,t,i){n.forEach(function(r){e.forEach(function(a){ze(r,a,t),ze(a,r,i)})})}function pr(n,e){return n?typeof n=="string"?st(n):n:st(e)}function Ja(n){return function(e,t,i){for(var r=e.length,a=i!==void 0?i:2,s=t!==void 0?t:new Array(r),o=0;o<r;o+=a){var h=n([e[o],e[o+1]]);s[o]=h[0],s[o+1]=h[1];for(var l=a-1;l>=2;--l)s[o+l]=e[o+l]}return s}}function Ol(n,e,t,i){var r=st(n),a=st(e);ze(r,a,Ja(t)),ze(a,r,Ja(i))}function Rl(n,e){if(n===e)return!0;var t=n.getUnits()===e.getUnits();if(n.getCode()===e.getCode())return t;var i=Qa(n,e);return i===dr&&t}function Qa(n,e){var t=n.getCode(),i=e.getCode(),r=Ka(t,i);return r||(r=xl),r}function ts(n,e){var t=st(n),i=st(e);return Qa(t,i)}var wl=null;function Sl(){return wl}function _r(n,e){return n}function Xt(n,e){return n}function es(n,e){return n}function mi(n,e){return n}function is(n,e,t){return function(i){var r=i[0],a=i[1],s,o;if(n.canWrapX()){var h=n.getExtent(),l=xt(h);o=Ha(i,n,l),o&&(r=r-o*l),r=at(r,h[0],h[2]),a=at(a,h[1],h[3]),s=t([r,a])}else s=t(i);return o&&e.canWrapX()&&(s[0]+=o*xt(e.getExtent())),s}}function Tl(){vr(Wa),vr(Va),Il(Va,Wa,dl,vl)}Tl();function me(n,e,t,i,r,a){for(var s=a||[],o=0,h=e;h<t;h+=i){var l=n[h],u=n[h+1];s[o++]=r[0]*l+r[2]*u+r[4],s[o++]=r[1]*l+r[3]*u+r[5]}return a&&s.length!=o&&(s.length=o),s}function ns(n,e,t,i,r,a,s){for(var o=s||[],h=Math.cos(r),l=Math.sin(r),u=a[0],f=a[1],c=0,d=e;d<t;d+=i){var v=n[d]-u,p=n[d+1]-f;o[c++]=u+v*h-p*l,o[c++]=f+v*l+p*h;for(var _=d+2;_<d+i;++_)o[c++]=n[_]}return s&&o.length!=c&&(o.length=c),o}function Pl(n,e,t,i,r,a,s,o){for(var h=o||[],l=s[0],u=s[1],f=0,c=e;c<t;c+=i){var d=n[c]-l,v=n[c+1]-u;h[f++]=l+r*d,h[f++]=u+a*v;for(var p=c+2;p<c+i;++p)h[f++]=n[p]}return o&&h.length!=f&&(h.length=f),h}function Al(n,e,t,i,r,a,s){for(var o=s||[],h=0,l=e;l<t;l+=i){o[h++]=n[l]+r,o[h++]=n[l+1]+a;for(var u=l+2;u<l+i;++u)o[h++]=n[u]}return s&&o.length!=h&&(o.length=h),o}var Ll=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),rs=At(),Nl=function(n){Ll(e,n);function e(){var t=n.call(this)||this;return t.extent_=Qt(),t.extentRevision_=-1,t.simplifiedGeometryMaxMinSquaredTolerance=0,t.simplifiedGeometryRevision=0,t.simplifyTransformedInternal=Sh(function(i,r,a){if(!a)return this.getSimplifiedGeometry(r);var s=this.clone();return s.applyTransform(a),s.getSimplifiedGeometry(r)}),t}return e.prototype.simplifyTransformed=function(t,i){return this.simplifyTransformedInternal(this.getRevision(),t,i)},e.prototype.clone=function(){return A()},e.prototype.closestPointXY=function(t,i,r,a){return A()},e.prototype.containsXY=function(t,i){var r=this.getClosestPoint([t,i]);return r[0]===t&&r[1]===i},e.prototype.getClosestPoint=function(t,i){var r=i||[NaN,NaN];return this.closestPointXY(t[0],t[1],r,1/0),r},e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},e.prototype.computeExtent=function(t){return A()},e.prototype.getExtent=function(t){if(this.extentRevision_!=this.getRevision()){var i=this.computeExtent(this.extent_);(isNaN(i[0])||isNaN(i[1]))&&gi(i),this.extentRevision_=this.getRevision()}return nl(this.extent_,t)},e.prototype.rotate=function(t,i){A()},e.prototype.scale=function(t,i,r){A()},e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},e.prototype.getSimplifiedGeometry=function(t){return A()},e.prototype.getType=function(){return A()},e.prototype.applyTransform=function(t){A()},e.prototype.intersectsExtent=function(t){return A()},e.prototype.translate=function(t,i){A()},e.prototype.transform=function(t,i){var r=st(t),a=r.getUnits()==Fe.TILE_PIXELS?function(s,o,h){var l=r.getExtent(),u=r.getWorldExtent(),f=_e(u)/_e(l);return ve(rs,u[0],u[3],f,-f,0,0,0),me(s,0,s.length,h,rs,o),ts(r,i)(s,o,h)}:ts(r,i);return this.applyTransform(a),this},e}(Pt),as=Nl,Dl=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Fl=function(n){Dl(e,n);function e(t){var i=n.call(this)||this;return i.geometries_=t||null,i.changeEventsKeys_=[],i.listenGeometriesChange_(),i}return e.prototype.unlistenGeometriesChange_=function(){this.changeEventsKeys_.forEach(Z),this.changeEventsKeys_.length=0},e.prototype.listenGeometriesChange_=function(){if(!!this.geometries_)for(var t=0,i=this.geometries_.length;t<i;++t)this.changeEventsKeys_.push(B(this.geometries_[t],b.CHANGE,this.changed,this))},e.prototype.clone=function(){var t=new e(null);return t.setGeometries(this.geometries_),t.applyProperties(this),t},e.prototype.closestPointXY=function(t,i,r,a){if(a<pe(this.getExtent(),t,i))return a;for(var s=this.geometries_,o=0,h=s.length;o<h;++o)a=s[o].closestPointXY(t,i,r,a);return a},e.prototype.containsXY=function(t,i){for(var r=this.geometries_,a=0,s=r.length;a<s;++a)if(r[a].containsXY(t,i))return!0;return!1},e.prototype.computeExtent=function(t){gi(t);for(var i=this.geometries_,r=0,a=i.length;r<a;++r)Jh(t,i[r].getExtent());return t},e.prototype.getGeometries=function(){return ss(this.geometries_)},e.prototype.getGeometriesArray=function(){return this.geometries_},e.prototype.getGeometriesArrayRecursive=function(){for(var t=[],i=this.geometries_,r=0,a=i.length;r<a;++r)i[r].getType()===this.getType()?t=t.concat(i[r].getGeometriesArrayRecursive()):t.push(i[r]);return t},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;for(var i=[],r=this.geometries_,a=!1,s=0,o=r.length;s<o;++s){var h=r[s],l=h.getSimplifiedGeometry(t);i.push(l),l!==h&&(a=!0)}if(a){var u=new e(null);return u.setGeometriesArray(i),u}else return this.simplifiedGeometryMaxMinSquaredTolerance=t,this},e.prototype.getType=function(){return T.GEOMETRY_COLLECTION},e.prototype.intersectsExtent=function(t){for(var i=this.geometries_,r=0,a=i.length;r<a;++r)if(i[r].intersectsExtent(t))return!0;return!1},e.prototype.isEmpty=function(){return this.geometries_.length===0},e.prototype.rotate=function(t,i){for(var r=this.geometries_,a=0,s=r.length;a<s;++a)r[a].rotate(t,i);this.changed()},e.prototype.scale=function(t,i,r){var a=r;a||(a=Be(this.getExtent()));for(var s=this.geometries_,o=0,h=s.length;o<h;++o)s[o].scale(t,i,a);this.changed()},e.prototype.setGeometries=function(t){this.setGeometriesArray(ss(t))},e.prototype.setGeometriesArray=function(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()},e.prototype.applyTransform=function(t){for(var i=this.geometries_,r=0,a=i.length;r<a;++r)i[r].applyTransform(t);this.changed()},e.prototype.translate=function(t,i){for(var r=this.geometries_,a=0,s=r.length;a<s;++a)r[a].translate(t,i);this.changed()},e.prototype.disposeInternal=function(){this.unlistenGeometriesChange_(),n.prototype.disposeInternal.call(this)},e}(as);function ss(n){for(var e=[],t=0,i=n.length;t<i;++t)e.push(n[t].clone());return e}var Gl=Fl,bl=function(){function n(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.supportedMediaTypes=null}return n.prototype.getReadOptions=function(e,t){var i;if(t){var r=t.dataProjection?st(t.dataProjection):this.readProjection(e);t.extent&&r&&r.getUnits()===Fe.TILE_PIXELS&&(r=st(r),r.setWorldExtent(t.extent)),i={dataProjection:r,featureProjection:t.featureProjection}}return this.adaptOptions(i)},n.prototype.adaptOptions=function(e){return pt({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},e)},n.prototype.getType=function(){return A()},n.prototype.readFeature=function(e,t){return A()},n.prototype.readFeatures=function(e,t){return A()},n.prototype.readGeometry=function(e,t){return A()},n.prototype.readProjection=function(e){return A()},n.prototype.writeFeature=function(e,t){return A()},n.prototype.writeFeatures=function(e,t){return A()},n.prototype.writeGeometry=function(e,t){return A()},n}();function os(n,e,t){var i=t?st(t.featureProjection):null,r=t?st(t.dataProjection):null,a;if(i&&r&&!Rl(i,r)?a=(e?n.clone():n).transform(e?i:r,e?r:i):a=n,e&&t&&t.decimals!==void 0){var s=Math.pow(10,t.decimals),o=function(h){for(var l=0,u=h.length;l<u;++l)h[l]=Math.round(h[l]*s)/s;return h};a===n&&(a=n.clone()),a.applyTransform(o)}return a}var Xe={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"},kl=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Bl=function(n){kl(e,n);function e(){return n.call(this)||this}return e.prototype.getType=function(){return Xe.JSON},e.prototype.readFeature=function(t,i){return this.readFeatureFromObject(ln(t),this.getReadOptions(t,i))},e.prototype.readFeatures=function(t,i){return this.readFeaturesFromObject(ln(t),this.getReadOptions(t,i))},e.prototype.readFeatureFromObject=function(t,i){return A()},e.prototype.readFeaturesFromObject=function(t,i){return A()},e.prototype.readGeometry=function(t,i){return this.readGeometryFromObject(ln(t),this.getReadOptions(t,i))},e.prototype.readGeometryFromObject=function(t,i){return A()},e.prototype.readProjection=function(t){return this.readProjectionFromObject(ln(t))},e.prototype.readProjectionFromObject=function(t){return A()},e.prototype.writeFeature=function(t,i){return JSON.stringify(this.writeFeatureObject(t,i))},e.prototype.writeFeatureObject=function(t,i){return A()},e.prototype.writeFeatures=function(t,i){return JSON.stringify(this.writeFeaturesObject(t,i))},e.prototype.writeFeaturesObject=function(t,i){return A()},e.prototype.writeGeometry=function(t,i){return JSON.stringify(this.writeGeometryObject(t,i))},e.prototype.writeGeometryObject=function(t,i){return A()},e}(bl);function ln(n){if(typeof n=="string"){var e=JSON.parse(n);return e||null}else return n!==null?n:null}var jl=Bl,nt={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"},$l=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ul=function(n){$l(e,n);function e(){var t=n.call(this)||this;return t.layout=nt.XY,t.stride=2,t.flatCoordinates=null,t}return e.prototype.computeExtent=function(t){return ba(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinates=function(){return A()},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var i=this.getSimplifiedGeometryInternal(t),r=i.getFlatCoordinates();return r.length<this.flatCoordinates.length?i:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,i){this.stride=hs(t),this.layout=t,this.flatCoordinates=i},e.prototype.setCoordinates=function(t,i){A()},e.prototype.setLayout=function(t,i,r){var a;if(t)a=hs(t);else{for(var s=0;s<r;++s)if(i.length===0){this.layout=nt.XY,this.stride=2;return}else i=i[0];a=i.length,t=zl(a)}this.layout=t,this.stride=a},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,i){var r=this.getFlatCoordinates();if(r){var a=this.getStride();ns(r,0,r.length,a,t,i,r),this.changed()}},e.prototype.scale=function(t,i,r){var a=i;a===void 0&&(a=t);var s=r;s||(s=Be(this.getExtent()));var o=this.getFlatCoordinates();if(o){var h=this.getStride();Pl(o,0,o.length,h,t,a,s,o),this.changed()}},e.prototype.translate=function(t,i){var r=this.getFlatCoordinates();if(r){var a=this.getStride();Al(r,0,r.length,a,t,i,r),this.changed()}},e}(as);function zl(n){var e;return n==2?e=nt.XY:n==3?e=nt.XYZ:n==4&&(e=nt.XYZM),e}function hs(n){var e;return n==nt.XY?e=2:n==nt.XYZ||n==nt.XYM?e=3:n==nt.XYZM&&(e=4),e}function Xl(n,e,t){var i=n.getFlatCoordinates();if(i){var r=n.getStride();return me(i,0,i.length,r,e,t)}else return null}var Me=Ul;function ls(n,e,t,i,r,a,s){var o=n[e],h=n[e+1],l=n[t]-o,u=n[t+1]-h,f;if(l===0&&u===0)f=e;else{var c=((r-o)*l+(a-h)*u)/(l*l+u*u);if(c>1)f=t;else if(c>0){for(var d=0;d<i;++d)s[d]=zt(n[e+d],n[t+d],c);s.length=i;return}else f=e}for(var d=0;d<i;++d)s[d]=n[f+d];s.length=i}function gr(n,e,t,i,r){var a=n[e],s=n[e+1];for(e+=i;e<t;e+=i){var o=n[e],h=n[e+1],l=ge(a,s,o,h);l>r&&(r=l),a=o,s=h}return r}function yr(n,e,t,i,r){for(var a=0,s=t.length;a<s;++a){var o=t[a];r=gr(n,e,o,i,r),e=o}return r}function Wl(n,e,t,i,r){for(var a=0,s=t.length;a<s;++a){var o=t[a];r=yr(n,e,o,i,r),e=o[o.length-1]}return r}function mr(n,e,t,i,r,a,s,o,h,l,u){if(e==t)return l;var f,c;if(r===0)if(c=ge(s,o,n[e],n[e+1]),c<l){for(f=0;f<i;++f)h[f]=n[e+f];return h.length=i,c}else return l;for(var d=u||[NaN,NaN],v=e+i;v<t;)if(ls(n,v-i,v,i,s,o,d),c=ge(s,o,d[0],d[1]),c<l){for(l=c,f=0;f<i;++f)h[f]=d[f];h.length=i,v+=i}else v+=i*Math.max((Math.sqrt(c)-Math.sqrt(l))/r|0,1);if(a&&(ls(n,t-i,e,i,s,o,d),c=ge(s,o,d[0],d[1]),c<l)){for(l=c,f=0;f<i;++f)h[f]=d[f];h.length=i}return l}function Mr(n,e,t,i,r,a,s,o,h,l,u){for(var f=u||[NaN,NaN],c=0,d=t.length;c<d;++c){var v=t[c];l=mr(n,e,v,i,r,a,s,o,h,l,f),e=v}return l}function Yl(n,e,t,i,r,a,s,o,h,l,u){for(var f=u||[NaN,NaN],c=0,d=t.length;c<d;++c){var v=t[c];l=Mr(n,e,v,i,r,a,s,o,h,l,f),e=v[v.length-1]}return l}function Vl(n,e,t,i){for(var r=0,a=t.length;r<a;++r)n[e++]=t[r];return e}function un(n,e,t,i){for(var r=0,a=t.length;r<a;++r)for(var s=t[r],o=0;o<i;++o)n[e++]=s[o];return e}function Er(n,e,t,i,r){for(var a=r||[],s=0,o=0,h=t.length;o<h;++o){var l=un(n,e,t[o],i);a[s++]=l,e=l}return a.length=s,a}function Kl(n,e,t,i,r){for(var a=r||[],s=0,o=0,h=t.length;o<h;++o){var l=Er(n,e,t[o],i,a[s]);a[s++]=l,e=l[l.length-1]}return a.length=s,a}function xr(n,e,t,i,r,a,s){var o=(t-e)/i;if(o<3){for(;e<t;e+=i)a[s++]=n[e],a[s++]=n[e+1];return s}var h=new Array(o);h[0]=1,h[o-1]=1;for(var l=[e,t-i],u=0;l.length>0;){for(var f=l.pop(),c=l.pop(),d=0,v=n[c],p=n[c+1],_=n[f],y=n[f+1],g=c+i;g<f;g+=i){var m=n[g],M=n[g+1],E=hl(m,M,v,p,_,y);E>d&&(u=g,d=E)}d>r&&(h[(u-e)/i]=1,c+i<u&&l.push(c,u),u+i<f&&l.push(u,f))}for(var g=0;g<o;++g)h[g]&&(a[s++]=n[e+g*i],a[s++]=n[e+g*i+1]);return s}function ql(n,e,t,i,r,a,s,o){for(var h=0,l=t.length;h<l;++h){var u=t[h];s=xr(n,e,u,i,r,a,s),o.push(s),e=u}return s}function Ee(n,e){return e*Math.round(n/e)}function Hl(n,e,t,i,r,a,s){if(e==t)return s;var o=Ee(n[e],r),h=Ee(n[e+1],r);e+=i,a[s++]=o,a[s++]=h;var l,u;do if(l=Ee(n[e],r),u=Ee(n[e+1],r),e+=i,e==t)return a[s++]=l,a[s++]=u,s;while(l==o&&u==h);for(;e<t;){var f=Ee(n[e],r),c=Ee(n[e+1],r);if(e+=i,!(f==l&&c==u)){var d=l-o,v=u-h,p=f-o,_=c-h;if(d*_==v*p&&(d<0&&p<d||d==p||d>0&&p>d)&&(v<0&&_<v||v==_||v>0&&_>v)){l=f,u=c;continue}a[s++]=l,a[s++]=u,o=l,h=u,l=f,u=c}}return a[s++]=l,a[s++]=u,s}function us(n,e,t,i,r,a,s,o){for(var h=0,l=t.length;h<l;++h){var u=t[h];s=Hl(n,e,u,i,r,a,s),o.push(s),e=u}return s}function Zl(n,e,t,i,r,a,s,o){for(var h=0,l=t.length;h<l;++h){var u=t[h],f=[];s=us(n,e,u,i,r,a,s,f),o.push(f),e=u[u.length-1]}return s}function fs(n,e,t,i,r){var a;for(e+=i;e<t;e+=i)if(a=r(n.slice(e-i,e),n.slice(e,e+i)),a)return a;return!1}function te(n,e,t,i,r){for(var a=r!==void 0?r:[],s=0,o=e;o<t;o+=i)a[s++]=n.slice(o,o+i);return a.length=s,a}function Mi(n,e,t,i,r){for(var a=r!==void 0?r:[],s=0,o=0,h=t.length;o<h;++o){var l=t[o];a[s++]=te(n,e,l,i,a[s]),e=l}return a.length=s,a}function Cr(n,e,t,i,r){for(var a=r!==void 0?r:[],s=0,o=0,h=t.length;o<h;++o){var l=t[o];a[s++]=Mi(n,e,l,i,a[s]),e=l[l.length-1]}return a.length=s,a}function cs(n,e,t,i,r,a,s){var o,h,l=(t-e)/i;if(l===1)o=e;else if(l===2)o=e,h=r;else if(l!==0){for(var u=n[e],f=n[e+1],c=0,d=[0],v=e+i;v<t;v+=i){var p=n[v],_=n[v+1];c+=Math.sqrt((p-u)*(p-u)+(_-f)*(_-f)),d.push(c),u=p,f=_}var y=r*c,g=Rh(d,y);g<0?(h=(y-d[-g-2])/(d[-g-1]-d[-g-2]),o=e+(-g-2)*i):o=e+g*i}for(var m=s>1?s:2,M=a||new Array(m),v=0;v<m;++v)M[v]=o===void 0?NaN:h===void 0?n[o+v]:zt(n[o+v],n[o+i+v],h);return M}function Ir(n,e,t,i,r,a){if(t==e)return null;var s;if(r<n[e+i-1])return a?(s=n.slice(e,e+i),s[i-1]=r,s):null;if(n[t-1]<r)return a?(s=n.slice(t-i,t),s[i-1]=r,s):null;if(r==n[e+i-1])return n.slice(e,e+i);for(var o=e/i,h=t/i;o<h;){var l=o+h>>1;r<n[(l+1)*i-1]?h=l:o=l+1}var u=n[o*i-1];if(r==u)return n.slice((o-1)*i,(o-1)*i+i);var f=n[(o+1)*i-1],c=(r-u)/(f-u);s=[];for(var d=0;d<i-1;++d)s.push(zt(n[(o-1)*i+d],n[o*i+d],c));return s.push(r),s}function Jl(n,e,t,i,r,a,s){if(s)return Ir(n,e,t[t.length-1],i,r,a);var o;if(r<n[i-1])return a?(o=n.slice(0,i),o[i-1]=r,o):null;if(n[n.length-1]<r)return a?(o=n.slice(n.length-i),o[i-1]=r,o):null;for(var h=0,l=t.length;h<l;++h){var u=t[h];if(e!=u){if(r<n[e+i-1])return null;if(r<=n[u-1])return Ir(n,e,u,i,r,!1);e=u}}return null}function Ql(n,e,t,i,r){var a=el(r,function(s){return!xe(n,e,t,i,s[0],s[1])});return!a}function xe(n,e,t,i,r,a){for(var s=0,o=n[t-i],h=n[t-i+1];e<t;e+=i){var l=n[e],u=n[e+1];h<=a?u>a&&(l-o)*(a-h)-(r-o)*(u-h)>0&&s++:u<=a&&(l-o)*(a-h)-(r-o)*(u-h)<0&&s--,o=l,h=u}return s!==0}function Or(n,e,t,i,r,a){if(t.length===0||!xe(n,e,t[0],i,r,a))return!1;for(var s=1,o=t.length;s<o;++s)if(xe(n,t[s-1],t[s],i,r,a))return!1;return!0}function tu(n,e,t,i,r,a){if(t.length===0)return!1;for(var s=0,o=t.length;s<o;++s){var h=t[s];if(Or(n,e,h,i,r,a))return!0;e=h[h.length-1]}return!1}function fn(n,e,t,i,r){var a=ka(Qt(),n,e,t,i);return It(r,a)?be(r,a)||a[0]>=r[0]&&a[2]<=r[2]||a[1]>=r[1]&&a[3]<=r[3]?!0:fs(n,e,t,i,function(s,o){return rl(r,s,o)}):!1}function eu(n,e,t,i,r){for(var a=0,s=t.length;a<s;++a){if(fn(n,e,t[a],i,r))return!0;e=t[a]}return!1}function iu(n,e,t,i,r){return!!(fn(n,e,t,i,r)||xe(n,e,t,i,r[0],r[1])||xe(n,e,t,i,r[0],r[3])||xe(n,e,t,i,r[2],r[1])||xe(n,e,t,i,r[2],r[3]))}function ds(n,e,t,i,r){if(!iu(n,e,t[0],i,r))return!1;if(t.length===1)return!0;for(var a=1,s=t.length;a<s;++a)if(Ql(n,t[a-1],t[a],i,r)&&!fn(n,t[a-1],t[a],i,r))return!1;return!0}function nu(n,e,t,i,r){for(var a=0,s=t.length;a<s;++a){var o=t[a];if(ds(n,e,o,i,r))return!0;e=o[o.length-1]}return!1}function vs(n,e,t,i){for(var r=n[e],a=n[e+1],s=0,o=e+i;o<t;o+=i){var h=n[o],l=n[o+1];s+=Math.sqrt((h-r)*(h-r)+(l-a)*(l-a)),r=h,a=l}return s}var ru=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),au=function(n){ru(e,n);function e(t,i){var r=n.call(this)||this;return r.flatMidpoint_=null,r.flatMidpointRevision_=-1,r.maxDelta_=-1,r.maxDeltaRevision_=-1,i!==void 0&&!Array.isArray(t[0])?r.setFlatCoordinates(i,t):r.setCoordinates(t,i),r}return e.prototype.appendCoordinate=function(t){this.flatCoordinates?Ut(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,i,r,a){return a<pe(this.getExtent(),t,i)?a:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(gr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),mr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,i,r,a))},e.prototype.forEachSegment=function(t){return fs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinateAtM=function(t,i){if(this.layout!=nt.XYM&&this.layout!=nt.XYZM)return null;var r=i!==void 0?i:!1;return Ir(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,r)},e.prototype.getCoordinates=function(){return te(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinateAt=function(t,i){return cs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,this.stride)},e.prototype.getLength=function(){return vs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=xr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,nt.XY)},e.prototype.getType=function(){return T.LINE_STRING},e.prototype.intersectsExtent=function(t){return fn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.setCoordinates=function(t,i){this.setLayout(i,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=un(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Me),Rr=au,su=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ou=function(n){su(e,n);function e(t,i,r){var a=n.call(this)||this;if(a.ends_=[],a.maxDelta_=-1,a.maxDeltaRevision_=-1,Array.isArray(t[0]))a.setCoordinates(t,i);else if(i!==void 0&&r)a.setFlatCoordinates(i,t),a.ends_=r;else{for(var s=a.getLayout(),o=t,h=[],l=[],u=0,f=o.length;u<f;++u){var c=o[u];u===0&&(s=c.getLayout()),Ut(h,c.getFlatCoordinates()),l.push(h.length)}a.setFlatCoordinates(s,h),a.ends_=l}return a}return e.prototype.appendLineString=function(t){this.flatCoordinates?Ut(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,i,r,a){return a<pe(this.getExtent(),t,i)?a:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(yr(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Mr(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,i,r,a))},e.prototype.getCoordinateAtM=function(t,i,r){if(this.layout!=nt.XYM&&this.layout!=nt.XYZM||this.flatCoordinates.length===0)return null;var a=i!==void 0?i:!1,s=r!==void 0?r:!1;return Jl(this.flatCoordinates,0,this.ends_,this.stride,t,a,s)},e.prototype.getCoordinates=function(){return Mi(this.flatCoordinates,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getLineString=function(t){return t<0||this.ends_.length<=t?null:new Rr(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLineStrings=function(){for(var t=this.flatCoordinates,i=this.ends_,r=this.layout,a=[],s=0,o=0,h=i.length;o<h;++o){var l=i[o],u=new Rr(t.slice(s,l),r);a.push(u),s=l}return a},e.prototype.getFlatMidpoints=function(){for(var t=[],i=this.flatCoordinates,r=0,a=this.ends_,s=this.stride,o=0,h=a.length;o<h;++o){var l=a[o],u=cs(i,r,l,s,.5);Ut(t,u),r=l}return t},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],r=[];return i.length=ql(this.flatCoordinates,0,this.ends_,this.stride,t,i,0,r),new e(i,nt.XY,r)},e.prototype.getType=function(){return T.MULTI_LINE_STRING},e.prototype.intersectsExtent=function(t){return eu(this.flatCoordinates,0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,i){this.setLayout(i,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var r=Er(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()},e}(Me),hu=ou,lu=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),uu=function(n){lu(e,n);function e(t,i){var r=n.call(this)||this;return r.setCoordinates(t,i),r}return e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,i,r,a){var s=this.flatCoordinates,o=ge(t,i,s[0],s[1]);if(o<a){for(var h=this.stride,l=0;l<h;++l)r[l]=s[l];return r.length=h,o}else return a},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return Zh(this.flatCoordinates,t)},e.prototype.getType=function(){return T.POINT},e.prototype.intersectsExtent=function(t){return sr(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,i){this.setLayout(i,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Vl(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Me),cn=uu,fu=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),cu=function(n){fu(e,n);function e(t,i){var r=n.call(this)||this;return i&&!Array.isArray(t[0])?r.setFlatCoordinates(i,t):r.setCoordinates(t,i),r}return e.prototype.appendPoint=function(t){this.flatCoordinates?Ut(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,i,r,a){if(a<pe(this.getExtent(),t,i))return a;for(var s=this.flatCoordinates,o=this.stride,h=0,l=s.length;h<l;h+=o){var u=ge(t,i,s[h],s[h+1]);if(u<a){a=u;for(var f=0;f<o;++f)r[f]=s[h+f];r.length=o}}return a},e.prototype.getCoordinates=function(){return te(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getPoint=function(t){var i=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||i<=t?null:new cn(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)},e.prototype.getPoints=function(){for(var t=this.flatCoordinates,i=this.layout,r=this.stride,a=[],s=0,o=t.length;s<o;s+=r){var h=new cn(t.slice(s,s+r),i);a.push(h)}return a},e.prototype.getType=function(){return T.MULTI_POINT},e.prototype.intersectsExtent=function(t){for(var i=this.flatCoordinates,r=this.stride,a=0,s=i.length;a<s;a+=r){var o=i[a],h=i[a+1];if(sr(t,o,h))return!0}return!1},e.prototype.setCoordinates=function(t,i){this.setLayout(i,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=un(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Me),ps=cu;function _s(n,e,t,i){for(var r=0,a=n[t-i],s=n[t-i+1];e<t;e+=i){var o=n[e],h=n[e+1];r+=s*o-a*h,a=o,s=h}return r/2}function gs(n,e,t,i){for(var r=0,a=0,s=t.length;a<s;++a){var o=t[a];r+=_s(n,e,o,i),e=o}return r}function du(n,e,t,i){for(var r=0,a=0,s=t.length;a<s;++a){var o=t[a];r+=gs(n,e,o,i),e=o[o.length-1]}return r}var vu=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),pu=function(n){vu(e,n);function e(t,i){var r=n.call(this)||this;return r.maxDelta_=-1,r.maxDeltaRevision_=-1,i!==void 0&&!Array.isArray(t[0])?r.setFlatCoordinates(i,t):r.setCoordinates(t,i),r}return e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,i,r,a){return a<pe(this.getExtent(),t,i)?a:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(gr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),mr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,i,r,a))},e.prototype.getArea=function(){return _s(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return te(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=xr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,nt.XY)},e.prototype.getType=function(){return T.LINEAR_RING},e.prototype.intersectsExtent=function(t){return!1},e.prototype.setCoordinates=function(t,i){this.setLayout(i,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=un(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Me),ys=pu;function ms(n,e,t,i,r,a,s){for(var o,h,l,u,f,c,d,v=r[a+1],p=[],_=0,y=t.length;_<y;++_){var g=t[_];for(u=n[g-i],c=n[g-i+1],o=e;o<g;o+=i)f=n[o],d=n[o+1],(v<=c&&d<=v||c<=v&&v<=d)&&(l=(v-c)/(d-c)*(f-u)+u,p.push(l)),u=f,c=d}var m=NaN,M=-1/0;for(p.sort(vi),u=p[0],o=1,h=p.length;o<h;++o){f=p[o];var E=Math.abs(f-u);E>M&&(l=(u+f)/2,Or(n,e,t,i,l,v)&&(m=l,M=E)),u=f}return isNaN(m)&&(m=r[a]),s?(s.push(m,v,M),s):[m,v,M]}function _u(n,e,t,i,r){for(var a=[],s=0,o=t.length;s<o;++s){var h=t[s];a=ms(n,e,h,i,r,2*s,a),e=h[h.length-1]}return a}function gu(n,e,t,i){for(;e<t-i;){for(var r=0;r<i;++r){var a=n[e+r];n[e+r]=n[t-i+r],n[t-i+r]=a}e+=i,t-=i}}function Ms(n,e,t,i){for(var r=0,a=n[t-i],s=n[t-i+1];e<t;e+=i){var o=n[e],h=n[e+1];r+=(o-a)*(h+s),a=o,s=h}return r===0?void 0:r>0}function Es(n,e,t,i,r){for(var a=r!==void 0?r:!1,s=0,o=t.length;s<o;++s){var h=t[s],l=Ms(n,e,h,i);if(s===0){if(a&&l||!a&&!l)return!1}else if(a&&!l||!a&&l)return!1;e=h}return!0}function yu(n,e,t,i,r){for(var a=0,s=t.length;a<s;++a){var o=t[a];if(!Es(n,e,o,i,r))return!1;o.length&&(e=o[o.length-1])}return!0}function wr(n,e,t,i,r){for(var a=r!==void 0?r:!1,s=0,o=t.length;s<o;++s){var h=t[s],l=Ms(n,e,h,i),u=s===0?a&&l||!a&&!l:a&&!l||!a&&l;u&&gu(n,e,h,i),e=h}return e}function xs(n,e,t,i,r){for(var a=0,s=t.length;a<s;++a)e=wr(n,e,t[a],i,r);return e}var mu=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Cs=function(n){mu(e,n);function e(t,i,r){var a=n.call(this)||this;return a.ends_=[],a.flatInteriorPointRevision_=-1,a.flatInteriorPoint_=null,a.maxDelta_=-1,a.maxDeltaRevision_=-1,a.orientedRevision_=-1,a.orientedFlatCoordinates_=null,i!==void 0&&r?(a.setFlatCoordinates(i,t),a.ends_=r):a.setCoordinates(t,i),a}return e.prototype.appendLinearRing=function(t){this.flatCoordinates?Ut(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,i,r,a){return a<pe(this.getExtent(),t,i)?a:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(yr(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Mr(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,i,r,a))},e.prototype.containsXY=function(t,i){return Or(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,i)},e.prototype.getArea=function(){return gs(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var i;return t!==void 0?(i=this.getOrientedFlatCoordinates().slice(),wr(i,0,this.ends_,this.stride,t)):i=this.flatCoordinates,Mi(i,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=Be(this.getExtent());this.flatInteriorPoint_=ms(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new cn(this.getFlatInteriorPoint(),nt.XYM)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new ys(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,i=this.flatCoordinates,r=this.ends_,a=[],s=0,o=0,h=r.length;o<h;++o){var l=r[o],u=new ys(i.slice(s,l),t);a.push(u),s=l}return a},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;Es(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=wr(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],r=[];return i.length=us(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),i,0,r),new e(i,nt.XY,r)},e.prototype.getType=function(){return T.POLYGON},e.prototype.intersectsExtent=function(t){return ds(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,i){this.setLayout(i,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var r=Er(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()},e}(Me),dn=Cs;function Is(n){var e=n[0],t=n[1],i=n[2],r=n[3],a=[e,t,e,r,i,r,i,t,e,t];return new Cs(a,nt.XY,[a.length])}function Mu(n,e,t,i){for(var r=[],a=Qt(),s=0,o=t.length;s<o;++s){var h=t[s];a=ba(n,e,h[0],i),r.push((a[0]+a[2])/2,(a[1]+a[3])/2),e=h[h.length-1]}return r}var Eu=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),xu=function(n){Eu(e,n);function e(t,i,r){var a=n.call(this)||this;if(a.endss_=[],a.flatInteriorPointsRevision_=-1,a.flatInteriorPoints_=null,a.maxDelta_=-1,a.maxDeltaRevision_=-1,a.orientedRevision_=-1,a.orientedFlatCoordinates_=null,!r&&!Array.isArray(t[0])){for(var s=a.getLayout(),o=t,h=[],l=[],u=0,f=o.length;u<f;++u){var c=o[u];u===0&&(s=c.getLayout());for(var d=h.length,v=c.getEnds(),p=0,_=v.length;p<_;++p)v[p]+=d;Ut(h,c.getFlatCoordinates()),l.push(v)}i=s,t=h,r=l}return i!==void 0&&r?(a.setFlatCoordinates(i,t),a.endss_=r):a.setCoordinates(t,i),a}return e.prototype.appendPolygon=function(t){var i;if(!this.flatCoordinates)this.flatCoordinates=t.getFlatCoordinates().slice(),i=t.getEnds().slice(),this.endss_.push();else{var r=this.flatCoordinates.length;Ut(this.flatCoordinates,t.getFlatCoordinates()),i=t.getEnds().slice();for(var a=0,s=i.length;a<s;++a)i[a]+=r}this.endss_.push(i),this.changed()},e.prototype.clone=function(){for(var t=this.endss_.length,i=new Array(t),r=0;r<t;++r)i[r]=this.endss_[r].slice();var a=new e(this.flatCoordinates.slice(),this.layout,i);return a.applyProperties(this),a},e.prototype.closestPointXY=function(t,i,r,a){return a<pe(this.getExtent(),t,i)?a:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Wl(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Yl(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,i,r,a))},e.prototype.containsXY=function(t,i){return tu(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,i)},e.prototype.getArea=function(){return du(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},e.prototype.getCoordinates=function(t){var i;return t!==void 0?(i=this.getOrientedFlatCoordinates().slice(),xs(i,0,this.endss_,this.stride,t)):i=this.flatCoordinates,Cr(i,0,this.endss_,this.stride)},e.prototype.getEndss=function(){return this.endss_},e.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var t=Mu(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=_u(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},e.prototype.getInteriorPoints=function(){return new ps(this.getFlatInteriorPoints().slice(),nt.XYM)},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;yu(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=xs(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],r=[];return i.length=Zl(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),i,0,r),new e(i,nt.XY,r)},e.prototype.getPolygon=function(t){if(t<0||this.endss_.length<=t)return null;var i;if(t===0)i=0;else{var r=this.endss_[t-1];i=r[r.length-1]}var a=this.endss_[t].slice(),s=a[a.length-1];if(i!==0)for(var o=0,h=a.length;o<h;++o)a[o]-=i;return new dn(this.flatCoordinates.slice(i,s),this.layout,a)},e.prototype.getPolygons=function(){for(var t=this.layout,i=this.flatCoordinates,r=this.endss_,a=[],s=0,o=0,h=r.length;o<h;++o){var l=r[o].slice(),u=l[l.length-1];if(s!==0)for(var f=0,c=l.length;f<c;++f)l[f]-=s;var d=new dn(i.slice(s,u),t,l);a.push(d),s=u}return a},e.prototype.getType=function(){return T.MULTI_POLYGON},e.prototype.intersectsExtent=function(t){return nu(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)},e.prototype.setCoordinates=function(t,i){this.setLayout(i,t,3),this.flatCoordinates||(this.flatCoordinates=[]);var r=Kl(this.flatCoordinates,0,t,this.stride,this.endss_);if(r.length===0)this.flatCoordinates.length=0;else{var a=r[r.length-1];this.flatCoordinates.length=a.length===0?0:a[a.length-1]}this.changed()},e}(Me),Cu=xu,Iu=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ou=function(n){Iu(e,n);function e(t){var i=this,r=t||{};return i=n.call(this)||this,i.dataProjection=st(r.dataProjection?r.dataProjection:"EPSG:4326"),r.featureProjection&&(i.defaultFeatureProjection=st(r.featureProjection)),i.geometryName_=r.geometryName,i.extractGeometryName_=r.extractGeometryName,i.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"],i}return e.prototype.readFeatureFromObject=function(t,i){var r=null;t.type==="Feature"?r=t:r={type:"Feature",geometry:t,properties:null};var a=Sr(r.geometry,i),s=new $h;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in r!==void 0&&s.setGeometryName(r.geometry_name),s.setGeometry(a),"id"in r&&s.setId(r.id),r.properties&&s.setProperties(r.properties,!0),s},e.prototype.readFeaturesFromObject=function(t,i){var r=t,a=null;if(r.type==="FeatureCollection"){var s=t;a=[];for(var o=s.features,h=0,l=o.length;h<l;++h)a.push(this.readFeatureFromObject(o[h],i))}else a=[this.readFeatureFromObject(t,i)];return a},e.prototype.readGeometryFromObject=function(t,i){return Sr(t,i)},e.prototype.readProjectionFromObject=function(t){var i=t.crs,r;return i?i.type=="name"?r=st(i.properties.name):i.type==="EPSG"?r=st("EPSG:"+i.properties.code):X(!1,36):r=this.dataProjection,r},e.prototype.writeFeatureObject=function(t,i){i=this.adaptOptions(i);var r={type:"Feature",geometry:null,properties:null},a=t.getId();if(a!==void 0&&(r.id=a),!t.hasProperties())return r;var s=t.getProperties(),o=t.getGeometry();return o&&(r.geometry=Tr(o,i),delete s[t.getGeometryName()]),Ne(s)||(r.properties=s),r},e.prototype.writeFeaturesObject=function(t,i){i=this.adaptOptions(i);for(var r=[],a=0,s=t.length;a<s;++a)r.push(this.writeFeatureObject(t[a],i));return{type:"FeatureCollection",features:r}},e.prototype.writeGeometryObject=function(t,i){return Tr(t,this.adaptOptions(i))},e}(jl);function Sr(n,e){if(!n)return null;var t;switch(n.type){case T.POINT:{t=wu(n);break}case T.LINE_STRING:{t=Su(n);break}case T.POLYGON:{t=Lu(n);break}case T.MULTI_POINT:{t=Pu(n);break}case T.MULTI_LINE_STRING:{t=Tu(n);break}case T.MULTI_POLYGON:{t=Au(n);break}case T.GEOMETRY_COLLECTION:{t=Ru(n);break}default:throw new Error("Unsupported GeoJSON type: "+n.type)}return os(t,!1,e)}function Ru(n,e){var t=n.geometries.map(function(i){return Sr(i,e)});return new Gl(t)}function wu(n){return new cn(n.coordinates)}function Su(n){return new Rr(n.coordinates)}function Tu(n){return new hu(n.coordinates)}function Pu(n){return new ps(n.coordinates)}function Au(n){return new Cu(n.coordinates)}function Lu(n){return new dn(n.coordinates)}function Tr(n,e){n=os(n,!0,e);var t=n.getType(),i;switch(t){case T.POINT:{i=ku(n);break}case T.LINE_STRING:{i=Du(n);break}case T.POLYGON:{i=Bu(n,e);break}case T.MULTI_POINT:{i=Gu(n);break}case T.MULTI_LINE_STRING:{i=Fu(n);break}case T.MULTI_POLYGON:{i=bu(n,e);break}case T.GEOMETRY_COLLECTION:{i=Nu(n,e);break}case T.CIRCLE:{i={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return i}function Nu(n,e){var t=n.getGeometriesArray().map(function(i){var r=pt({},e);return delete r.featureProjection,Tr(i,r)});return{type:"GeometryCollection",geometries:t}}function Du(n,e){return{type:"LineString",coordinates:n.getCoordinates()}}function Fu(n,e){return{type:"MultiLineString",coordinates:n.getCoordinates()}}function Gu(n,e){return{type:"MultiPoint",coordinates:n.getCoordinates()}}function bu(n,e){var t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:n.getCoordinates(t)}}function ku(n,e){return{type:"Point",coordinates:n.getCoordinates()}}function Bu(n,e){var t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:n.getCoordinates(t)}}var _y=Ou,mt={ADD:"add",REMOVE:"remove"},Os=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Rs={LENGTH:"length"},vn=function(n){Os(e,n);function e(t,i,r){var a=n.call(this,t)||this;return a.element=i,a.index=r,a}return e}(ue),ju=function(n){Os(e,n);function e(t,i){var r=n.call(this)||this;r.on,r.once,r.un;var a=i||{};if(r.unique_=!!a.unique,r.array_=t||[],r.unique_)for(var s=0,o=r.array_.length;s<o;++s)r.assertUnique_(r.array_[s],s);return r.updateLength_(),r}return e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var i=0,r=t.length;i<r;++i)this.push(t[i]);return this},e.prototype.forEach=function(t){for(var i=this.array_,r=0,a=i.length;r<a;++r)t(i[r],r,i)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(Rs.LENGTH)},e.prototype.insertAt=function(t,i){this.unique_&&this.assertUnique_(i),this.array_.splice(t,0,i),this.updateLength_(),this.dispatchEvent(new vn(mt.ADD,i,t))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var i=this.getLength();return this.insertAt(i,t),this.getLength()},e.prototype.remove=function(t){for(var i=this.array_,r=0,a=i.length;r<a;++r)if(i[r]===t)return this.removeAt(r)},e.prototype.removeAt=function(t){var i=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new vn(mt.REMOVE,i,t)),i},e.prototype.setAt=function(t,i){var r=this.getLength();if(t<r){this.unique_&&this.assertUnique_(i,t);var a=this.array_[t];this.array_[t]=i,this.dispatchEvent(new vn(mt.REMOVE,a,t)),this.dispatchEvent(new vn(mt.ADD,i,t))}else{for(var s=r;s<t;++s)this.insertAt(s,void 0);this.insertAt(t,i)}},e.prototype.updateLength_=function(){this.set(Rs.LENGTH,this.array_.length)},e.prototype.assertUnique_=function(t,i){for(var r=0,a=this.array_.length;r<a;++r)if(this.array_[r]===t&&r!==i)throw new Pa(58)},e}(Pt),Ot=ju,Ce={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},$u=function(){function n(e){var t=e||{};this.color_=t.color!==void 0?t.color:null}return n.prototype.clone=function(){var e=this.getColor();return new n({color:Array.isArray(e)?e.slice():e||void 0})},n.prototype.getColor=function(){return this.color_},n.prototype.setColor=function(e){this.color_=e},n}(),ws=$u,Uu=function(){function n(e){var t=e||{};this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}return n.prototype.clone=function(){var e=this.getColor();return new n({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},n.prototype.getColor=function(){return this.color_},n.prototype.getLineCap=function(){return this.lineCap_},n.prototype.getLineDash=function(){return this.lineDash_},n.prototype.getLineDashOffset=function(){return this.lineDashOffset_},n.prototype.getLineJoin=function(){return this.lineJoin_},n.prototype.getMiterLimit=function(){return this.miterLimit_},n.prototype.getWidth=function(){return this.width_},n.prototype.setColor=function(e){this.color_=e},n.prototype.setLineCap=function(e){this.lineCap_=e},n.prototype.setLineDash=function(e){this.lineDash_=e},n.prototype.setLineDashOffset=function(e){this.lineDashOffset_=e},n.prototype.setLineJoin=function(e){this.lineJoin_=e},n.prototype.setMiterLimit=function(e){this.miterLimit_=e},n.prototype.setWidth=function(e){this.width_=e},n}(),zu=Uu,W={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Ss(n){return n[0]>0&&n[1]>0}function pn(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}var Xu=function(){function n(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=pn(e.scale),this.displacement_=e.displacement}return n.prototype.clone=function(){var e=this.getScale();return new n({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()})},n.prototype.getOpacity=function(){return this.opacity_},n.prototype.getRotateWithView=function(){return this.rotateWithView_},n.prototype.getRotation=function(){return this.rotation_},n.prototype.getScale=function(){return this.scale_},n.prototype.getScaleArray=function(){return this.scaleArray_},n.prototype.getDisplacement=function(){return this.displacement_},n.prototype.getAnchor=function(){return A()},n.prototype.getImage=function(e){return A()},n.prototype.getHitDetectionImage=function(){return A()},n.prototype.getPixelRatio=function(e){return 1},n.prototype.getImageState=function(){return A()},n.prototype.getImageSize=function(){return A()},n.prototype.getOrigin=function(){return A()},n.prototype.getSize=function(){return A()},n.prototype.setOpacity=function(e){this.opacity_=e},n.prototype.setRotateWithView=function(e){this.rotateWithView_=e},n.prototype.setRotation=function(e){this.rotation_=e},n.prototype.setScale=function(e){this.scale_=e,this.scaleArray_=pn(e)},n.prototype.listenImageChange=function(e){A()},n.prototype.load=function(){A()},n.prototype.unlistenImageChange=function(e){A()},n}(),Ts=Xu,Wu=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,Yu=/^([a-z]*)$|^hsla?\(.*\)$/i;function Ps(n){return typeof n=="string"?n:Ns(n)}function Vu(n){var e=document.createElement("div");if(e.style.color=n,e.style.color!==""){document.body.appendChild(e);var t=getComputedStyle(e).color;return document.body.removeChild(e),t}else return""}var Ku=function(){var n=1024,e={},t=0;return function(i){var r;if(e.hasOwnProperty(i))r=e[i];else{if(t>=n){var a=0;for(var s in e)(a++&3)==0&&(delete e[s],--t)}r=qu(i),e[i]=r,++t}return r}}();function As(n){return Array.isArray(n)?n:Ku(n)}function qu(n){var e,t,i,r,a;if(Yu.exec(n)&&(n=Vu(n)),Wu.exec(n)){var s=n.length-1,o=void 0;s<=4?o=1:o=2;var h=s===4||s===8;e=parseInt(n.substr(1+0*o,o),16),t=parseInt(n.substr(1+1*o,o),16),i=parseInt(n.substr(1+2*o,o),16),h?r=parseInt(n.substr(1+3*o,o),16):r=255,o==1&&(e=(e<<4)+e,t=(t<<4)+t,i=(i<<4)+i,h&&(r=(r<<4)+r)),a=[e,t,i,r/255]}else n.indexOf("rgba(")==0?(a=n.slice(5,-1).split(",").map(Number),Ls(a)):n.indexOf("rgb(")==0?(a=n.slice(4,-1).split(",").map(Number),a.push(1),Ls(a)):X(!1,14);return a}function Ls(n){return n[0]=at(n[0]+.5|0,0,255),n[1]=at(n[1]+.5|0,0,255),n[2]=at(n[2]+.5|0,0,255),n[3]=at(n[3],0,1),n}function Ns(n){var e=n[0];e!=(e|0)&&(e=e+.5|0);var t=n[1];t!=(t|0)&&(t=t+.5|0);var i=n[2];i!=(i|0)&&(i=i+.5|0);var r=n[3]===void 0?1:n[3];return"rgba("+e+","+t+","+i+","+r+")"}function Lt(n){return Array.isArray(n)?Ns(n):n}function Wt(n,e,t,i){var r;return t&&t.length?r=t.shift():sn?r=new OffscreenCanvas(n||300,e||300):(r=document.createElement("canvas"),r.style.all="unset"),n&&(r.width=n),e&&(r.height=e),r.getContext("2d",i)}function Ds(n,e){var t=e.parentNode;t&&t.replaceChild(n,e)}function Pr(n){return n&&n.parentNode?n.parentNode.removeChild(n):null}function Hu(n){for(;n.lastChild;)n.removeChild(n.lastChild)}function Zu(n,e){for(var t=n.childNodes,i=0;;++i){var r=t[i],a=e[i];if(!r&&!a)break;if(r!==a){if(!r){n.appendChild(a);continue}if(!a){n.removeChild(r),--i;continue}n.insertBefore(a,r)}}}var _n="ol-hidden",gn="ol-unselectable",Ar="ol-control",Fs="ol-collapsed",Ju=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),Gs=["style","variant","weight","size","lineHeight","family"],bs=function(n){var e=n.match(Ju);if(!e)return null;for(var t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"},i=0,r=Gs.length;i<r;++i){var a=e[i+1];a!==void 0&&(t[Gs[i]]=a)}return t.families=t.family.split(/,\s?/),t};function ks(n){return n===1?"":String(Math.round(n*100)/100)}var Bs="10px sans-serif",Yt="#000",yn="round",Ei=[],xi=0,We="round",Ci=10,Ii="#000",Oi="center",mn="middle",Ie=[0,0,0,0],Ri=1,Vt=new Pt,Qu=new _i;Qu.setSize=function(){console.warn("labelCache is deprecated.")};var Ye=null,Lr,Nr={},tf=function(){var n=100,e="32px ",t=["monospace","serif"],i=t.length,r="wmytzilWMYTZIL@#/&?$%10\uF013",a,s;function o(l,u,f){for(var c=!0,d=0;d<i;++d){var v=t[d];if(s=Mn(l+" "+u+" "+e+v,r),f!=v){var p=Mn(l+" "+u+" "+e+f+","+v,r);c=c&&p!=s}}return!!c}function h(){for(var l=!0,u=Vt.getKeys(),f=0,c=u.length;f<c;++f){var d=u[f];Vt.get(d)<n&&(o.apply(this,d.split(`
`))?(pi(Nr),Ye=null,Lr=void 0,Vt.set(d,n)):(Vt.set(d,Vt.get(d)+1,!0),l=!1))}l&&(clearInterval(a),a=void 0)}return function(l){var u=bs(l);if(!!u)for(var f=u.families,c=0,d=f.length;c<d;++c){var v=f[c],p=u.style+`
`+u.weight+`
`+v;Vt.get(p)===void 0&&(Vt.set(p,n,!0),o(u.style,u.weight,v)||(Vt.set(p,0,!0),a===void 0&&(a=setInterval(h,32))))}}}(),ef=function(){var n;return function(e){var t=Nr[e];if(t==null){if(sn){var i=bs(e),r=js(e,"\u017Dg"),a=isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight);t=a*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);Nr[e]=t}return t}}();function js(n,e){return Ye||(Ye=Wt(1,1)),n!=Lr&&(Ye.font=n,Lr=Ye.font),Ye.measureText(e)}function Mn(n,e){return js(n,e).width}function $s(n,e,t){if(e in t)return t[e];var i=Mn(n,e);return t[e]=i,i}function nf(n,e,t){for(var i=e.length,r=0,a=0;a<i;++a){var s=Mn(n,e[a]);r=Math.max(r,s),t.push(s)}return r}function rf(n,e,t,i,r,a,s,o,h,l,u){n.save(),t!==1&&(n.globalAlpha*=t),e&&n.setTransform.apply(n,e),i.contextInstructions?(n.translate(h,l),n.scale(u[0],u[1]),af(i,n)):u[0]<0||u[1]<0?(n.translate(h,l),n.scale(u[0],u[1]),n.drawImage(i,r,a,s,o,0,0,s,o)):n.drawImage(i,r,a,s,o,h,l,s*u[0],o*u[1]),n.restore()}function af(n,e){for(var t=n.contextInstructions,i=0,r=t.length;i<r;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}var sf=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),of=function(n){sf(e,n);function e(t){var i=this,r=t.rotateWithView!==void 0?t.rotateWithView:!1;return i=n.call(this,{opacity:1,rotateWithView:r,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0]})||this,i.canvas_=void 0,i.hitDetectionCanvas_=null,i.fill_=t.fill!==void 0?t.fill:null,i.origin_=[0,0],i.points_=t.points,i.radius_=t.radius!==void 0?t.radius:t.radius1,i.radius2_=t.radius2,i.angle_=t.angle!==void 0?t.angle:0,i.stroke_=t.stroke!==void 0?t.stroke:null,i.anchor_=null,i.size_=null,i.renderOptions_=null,i.render(),i}return e.prototype.clone=function(){var t=this.getScale(),i=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice()});return i.setOpacity(this.getOpacity()),i},e.prototype.getAnchor=function(){return this.anchor_},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.getHitDetectionImage=function(){return this.hitDetectionCanvas_||this.createHitDetectionCanvas_(this.renderOptions_),this.hitDetectionCanvas_},e.prototype.getImage=function(t){var i=this.canvas_[t];if(!i){var r=this.renderOptions_,a=Wt(r.size*t,r.size*t);this.draw_(r,a,t),i=a.canvas,this.canvas_[t]=i}return i},e.prototype.getPixelRatio=function(t){return t},e.prototype.getImageSize=function(){return this.size_},e.prototype.getImageState=function(){return W.LOADED},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.listenImageChange=function(t){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t){},e.prototype.calculateLineJoinSize_=function(t,i,r){if(i===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return i;var a=this.radius_,s=this.radius2_===void 0?a:this.radius2_;if(a<s){var o=a;a=s,s=o}var h=this.radius2_===void 0?this.points_:this.points_*2,l=2*Math.PI/h,u=s*Math.sin(l),f=Math.sqrt(s*s-u*u),c=a-f,d=Math.sqrt(u*u+c*c),v=d/u;if(t==="miter"&&v<=r)return v*i;var p=i/2/v,_=i/2*(c/d),y=Math.sqrt((a+p)*(a+p)+_*_),g=y-a;if(this.radius2_===void 0||t==="bevel")return g*2;var m=a*Math.sin(l),M=Math.sqrt(a*a-m*m),E=s-M,C=Math.sqrt(m*m+E*E),S=C/m;if(S<=r){var O=S*i/2-s-a;return 2*Math.max(g,O)}return g*2},e.prototype.createRenderOptions=function(){var t=We,i=0,r=null,a=0,s,o=0;this.stroke_&&(s=this.stroke_.getColor(),s===null&&(s=Ii),s=Lt(s),o=this.stroke_.getWidth(),o===void 0&&(o=Ri),r=this.stroke_.getLineDash(),a=this.stroke_.getLineDashOffset(),t=this.stroke_.getLineJoin(),t===void 0&&(t=We),i=this.stroke_.getMiterLimit(),i===void 0&&(i=Ci));var h=this.calculateLineJoinSize_(t,o,i),l=Math.max(this.radius_,this.radius2_||0),u=Math.ceil(2*l+h);return{strokeStyle:s,strokeWidth:o,size:u,lineDash:r,lineDashOffset:a,lineJoin:t,miterLimit:i}},e.prototype.render=function(){this.renderOptions_=this.createRenderOptions();var t=this.renderOptions_.size,i=this.getDisplacement();this.canvas_={},this.anchor_=[t/2-i[0],t/2+i[1]],this.size_=[t,t]},e.prototype.draw_=function(t,i,r){if(i.scale(r,r),i.translate(t.size/2,t.size/2),this.createPath_(i),this.fill_){var a=this.fill_.getColor();a===null&&(a=Yt),i.fillStyle=Lt(a),i.fill()}this.stroke_&&(i.strokeStyle=t.strokeStyle,i.lineWidth=t.strokeWidth,i.setLineDash&&t.lineDash&&(i.setLineDash(t.lineDash),i.lineDashOffset=t.lineDashOffset),i.lineJoin=t.lineJoin,i.miterLimit=t.miterLimit,i.stroke())},e.prototype.createHitDetectionCanvas_=function(t){if(this.fill_){var i=this.fill_.getColor(),r=0;if(typeof i=="string"&&(i=As(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0){var a=Wt(t.size,t.size);this.hitDetectionCanvas_=a.canvas,this.drawHitDetectionCanvas_(t,a)}}this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.getImage(1))},e.prototype.createPath_=function(t){var i=this.points_,r=this.radius_;if(i===1/0)t.arc(0,0,r,0,2*Math.PI);else{var a=this.radius2_===void 0?r:this.radius2_;this.radius2_!==void 0&&(i*=2);for(var s=this.angle_-Math.PI/2,o=2*Math.PI/i,h=0;h<i;h++){var l=s+h*o,u=h%2==0?r:a;t.lineTo(u*Math.cos(l),u*Math.sin(l))}t.closePath()}},e.prototype.drawHitDetectionCanvas_=function(t,i){i.translate(t.size/2,t.size/2),this.createPath_(i),i.fillStyle=Yt,i.fill(),this.stroke_&&(i.strokeStyle=t.strokeStyle,i.lineWidth=t.strokeWidth,t.lineDash&&(i.setLineDash(t.lineDash),i.lineDashOffset=t.lineDashOffset),i.lineJoin=t.lineJoin,i.miterLimit=t.miterLimit,i.stroke())},e}(Ts),hf=of,lf=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),uf=function(n){lf(e,n);function e(t){var i=this,r=t||{};return i=n.call(this,{points:1/0,fill:r.fill,radius:r.radius,stroke:r.stroke,scale:r.scale!==void 0?r.scale:1,rotation:r.rotation!==void 0?r.rotation:0,rotateWithView:r.rotateWithView!==void 0?r.rotateWithView:!1,displacement:r.displacement!==void 0?r.displacement:[0,0]})||this,i}return e.prototype.clone=function(){var t=this.getScale(),i=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()});return i.setOpacity(this.getOpacity()),i},e.prototype.setRadius=function(t){this.radius_=t,this.render()},e}(hf),ff=uf,Us=function(){function n(e){var t=e||{};this.geometry_=null,this.geometryFunction_=zs,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}return n.prototype.clone=function(){var e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new n({geometry:e,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer(),stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},n.prototype.getRenderer=function(){return this.renderer_},n.prototype.setRenderer=function(e){this.renderer_=e},n.prototype.setHitDetectionRenderer=function(e){this.hitDetectionRenderer_=e},n.prototype.getHitDetectionRenderer=function(){return this.hitDetectionRenderer_},n.prototype.getGeometry=function(){return this.geometry_},n.prototype.getGeometryFunction=function(){return this.geometryFunction_},n.prototype.getFill=function(){return this.fill_},n.prototype.setFill=function(e){this.fill_=e},n.prototype.getImage=function(){return this.image_},n.prototype.setImage=function(e){this.image_=e},n.prototype.getStroke=function(){return this.stroke_},n.prototype.setStroke=function(e){this.stroke_=e},n.prototype.getText=function(){return this.text_},n.prototype.setText=function(e){this.text_=e},n.prototype.getZIndex=function(){return this.zIndex_},n.prototype.setGeometry=function(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=zs,this.geometry_=e},n.prototype.setZIndex=function(e){this.zIndex_=e},n}();function cf(n){var e;if(typeof n=="function")e=n;else{var t;if(Array.isArray(n))t=n;else{X(typeof n.getZIndex=="function",41);var i=n;t=[i]}e=function(){return t}}return e}var Dr=null;function df(n,e){if(!Dr){var t=new ws({color:"rgba(255,255,255,0.4)"}),i=new zu({color:"#3399CC",width:1.25});Dr=[new Us({image:new ff({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return Dr}function zs(n){return n.getGeometry()}var gy=Us,Xs={POINT:"point",LINE:"line"},vf="#333",pf=function(){function n(e){var t=e||{};this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=pn(t.scale!==void 0?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.textBaseline_=t.textBaseline,this.fill_=t.fill!==void 0?t.fill:new ws({color:vf}),this.maxAngle_=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.placement_=t.placement!==void 0?t.placement:Xs.POINT,this.overflow_=!!t.overflow,this.stroke_=t.stroke!==void 0?t.stroke:null,this.offsetX_=t.offsetX!==void 0?t.offsetX:0,this.offsetY_=t.offsetY!==void 0?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=t.padding===void 0?null:t.padding}return n.prototype.clone=function(){var e=this.getScale();return new n({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()})},n.prototype.getOverflow=function(){return this.overflow_},n.prototype.getFont=function(){return this.font_},n.prototype.getMaxAngle=function(){return this.maxAngle_},n.prototype.getPlacement=function(){return this.placement_},n.prototype.getOffsetX=function(){return this.offsetX_},n.prototype.getOffsetY=function(){return this.offsetY_},n.prototype.getFill=function(){return this.fill_},n.prototype.getRotateWithView=function(){return this.rotateWithView_},n.prototype.getRotation=function(){return this.rotation_},n.prototype.getScale=function(){return this.scale_},n.prototype.getScaleArray=function(){return this.scaleArray_},n.prototype.getStroke=function(){return this.stroke_},n.prototype.getText=function(){return this.text_},n.prototype.getTextAlign=function(){return this.textAlign_},n.prototype.getTextBaseline=function(){return this.textBaseline_},n.prototype.getBackgroundFill=function(){return this.backgroundFill_},n.prototype.getBackgroundStroke=function(){return this.backgroundStroke_},n.prototype.getPadding=function(){return this.padding_},n.prototype.setOverflow=function(e){this.overflow_=e},n.prototype.setFont=function(e){this.font_=e},n.prototype.setMaxAngle=function(e){this.maxAngle_=e},n.prototype.setOffsetX=function(e){this.offsetX_=e},n.prototype.setOffsetY=function(e){this.offsetY_=e},n.prototype.setPlacement=function(e){this.placement_=e},n.prototype.setRotateWithView=function(e){this.rotateWithView_=e},n.prototype.setFill=function(e){this.fill_=e},n.prototype.setRotation=function(e){this.rotation_=e},n.prototype.setScale=function(e){this.scale_=e,this.scaleArray_=pn(e!==void 0?e:1)},n.prototype.setStroke=function(e){this.stroke_=e},n.prototype.setText=function(e){this.text_=e},n.prototype.setTextAlign=function(e){this.textAlign_=e},n.prototype.setTextBaseline=function(e){this.textBaseline_=e},n.prototype.setBackgroundFill=function(e){this.backgroundFill_=e},n.prototype.setBackgroundStroke=function(e){this.backgroundStroke_=e},n.prototype.setPadding=function(e){this.padding_=e},n}(),yy=pf,z={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source"},_f=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),gf=function(n){_f(e,n);function e(t){var i=n.call(this)||this;i.on,i.once,i.un;var r=pt({},t);return typeof t.properties=="object"&&(delete r.properties,pt(r,t.properties)),r[z.OPACITY]=t.opacity!==void 0?t.opacity:1,X(typeof r[z.OPACITY]=="number",64),r[z.VISIBLE]=t.visible!==void 0?t.visible:!0,r[z.Z_INDEX]=t.zIndex,r[z.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,r[z.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,r[z.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,r[z.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,i.className_=r.className!==void 0?t.className:"ol-layer",delete r.className,i.setProperties(r),i.state_=null,i}return e.prototype.getClassName=function(){return this.className_},e.prototype.getLayerState=function(t){var i=this.state_||{layer:this,managed:t===void 0?!0:t},r=this.getZIndex();return i.opacity=at(Math.round(this.getOpacity()*100)/100,0,1),i.sourceState=this.getSourceState(),i.visible=this.getVisible(),i.extent=this.getExtent(),i.zIndex=r===void 0&&!i.managed?1/0:r,i.maxResolution=this.getMaxResolution(),i.minResolution=Math.max(this.getMinResolution(),0),i.minZoom=this.getMinZoom(),i.maxZoom=this.getMaxZoom(),this.state_=i,i},e.prototype.getLayersArray=function(t){return A()},e.prototype.getLayerStatesArray=function(t){return A()},e.prototype.getExtent=function(){return this.get(z.EXTENT)},e.prototype.getMaxResolution=function(){return this.get(z.MAX_RESOLUTION)},e.prototype.getMinResolution=function(){return this.get(z.MIN_RESOLUTION)},e.prototype.getMinZoom=function(){return this.get(z.MIN_ZOOM)},e.prototype.getMaxZoom=function(){return this.get(z.MAX_ZOOM)},e.prototype.getOpacity=function(){return this.get(z.OPACITY)},e.prototype.getSourceState=function(){return A()},e.prototype.getVisible=function(){return this.get(z.VISIBLE)},e.prototype.getZIndex=function(){return this.get(z.Z_INDEX)},e.prototype.setExtent=function(t){this.set(z.EXTENT,t)},e.prototype.setMaxResolution=function(t){this.set(z.MAX_RESOLUTION,t)},e.prototype.setMinResolution=function(t){this.set(z.MIN_RESOLUTION,t)},e.prototype.setMaxZoom=function(t){this.set(z.MAX_ZOOM,t)},e.prototype.setMinZoom=function(t){this.set(z.MIN_ZOOM,t)},e.prototype.setOpacity=function(t){X(typeof t=="number",64),this.set(z.OPACITY,t)},e.prototype.setVisible=function(t){this.set(z.VISIBLE,t)},e.prototype.setZIndex=function(t){this.set(z.Z_INDEX,t)},e.prototype.disposeInternal=function(){this.state_&&(this.state_.layer=null,this.state_=null),n.prototype.disposeInternal.call(this)},e}(Pt),Ws=gf,Oe={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"},yf=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),mf=function(n){yf(e,n);function e(t){var i=this,r=pt({},t);delete r.source,i=n.call(this,r)||this,i.on,i.once,i.un,i.mapPrecomposeKey_=null,i.mapRenderKey_=null,i.sourceChangeKey_=null,i.renderer_=null,t.render&&(i.render=t.render),t.map&&i.setMap(t.map),i.addChangeListener(z.SOURCE,i.handleSourcePropertyChange_);var a=t.source?t.source:null;return i.setSource(a),i}return e.prototype.getLayersArray=function(t){var i=t||[];return i.push(this),i},e.prototype.getLayerStatesArray=function(t){var i=t||[];return i.push(this.getLayerState()),i},e.prototype.getSource=function(){return this.get(z.SOURCE)||null},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():Oe.UNDEFINED},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(Z(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=B(t,b.CHANGE,this.handleSourceChange_,this)),this.changed()},e.prototype.getFeatures=function(t){return this.renderer_?this.renderer_.getFeatures(t):new Promise(function(i){return i([])})},e.prototype.render=function(t,i){var r=this.getRenderer();if(r.prepareFrame(t))return r.renderFrame(t,i)},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&(Z(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(Z(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=B(t,Ce.PRECOMPOSE,function(i){var r=i,a=r.frameState.layerStatesArray,s=this.getLayerState(!1);X(!a.some(function(o){return o.layer===s.layer}),67),a.push(s)},this),this.mapRenderKey_=B(this,b.CHANGE,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(z.SOURCE,t)},e.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},e.prototype.hasRenderer=function(){return!!this.renderer_},e.prototype.createRenderer=function(){return null},e.prototype.disposeInternal=function(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),n.prototype.disposeInternal.call(this)},e}(Ws);function En(n,e){if(!n.visible)return!1;var t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;var i=e.zoom;return i>n.minZoom&&i<=n.maxZoom}var Mf=mf;function Ef(n,e,t,i,r){Ys(n,e,t||0,i||n.length-1,r||xf)}function Ys(n,e,t,i,r){for(;i>t;){if(i-t>600){var a=i-t+1,s=e-t+1,o=Math.log(a),h=.5*Math.exp(2*o/3),l=.5*Math.sqrt(o*h*(a-h)/a)*(s-a/2<0?-1:1),u=Math.max(t,Math.floor(e-s*h/a+l)),f=Math.min(i,Math.floor(e+(a-s)*h/a+l));Ys(n,e,u,f,r)}var c=n[e],d=t,v=i;for(wi(n,t,e),r(n[i],c)>0&&wi(n,t,i);d<v;){for(wi(n,d,v),d++,v--;r(n[d],c)<0;)d++;for(;r(n[v],c)>0;)v--}r(n[t],c)===0?wi(n,t,v):(v++,wi(n,v,i)),v<=e&&(t=v+1),e<=v&&(i=v-1)}}function wi(n,e,t){var i=n[e];n[e]=n[t],n[t]=i}function xf(n,e){return n<e?-1:n>e?1:0}class Vs{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!Cn(e,t))return i;const r=this.toBBox,a=[];for(;t;){for(let s=0;s<t.children.length;s++){const o=t.children[s],h=t.leaf?r(o):o;Cn(e,h)&&(t.leaf?i.push(o):Gr(e,h)?this._all(o,i):a.push(o))}t=a.pop()}return i}collides(e){let t=this.data;if(!Cn(e,t))return!1;const i=[];for(;t;){for(let r=0;r<t.children.length;r++){const a=t.children[r],s=t.leaf?this.toBBox(a):a;if(Cn(e,s)){if(t.leaf||Gr(e,s))return!0;i.push(a)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Ke([]),this}remove(e,t){if(!e)return this;let i=this.data;const r=this.toBBox(e),a=[],s=[];let o,h,l;for(;i||a.length;){if(i||(i=a.pop(),h=a[a.length-1],o=s.pop(),l=!0),i.leaf){const u=Cf(e,i.children,t);if(u!==-1)return i.children.splice(u,1),a.push(i),this._condense(a),this}!l&&!i.leaf&&Gr(i,r)?(a.push(i),s.push(o),o=0,h=i,i=i.children[0]):h?(o++,i=h.children[o],l=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,r){const a=i-t+1;let s=this._maxEntries,o;if(a<=s)return o=Ke(e.slice(t,i+1)),Ve(o,this.toBBox),o;r||(r=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,r-1))),o=Ke([]),o.leaf=!1,o.height=r;const h=Math.ceil(a/s),l=h*Math.ceil(Math.sqrt(s));Ks(e,t,i,l,this.compareMinX);for(let u=t;u<=i;u+=l){const f=Math.min(u+l-1,i);Ks(e,u,f,h,this.compareMinY);for(let c=u;c<=f;c+=h){const d=Math.min(c+h-1,f);o.children.push(this._build(e,c,d,r-1))}}return Ve(o,this.toBBox),o}_chooseSubtree(e,t,i,r){for(;r.push(t),!(t.leaf||r.length-1===i);){let a=1/0,s=1/0,o;for(let h=0;h<t.children.length;h++){const l=t.children[h],u=Fr(l),f=Rf(e,l)-u;f<s?(s=f,a=u<a?u:a,o=l):f===s&&u<a&&(a=u,o=l)}t=o||t.children[0]}return t}_insert(e,t,i){const r=i?e:this.toBBox(e),a=[],s=this._chooseSubtree(r,this.data,t,a);for(s.children.push(e),Ti(s,r);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(r,a,t)}_split(e,t){const i=e[t],r=i.children.length,a=this._minEntries;this._chooseSplitAxis(i,a,r);const s=this._chooseSplitIndex(i,a,r),o=Ke(i.children.splice(s,i.children.length-s));o.height=i.height,o.leaf=i.leaf,Ve(i,this.toBBox),Ve(o,this.toBBox),t?e[t-1].children.push(o):this._splitRoot(i,o)}_splitRoot(e,t){this.data=Ke([e,t]),this.data.height=e.height+1,this.data.leaf=!1,Ve(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let r,a=1/0,s=1/0;for(let o=t;o<=i-t;o++){const h=Si(e,0,o,this.toBBox),l=Si(e,o,i,this.toBBox),u=wf(h,l),f=Fr(h)+Fr(l);u<a?(a=u,r=o,s=f<s?f:s):u===a&&f<s&&(s=f,r=o)}return r||i-t}_chooseSplitAxis(e,t,i){const r=e.leaf?this.compareMinX:If,a=e.leaf?this.compareMinY:Of,s=this._allDistMargin(e,t,i,r),o=this._allDistMargin(e,t,i,a);s<o&&e.children.sort(r)}_allDistMargin(e,t,i,r){e.children.sort(r);const a=this.toBBox,s=Si(e,0,t,a),o=Si(e,i-t,i,a);let h=xn(s)+xn(o);for(let l=t;l<i-t;l++){const u=e.children[l];Ti(s,e.leaf?a(u):u),h+=xn(s)}for(let l=i-t-1;l>=t;l--){const u=e.children[l];Ti(o,e.leaf?a(u):u),h+=xn(o)}return h}_adjustParentBBoxes(e,t,i){for(let r=i;r>=0;r--)Ti(t[r],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():Ve(e[t],this.toBBox)}}function Cf(n,e,t){if(!t)return e.indexOf(n);for(let i=0;i<e.length;i++)if(t(n,e[i]))return i;return-1}function Ve(n,e){Si(n,0,n.children.length,e,n)}function Si(n,e,t,i,r){r||(r=Ke(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let a=e;a<t;a++){const s=n.children[a];Ti(r,n.leaf?i(s):s)}return r}function Ti(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function If(n,e){return n.minX-e.minX}function Of(n,e){return n.minY-e.minY}function Fr(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function xn(n){return n.maxX-n.minX+(n.maxY-n.minY)}function Rf(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function wf(n,e){const t=Math.max(n.minX,e.minX),i=Math.max(n.minY,e.minY),r=Math.min(n.maxX,e.maxX),a=Math.min(n.maxY,e.maxY);return Math.max(0,r-t)*Math.max(0,a-i)}function Gr(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function Cn(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function Ke(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Ks(n,e,t,i,r){const a=[e,t];for(;a.length;){if(t=a.pop(),e=a.pop(),t-e<=i)continue;const s=e+Math.ceil((t-e)/i/2)*i;Ef(n,s,e,t,r),a.push(e,s,s,t)}}var Sf=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),qs={RENDER_ORDER:"renderOrder"},Tf=function(n){Sf(e,n);function e(t){var i=this,r=t||{},a=pt({},r);return delete a.style,delete a.renderBuffer,delete a.updateWhileAnimating,delete a.updateWhileInteracting,i=n.call(this,a)||this,i.declutter_=r.declutter!==void 0?r.declutter:!1,i.renderBuffer_=r.renderBuffer!==void 0?r.renderBuffer:100,i.style_=null,i.styleFunction_=void 0,i.setStyle(r.style),i.updateWhileAnimating_=r.updateWhileAnimating!==void 0?r.updateWhileAnimating:!1,i.updateWhileInteracting_=r.updateWhileInteracting!==void 0?r.updateWhileInteracting:!1,i}return e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.getFeatures=function(t){return n.prototype.getFeatures.call(this,t)},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(qs.RENDER_ORDER)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.renderDeclutter=function(t){t.declutterTree||(t.declutterTree=new Vs(9)),this.getRenderer().renderDeclutter(t)},e.prototype.setRenderOrder=function(t){this.set(qs.RENDER_ORDER,t)},e.prototype.setStyle=function(t){this.style_=t!==void 0?t:df,this.styleFunction_=t===null?void 0:cf(this.style_),this.changed()},e}(Mf),Pf=Tf,Pi={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},In=[Pi.FILL],ee=[Pi.STROKE],Re=[Pi.BEGIN_PATH],Hs=[Pi.CLOSE_PATH],L=Pi,Af=function(){function n(){}return n.prototype.drawCustom=function(e,t,i,r){},n.prototype.drawGeometry=function(e){},n.prototype.setStyle=function(e){},n.prototype.drawCircle=function(e,t){},n.prototype.drawFeature=function(e,t){},n.prototype.drawGeometryCollection=function(e,t){},n.prototype.drawLineString=function(e,t){},n.prototype.drawMultiLineString=function(e,t){},n.prototype.drawMultiPoint=function(e,t){},n.prototype.drawMultiPolygon=function(e,t){},n.prototype.drawPoint=function(e,t){},n.prototype.drawPolygon=function(e,t){},n.prototype.drawText=function(e,t){},n.prototype.setFillStrokeStyle=function(e,t){},n.prototype.setImageStyle=function(e,t){},n.prototype.setTextStyle=function(e,t){},n}(),Zs=Af,Lf=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Nf=function(n){Lf(e,n);function e(t,i,r,a){var s=n.call(this)||this;return s.tolerance=t,s.maxExtent=i,s.pixelRatio=a,s.maxLineWidth=0,s.resolution=r,s.beginGeometryInstruction1_=null,s.beginGeometryInstruction2_=null,s.bufferedMaxExtent_=null,s.instructions=[],s.coordinates=[],s.tmpCoordinate_=[],s.hitDetectionInstructions=[],s.state={},s}return e.prototype.applyPixelRatio=function(t){var i=this.pixelRatio;return i==1?t:t.map(function(r){return r*i})},e.prototype.appendFlatPointCoordinates=function(t,i){for(var r=this.getBufferedMaxExtent(),a=this.tmpCoordinate_,s=this.coordinates,o=s.length,h=0,l=t.length;h<l;h+=i)a[0]=t[h],a[1]=t[h+1],Ga(r,a)&&(s[o++]=a[0],s[o++]=a[1]);return o},e.prototype.appendFlatLineCoordinates=function(t,i,r,a,s,o){var h=this.coordinates,l=h.length,u=this.getBufferedMaxExtent();o&&(i+=a);var f=t[i],c=t[i+1],d=this.tmpCoordinate_,v=!0,p,_,y;for(p=i+a;p<r;p+=a)d[0]=t[p],d[1]=t[p+1],y=or(u,d),y!==_?(v&&(h[l++]=f,h[l++]=c,v=!1),h[l++]=d[0],h[l++]=d[1]):y===ht.INTERSECTING?(h[l++]=d[0],h[l++]=d[1],v=!1):v=!0,f=d[0],c=d[1],_=y;return(s&&v||p===i+a)&&(h[l++]=f,h[l++]=c),l},e.prototype.drawCustomCoordinates_=function(t,i,r,a,s){for(var o=0,h=r.length;o<h;++o){var l=r[o],u=this.appendFlatLineCoordinates(t,i,l,a,!1,!1);s.push(u),i=l}return i},e.prototype.drawCustom=function(t,i,r,a){this.beginGeometry(t,i);var s=t.getType(),o=t.getStride(),h=this.coordinates.length,l,u,f,c,d;switch(s){case T.MULTI_POLYGON:l=t.getOrientedFlatCoordinates(),c=[];var v=t.getEndss();d=0;for(var p=0,_=v.length;p<_;++p){var y=[];d=this.drawCustomCoordinates_(l,d,v[p],o,y),c.push(y)}this.instructions.push([L.CUSTOM,h,c,t,r,Cr]),this.hitDetectionInstructions.push([L.CUSTOM,h,c,t,a||r,Cr]);break;case T.POLYGON:case T.MULTI_LINE_STRING:f=[],l=s==T.POLYGON?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),d=this.drawCustomCoordinates_(l,0,t.getEnds(),o,f),this.instructions.push([L.CUSTOM,h,f,t,r,Mi]),this.hitDetectionInstructions.push([L.CUSTOM,h,f,t,a||r,Mi]);break;case T.LINE_STRING:case T.CIRCLE:l=t.getFlatCoordinates(),u=this.appendFlatLineCoordinates(l,0,l.length,o,!1,!1),this.instructions.push([L.CUSTOM,h,u,t,r,te]),this.hitDetectionInstructions.push([L.CUSTOM,h,u,t,a||r,te]);break;case T.MULTI_POINT:l=t.getFlatCoordinates(),u=this.appendFlatPointCoordinates(l,o),u>h&&(this.instructions.push([L.CUSTOM,h,u,t,r,te]),this.hitDetectionInstructions.push([L.CUSTOM,h,u,t,a||r,te]));break;case T.POINT:l=t.getFlatCoordinates(),this.coordinates.push(l[0],l[1]),u=this.coordinates.length,this.instructions.push([L.CUSTOM,h,u,t,r]),this.hitDetectionInstructions.push([L.CUSTOM,h,u,t,a||r]);break}this.endGeometry(i)},e.prototype.beginGeometry=function(t,i){this.beginGeometryInstruction1_=[L.BEGIN_GEOMETRY,i,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[L.BEGIN_GEOMETRY,i,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},e.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}},e.prototype.reverseHitDetectionInstructions=function(){var t=this.hitDetectionInstructions;t.reverse();var i,r=t.length,a,s,o=-1;for(i=0;i<r;++i)a=t[i],s=a[0],s==L.END_GEOMETRY?o=i:s==L.BEGIN_GEOMETRY&&(a[2]=i,wh(this.hitDetectionInstructions,o,i),o=-1)},e.prototype.setFillStrokeStyle=function(t,i){var r=this.state;if(t){var a=t.getColor();r.fillStyle=Lt(a||Yt)}else r.fillStyle=void 0;if(i){var s=i.getColor();r.strokeStyle=Lt(s||Ii);var o=i.getLineCap();r.lineCap=o!==void 0?o:yn;var h=i.getLineDash();r.lineDash=h?h.slice():Ei;var l=i.getLineDashOffset();r.lineDashOffset=l||xi;var u=i.getLineJoin();r.lineJoin=u!==void 0?u:We;var f=i.getWidth();r.lineWidth=f!==void 0?f:Ri;var c=i.getMiterLimit();r.miterLimit=c!==void 0?c:Ci,r.lineWidth>this.maxLineWidth&&(this.maxLineWidth=r.lineWidth,this.bufferedMaxExtent_=null)}else r.strokeStyle=void 0,r.lineCap=void 0,r.lineDash=null,r.lineDashOffset=void 0,r.lineJoin=void 0,r.lineWidth=void 0,r.miterLimit=void 0},e.prototype.createFill=function(t){var i=t.fillStyle,r=[L.SET_FILL_STYLE,i];return typeof i!="string"&&r.push(!0),r},e.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},e.prototype.createStroke=function(t){return[L.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},e.prototype.updateFillStyle=function(t,i){var r=t.fillStyle;(typeof r!="string"||t.currentFillStyle!=r)&&(r!==void 0&&this.instructions.push(i.call(this,t)),t.currentFillStyle=r)},e.prototype.updateStrokeStyle=function(t,i){var r=t.strokeStyle,a=t.lineCap,s=t.lineDash,o=t.lineDashOffset,h=t.lineJoin,l=t.lineWidth,u=t.miterLimit;(t.currentStrokeStyle!=r||t.currentLineCap!=a||s!=t.currentLineDash&&!Ae(t.currentLineDash,s)||t.currentLineDashOffset!=o||t.currentLineJoin!=h||t.currentLineWidth!=l||t.currentMiterLimit!=u)&&(r!==void 0&&i.call(this,t),t.currentStrokeStyle=r,t.currentLineCap=a,t.currentLineDash=s,t.currentLineDashOffset=o,t.currentLineJoin=h,t.currentLineWidth=l,t.currentMiterLimit=u)},e.prototype.endGeometry=function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var i=[L.END_GEOMETRY,t];this.instructions.push(i),this.hitDetectionInstructions.push(i)},e.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Fa(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;ar(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},e}(Zs),Ai=Nf,Df=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ff=function(n){Df(e,n);function e(t,i,r,a){var s=n.call(this,t,i,r,a)||this;return s.hitDetectionImage_=null,s.image_=null,s.imagePixelRatio_=void 0,s.anchorX_=void 0,s.anchorY_=void 0,s.height_=void 0,s.opacity_=void 0,s.originX_=void 0,s.originY_=void 0,s.rotateWithView_=void 0,s.rotation_=void 0,s.scale_=void 0,s.width_=void 0,s.declutterImageWithText_=void 0,s}return e.prototype.drawPoint=function(t,i){if(!!this.image_){this.beginGeometry(t,i);var r=t.getFlatCoordinates(),a=t.getStride(),s=this.coordinates.length,o=this.appendFlatPointCoordinates(r,a);this.instructions.push([L.DRAW_IMAGE,s,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterImageWithText_]),this.hitDetectionInstructions.push([L.DRAW_IMAGE,s,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterImageWithText_]),this.endGeometry(i)}},e.prototype.drawMultiPoint=function(t,i){if(!!this.image_){this.beginGeometry(t,i);var r=t.getFlatCoordinates(),a=t.getStride(),s=this.coordinates.length,o=this.appendFlatPointCoordinates(r,a);this.instructions.push([L.DRAW_IMAGE,s,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterImageWithText_]),this.hitDetectionInstructions.push([L.DRAW_IMAGE,s,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterImageWithText_]),this.endGeometry(i)}},e.prototype.finish=function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,n.prototype.finish.call(this)},e.prototype.setImageStyle=function(t,i){var r=t.getAnchor(),a=t.getSize(),s=t.getHitDetectionImage(),o=t.getImage(this.pixelRatio),h=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=r[0],this.anchorY_=r[1],this.hitDetectionImage_=s,this.image_=o,this.height_=a[1],this.opacity_=t.getOpacity(),this.originX_=h[0]*this.imagePixelRatio_,this.originY_=h[1]*this.imagePixelRatio_,this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=a[0],this.declutterImageWithText_=i},e}(Ai),Gf=Ff,bf=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),kf=function(n){bf(e,n);function e(t,i,r,a){return n.call(this,t,i,r,a)||this}return e.prototype.drawFlatCoordinates_=function(t,i,r,a){var s=this.coordinates.length,o=this.appendFlatLineCoordinates(t,i,r,a,!1,!1),h=[L.MOVE_TO_LINE_TO,s,o];return this.instructions.push(h),this.hitDetectionInstructions.push(h),r},e.prototype.drawLineString=function(t,i){var r=this.state,a=r.strokeStyle,s=r.lineWidth;if(!(a===void 0||s===void 0)){this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,i),this.hitDetectionInstructions.push([L.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ei,xi],Re);var o=t.getFlatCoordinates(),h=t.getStride();this.drawFlatCoordinates_(o,0,o.length,h),this.hitDetectionInstructions.push(ee),this.endGeometry(i)}},e.prototype.drawMultiLineString=function(t,i){var r=this.state,a=r.strokeStyle,s=r.lineWidth;if(!(a===void 0||s===void 0)){this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,i),this.hitDetectionInstructions.push([L.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset],Re);for(var o=t.getEnds(),h=t.getFlatCoordinates(),l=t.getStride(),u=0,f=0,c=o.length;f<c;++f)u=this.drawFlatCoordinates_(h,u,o[f],l);this.hitDetectionInstructions.push(ee),this.endGeometry(i)}},e.prototype.finish=function(){var t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(ee),this.reverseHitDetectionInstructions(),this.state=null,n.prototype.finish.call(this)},e.prototype.applyStroke=function(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(ee),t.lastStroke=this.coordinates.length),t.lastStroke=0,n.prototype.applyStroke.call(this,t),this.instructions.push(Re)},e}(Ai),Bf=kf,jf=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),$f=function(n){jf(e,n);function e(t,i,r,a){return n.call(this,t,i,r,a)||this}return e.prototype.drawFlatCoordinatess_=function(t,i,r,a){var s=this.state,o=s.fillStyle!==void 0,h=s.strokeStyle!==void 0,l=r.length;this.instructions.push(Re),this.hitDetectionInstructions.push(Re);for(var u=0;u<l;++u){var f=r[u],c=this.coordinates.length,d=this.appendFlatLineCoordinates(t,i,f,a,!0,!h),v=[L.MOVE_TO_LINE_TO,c,d];this.instructions.push(v),this.hitDetectionInstructions.push(v),h&&(this.instructions.push(Hs),this.hitDetectionInstructions.push(Hs)),i=f}return o&&(this.instructions.push(In),this.hitDetectionInstructions.push(In)),h&&(this.instructions.push(ee),this.hitDetectionInstructions.push(ee)),i},e.prototype.drawCircle=function(t,i){var r=this.state,a=r.fillStyle,s=r.strokeStyle;if(!(a===void 0&&s===void 0)){this.setFillStrokeStyles_(),this.beginGeometry(t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([L.SET_FILL_STYLE,Yt]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([L.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset]);var o=t.getFlatCoordinates(),h=t.getStride(),l=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,h,!1,!1);var u=[L.CIRCLE,l];this.instructions.push(Re,u),this.hitDetectionInstructions.push(Re,u),r.fillStyle!==void 0&&(this.instructions.push(In),this.hitDetectionInstructions.push(In)),r.strokeStyle!==void 0&&(this.instructions.push(ee),this.hitDetectionInstructions.push(ee)),this.endGeometry(i)}},e.prototype.drawPolygon=function(t,i){var r=this.state,a=r.fillStyle,s=r.strokeStyle;if(!(a===void 0&&s===void 0)){this.setFillStrokeStyles_(),this.beginGeometry(t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([L.SET_FILL_STYLE,Yt]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([L.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset]);var o=t.getEnds(),h=t.getOrientedFlatCoordinates(),l=t.getStride();this.drawFlatCoordinatess_(h,0,o,l),this.endGeometry(i)}},e.prototype.drawMultiPolygon=function(t,i){var r=this.state,a=r.fillStyle,s=r.strokeStyle;if(!(a===void 0&&s===void 0)){this.setFillStrokeStyles_(),this.beginGeometry(t,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([L.SET_FILL_STYLE,Yt]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([L.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,r.lineDash,r.lineDashOffset]);for(var o=t.getEndss(),h=t.getOrientedFlatCoordinates(),l=t.getStride(),u=0,f=0,c=o.length;f<c;++f)u=this.drawFlatCoordinatess_(h,u,o[f],l);this.endGeometry(i)}},e.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var t=this.tolerance;if(t!==0)for(var i=this.coordinates,r=0,a=i.length;r<a;++r)i[r]=Ee(i[r],t);return n.prototype.finish.call(this)},e.prototype.setFillStrokeStyles_=function(){var t=this.state,i=t.fillStyle;i!==void 0&&this.updateFillStyle(t,this.createFill),t.strokeStyle!==void 0&&this.updateStrokeStyle(t,this.applyStroke)},e}(Ai),Js=$f;function Uf(n,e,t,i,r){var a=t,s=t,o=0,h=0,l=t,u,f,c,d,v,p,_,y,g,m;for(f=t;f<i;f+=r){var M=e[f],E=e[f+1];v!==void 0&&(g=M-v,m=E-p,d=Math.sqrt(g*g+m*m),_!==void 0&&(h+=c,u=Math.acos((_*g+y*m)/(c*d)),u>n&&(h>o&&(o=h,a=l,s=f),h=0,l=f-r)),c=d,_=g,y=m),v=M,p=E}return h+=d,h>o?[l,f]:[a,s]}var zf=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),On={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},Xf=function(n){zf(e,n);function e(t,i,r,a){var s=n.call(this,t,i,r,a)||this;return s.labels_=null,s.text_="",s.textOffsetX_=0,s.textOffsetY_=0,s.textRotateWithView_=void 0,s.textRotation_=0,s.textFillState_=null,s.fillStates={},s.textStrokeState_=null,s.strokeStates={},s.textState_={},s.textStates={},s.textKey_="",s.fillKey_="",s.strokeKey_="",s.declutterImageWithText_=void 0,s}return e.prototype.finish=function(){var t=n.prototype.finish.call(this);return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t},e.prototype.drawText=function(t,i){var r=this.textFillState_,a=this.textStrokeState_,s=this.textState_;if(!(this.text_===""||!s||!r&&!a)){var o=this.coordinates,h=o.length,l=t.getType(),u=null,f=t.getStride();if(s.placement===Xs.LINE&&(l==T.LINE_STRING||l==T.MULTI_LINE_STRING||l==T.POLYGON||l==T.MULTI_POLYGON)){if(!It(this.getBufferedMaxExtent(),t.getExtent()))return;var c=void 0;if(u=t.getFlatCoordinates(),l==T.LINE_STRING)c=[u.length];else if(l==T.MULTI_LINE_STRING)c=t.getEnds();else if(l==T.POLYGON)c=t.getEnds().slice(0,1);else if(l==T.MULTI_POLYGON){var d=t.getEndss();c=[];for(var v=0,p=d.length;v<p;++v)c.push(d[v][0])}this.beginGeometry(t,i);for(var _=s.textAlign,y=0,g=void 0,m=0,M=c.length;m<M;++m){if(_==null){var E=Uf(s.maxAngle,u,y,c[m],f);y=E[0],g=E[1]}else g=c[m];for(var v=y;v<g;v+=f)o.push(u[v],u[v+1]);var C=o.length;y=c[m],this.drawChars_(h,C),h=C}this.endGeometry(i)}else{var S=s.overflow?null:[];switch(l){case T.POINT:case T.MULTI_POINT:u=t.getFlatCoordinates();break;case T.LINE_STRING:u=t.getFlatMidpoint();break;case T.CIRCLE:u=t.getCenter();break;case T.MULTI_LINE_STRING:u=t.getFlatMidpoints(),f=2;break;case T.POLYGON:u=t.getFlatInteriorPoint(),s.overflow||S.push(u[2]/this.resolution),f=3;break;case T.MULTI_POLYGON:var O=t.getFlatInteriorPoints();u=[];for(var v=0,p=O.length;v<p;v+=3)s.overflow||S.push(O[v+2]/this.resolution),u.push(O[v],O[v+1]);if(u.length===0)return;f=2;break}var C=this.appendFlatPointCoordinates(u,f);if(C===h)return;if(S&&(C-h)/2!=u.length/f){var P=h/2;S=S.filter(function(tt,K){var et=o[(P+K)*2]===u[K*f]&&o[(P+K)*2+1]===u[K*f+1];return et||--P,et})}this.saveTextStates_(),(s.backgroundFill||s.backgroundStroke)&&(this.setFillStrokeStyle(s.backgroundFill,s.backgroundStroke),s.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),s.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,i);var F=s.padding;if(F!=Ie&&(s.scale[0]<0||s.scale[1]<0)){var N=s.padding[0],G=s.padding[1],k=s.padding[2],H=s.padding[3];s.scale[0]<0&&(G=-G,H=-H),s.scale[1]<0&&(N=-N,k=-k),F=[N,G,k,H]}var Y=this.pixelRatio;this.instructions.push([L.DRAW_IMAGE,h,C,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterImageWithText_,F==Ie?Ie:F.map(function(tt){return tt*Y}),!!s.backgroundFill,!!s.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,S]);var V=1/Y;this.hitDetectionInstructions.push([L.DRAW_IMAGE,h,C,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[V,V],NaN,this.declutterImageWithText_,F,!!s.backgroundFill,!!s.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,S]),this.endGeometry(i)}}},e.prototype.saveTextStates_=function(){var t=this.textStrokeState_,i=this.textState_,r=this.textFillState_,a=this.strokeKey_;t&&(a in this.strokeStates||(this.strokeStates[a]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var s=this.textKey_;s in this.textStates||(this.textStates[s]={font:i.font,textAlign:i.textAlign||Oi,textBaseline:i.textBaseline||mn,scale:i.scale});var o=this.fillKey_;r&&(o in this.fillStates||(this.fillStates[o]={fillStyle:r.fillStyle}))},e.prototype.drawChars_=function(t,i){var r=this.textStrokeState_,a=this.textState_,s=this.strokeKey_,o=this.textKey_,h=this.fillKey_;this.saveTextStates_();var l=this.pixelRatio,u=On[a.textBaseline],f=this.textOffsetY_*l,c=this.text_,d=r?r.lineWidth*Math.abs(a.scale[0])/2:0;this.instructions.push([L.DRAW_CHARS,t,i,u,a.overflow,h,a.maxAngle,l,f,s,d*l,c,o,1]),this.hitDetectionInstructions.push([L.DRAW_CHARS,t,i,u,a.overflow,h,a.maxAngle,1,f,s,d,c,o,1/l])},e.prototype.setTextStyle=function(t,i){var r,a,s;if(!t)this.text_="";else{var o=t.getFill();o?(a=this.textFillState_,a||(a={},this.textFillState_=a),a.fillStyle=Lt(o.getColor()||Yt)):(a=null,this.textFillState_=a);var h=t.getStroke();if(!h)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);var l=h.getLineDash(),u=h.getLineDashOffset(),f=h.getWidth(),c=h.getMiterLimit();s.lineCap=h.getLineCap()||yn,s.lineDash=l?l.slice():Ei,s.lineDashOffset=u===void 0?xi:u,s.lineJoin=h.getLineJoin()||We,s.lineWidth=f===void 0?Ri:f,s.miterLimit=c===void 0?Ci:c,s.strokeStyle=Lt(h.getColor()||Ii)}r=this.textState_;var d=t.getFont()||Bs;tf(d);var v=t.getScaleArray();r.overflow=t.getOverflow(),r.font=d,r.maxAngle=t.getMaxAngle(),r.placement=t.getPlacement(),r.textAlign=t.getTextAlign(),r.textBaseline=t.getTextBaseline()||mn,r.backgroundFill=t.getBackgroundFill(),r.backgroundStroke=t.getBackgroundStroke(),r.padding=t.getPadding()||Ie,r.scale=v===void 0?[1,1]:v;var p=t.getOffsetX(),_=t.getOffsetY(),y=t.getRotateWithView(),g=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=p===void 0?0:p,this.textOffsetY_=_===void 0?0:_,this.textRotateWithView_=y===void 0?!1:y,this.textRotation_=g===void 0?0:g,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:it(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=r.font+r.scale+(r.textAlign||"?")+(r.textBaseline||"?"),this.fillKey_=a?typeof a.fillStyle=="string"?a.fillStyle:"|"+it(a.fillStyle):""}this.declutterImageWithText_=i},e}(Ai),Wf=Xf,Yf={Circle:Js,Default:Ai,Image:Gf,LineString:Bf,Polygon:Js,Text:Wf},Vf=function(){function n(e,t,i,r){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}return n.prototype.finish=function(){var e={};for(var t in this.buildersByZIndex_){e[t]=e[t]||{};var i=this.buildersByZIndex_[t];for(var r in i){var a=i[r].finish();e[t][r]=a}}return e},n.prototype.getBuilder=function(e,t){var i=e!==void 0?e.toString():"0",r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);var a=r[t];if(a===void 0){var s=Yf[t];a=new s(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=a}return a},n}(),Qs=Vf,Kf=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),qf=function(n){Kf(e,n);function e(t){var i=n.call(this)||this;return i.boundHandleImageChange_=i.handleImageChange_.bind(i),i.layer_=t,i.declutterExecutorGroup=null,i}return e.prototype.getFeatures=function(t){return A()},e.prototype.prepareFrame=function(t){return A()},e.prototype.renderFrame=function(t,i){return A()},e.prototype.loadedTileCallback=function(t,i,r){t[i]||(t[i]={}),t[i][r.tileCoord.toString()]=r},e.prototype.createLoadedTileFinder=function(t,i,r){return function(a,s){var o=this.loadedTileCallback.bind(this,r,a);return t.forEachLoadedTile(i,a,s,o)}.bind(this)},e.prototype.forEachFeatureAtCoordinate=function(t,i,r,a,s){},e.prototype.getDataAtPixel=function(t,i,r){return null},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleFontsChanged=function(){},e.prototype.handleImageChange_=function(t){var i=t.target;i.getState()===W.LOADED&&this.renderIfReadyAndVisible()},e.prototype.loadImage=function(t){var i=t.getState();return i!=W.LOADED&&i!=W.ERROR&&t.addEventListener(b.CHANGE,this.boundHandleImageChange_),i==W.IDLE&&(t.load(),i=t.getState()),i==W.LOADED},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==Oe.READY&&t.changed()},e}(wa),Hf=qf,Zf=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Jf=function(n){Zf(e,n);function e(t,i,r,a){var s=n.call(this,t)||this;return s.inversePixelTransform=i,s.frameState=r,s.context=a,s}return e}(ue),to=Jf,Qf=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),tc=function(n){Qf(e,n);function e(t){var i=n.call(this,t)||this;return i.container=null,i.renderedResolution,i.tempTransform=At(),i.pixelTransform=At(),i.inversePixelTransform=At(),i.context=null,i.containerReused=!1,i}return e.prototype.useContainer=function(t,i,r){var a=this.getLayer().getClassName(),s,o;if(t&&t.style.opacity===ks(r)&&t.className===a){var h=t.firstElementChild;h instanceof HTMLCanvasElement&&(o=h.getContext("2d"))}if(o&&o.canvas.style.transform===i?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){s=document.createElement("div"),s.className=a;var l=s.style;l.position="absolute",l.width="100%",l.height="100%",o=Wt();var h=o.canvas;s.appendChild(h),l=h.style,l.position="absolute",l.left="0",l.transformOrigin="top left",this.container=s,this.context=o}},e.prototype.clipUnrotated=function(t,i,r){var a=$a(r),s=Ua(r),o=ja(r),h=Ba(r);ot(i.coordinateToPixelTransform,a),ot(i.coordinateToPixelTransform,s),ot(i.coordinateToPixelTransform,o),ot(i.coordinateToPixelTransform,h);var l=this.inversePixelTransform;ot(l,a),ot(l,s),ot(l,o),ot(l,h),t.save(),t.beginPath(),t.moveTo(Math.round(a[0]),Math.round(a[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(h[0]),Math.round(h[1])),t.clip()},e.prototype.dispatchRenderEvent_=function(t,i,r){var a=this.getLayer();if(a.hasListener(t)){var s=new to(t,this.inversePixelTransform,r,i);a.dispatchEvent(s)}},e.prototype.preRender=function(t,i){this.dispatchRenderEvent_(Ce.PRERENDER,t,i)},e.prototype.postRender=function(t,i){this.dispatchRenderEvent_(Ce.POSTRENDER,t,i)},e.prototype.getRenderTransform=function(t,i,r,a,s,o,h){var l=s/2,u=o/2,f=a/i,c=-f,d=-t[0]+h,v=-t[1];return ve(this.tempTransform,l,u,f,c,-r,d,v)},e.prototype.getDataAtPixel=function(t,i,r){var a=ot(this.inversePixelTransform,t.slice()),s=this.context,o=this.getLayer(),h=o.getExtent();if(h){var l=ot(i.pixelToCoordinateTransform,t.slice());if(!Ga(h,l))return null}var u;try{var f=Math.round(a[0]),c=Math.round(a[1]),d=document.createElement("canvas"),v=d.getContext("2d");d.width=1,d.height=1,v.clearRect(0,0,1,1),v.drawImage(s.canvas,f,c,1,1,0,0,1,1),u=v.getImageData(0,0,1,1).data}catch(p){return p.name==="SecurityError"?new Uint8Array:u}return u[3]===0?null:u},e}(Hf),ec=tc,J={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"};function ic(n,e,t,i,r,a,s,o,h,l,u,f){var c=n[e],d=n[e+1],v=0,p=0,_=0,y=0;function g(){v=c,p=d,e+=i,c=n[e],d=n[e+1],y+=_,_=Math.sqrt((c-v)*(c-v)+(d-p)*(d-p))}do g();while(e<t-i&&y+_<a);for(var m=_===0?0:(a-y)/_,M=zt(v,c,m),E=zt(p,d,m),C=e-i,S=y,O=a+o*h(l,r,u);e<t-i&&y+_<O;)g();m=_===0?0:(O-y)/_;var P=zt(v,c,m),F=zt(p,d,m),N;if(f){var G=[M,E,P,F];ns(G,0,4,2,f,G,G),N=G[0]>G[2]}else N=M>P;var k=Math.PI,H=[],Y=C+i===e;e=C,_=0,y=S,c=n[e],d=n[e+1];var V;if(Y){g(),V=Math.atan2(d-p,c-v),N&&(V+=V>0?-k:k);var U=(P+M)/2,tt=(F+E)/2;return H[0]=[U,tt,(O-a)/2,V,r],H}for(var K=0,et=r.length;K<et;){g();var ut=Math.atan2(d-p,c-v);if(N&&(ut+=ut>0?-k:k),V!==void 0){var I=ut-V;if(I+=I>k?-2*k:I<-k?2*k:0,Math.abs(I)>s)return null}V=ut;for(var Bt=K,jt=0;K<et;++K){var si=N?et-K-1:K,Ki=o*h(l,r[si],u);if(e+i<t&&y+_<a+jt+Ki/2)break;jt+=Ki}if(K!==Bt){var Vn=N?r.substring(et-Bt,et-K):r.substring(Bt,K);m=_===0?0:(a+jt/2-y)/_;var U=zt(v,c,m),tt=zt(p,d,m);H.push([U,tt,jt/2,ut,Vn]),a+=jt}}return H}var qe=Qt(),ie=[],Kt=[],qt=[],ne=[];function eo(n){return n[3].declutterBox}var nc=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function io(n,e){return(e==="start"||e==="end")&&!nc.test(n)&&(e=e==="start"?"left":"right"),On[e]}var rc=function(){function n(e,t,i,r){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=At(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={}}return n.prototype.createLabel=function(e,t,i,r){var a=e+t+i+r;if(this.labels_[a])return this.labels_[a];var s=r?this.strokeStates[r]:null,o=i?this.fillStates[i]:null,h=this.textStates[t],l=this.pixelRatio,u=[h.scale[0]*l,h.scale[1]*l],f=io(e,h.textAlign||Oi),c=r&&s.lineWidth?s.lineWidth:0,d=e.split(`
`),v=d.length,p=[],_=nf(h.font,d,p),y=ef(h.font),g=y*v,m=_+c,M=[],E=(m+2)*u[0],C=(g+c)*u[1],S={width:E<0?Math.floor(E):Math.ceil(E),height:C<0?Math.floor(C):Math.ceil(C),contextInstructions:M};if((u[0]!=1||u[1]!=1)&&M.push("scale",u),M.push("font",h.font),r){M.push("strokeStyle",s.strokeStyle),M.push("lineWidth",c),M.push("lineCap",s.lineCap),M.push("lineJoin",s.lineJoin),M.push("miterLimit",s.miterLimit);var O=sn?OffscreenCanvasRenderingContext2D:CanvasRenderingContext2D;O.prototype.setLineDash&&(M.push("setLineDash",[s.lineDash]),M.push("lineDashOffset",s.lineDashOffset))}i&&M.push("fillStyle",o.fillStyle),M.push("textBaseline","middle"),M.push("textAlign","center");var P=.5-f,F=f*m+P*c,N;if(r)for(N=0;N<v;++N)M.push("strokeText",[d[N],F+P*p[N],.5*(c+y)+N*y]);if(i)for(N=0;N<v;++N)M.push("fillText",[d[N],F+P*p[N],.5*(c+y)+N*y]);return this.labels_[a]=S,S},n.prototype.replayTextBackground_=function(e,t,i,r,a,s,o){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,r),e.lineTo.apply(e,a),e.lineTo.apply(e,t),s&&(this.alignFill_=s[2],this.fill_(e)),o&&(this.setStrokeStyle_(e,o),e.stroke())},n.prototype.calculateImageOrLabelDimensions_=function(e,t,i,r,a,s,o,h,l,u,f,c,d,v,p,_){o*=c[0],h*=c[1];var y=i-o,g=r-h,m=a+l>e?e-l:a,M=s+u>t?t-u:s,E=v[3]+m*c[0]+v[1],C=v[0]+M*c[1]+v[2],S=y-v[3],O=g-v[0];(p||f!==0)&&(ie[0]=S,ne[0]=S,ie[1]=O,Kt[1]=O,Kt[0]=S+E,qt[0]=Kt[0],qt[1]=O+C,ne[1]=qt[1]);var P;return f!==0?(P=ve(At(),i,r,1,1,f,-i,-r),ot(P,ie),ot(P,Kt),ot(P,qt),ot(P,ne),ke(Math.min(ie[0],Kt[0],qt[0],ne[0]),Math.min(ie[1],Kt[1],qt[1],ne[1]),Math.max(ie[0],Kt[0],qt[0],ne[0]),Math.max(ie[1],Kt[1],qt[1],ne[1]),qe)):ke(Math.min(S,S+E),Math.min(O,O+C),Math.max(S,S+E),Math.max(O,O+C),qe),d&&(y=Math.round(y),g=Math.round(g)),{drawImageX:y,drawImageY:g,drawImageW:m,drawImageH:M,originX:l,originY:u,declutterBox:{minX:qe[0],minY:qe[1],maxX:qe[2],maxY:qe[3],value:_},canvasTransform:P,scale:c}},n.prototype.replayImageOrLabel_=function(e,t,i,r,a,s,o){var h=!!(s||o),l=r.declutterBox,u=e.canvas,f=o?o[2]*r.scale[0]/2:0,c=l.minX-f<=u.width/t&&l.maxX+f>=0&&l.minY-f<=u.height/t&&l.maxY+f>=0;return c&&(h&&this.replayTextBackground_(e,ie,Kt,qt,ne,s,o),rf(e,r.canvasTransform,a,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0},n.prototype.fill_=function(e){if(this.alignFill_){var t=ot(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;e.save(),e.translate(t[0]%i,t[1]%i),e.rotate(this.viewRotation_)}e.fill(),this.alignFill_&&e.restore()},n.prototype.setStrokeStyle_=function(e,t){e.strokeStyle=t[1],e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.setLineDash&&(e.lineDashOffset=t[7],e.setLineDash(t[6]))},n.prototype.drawLabelWithPointPlacement_=function(e,t,i,r){var a=this.textStates[t],s=this.createLabel(e,t,r,i),o=this.strokeStates[i],h=this.pixelRatio,l=io(e,a.textAlign||Oi),u=On[a.textBaseline||mn],f=o&&o.lineWidth?o.lineWidth:0,c=s.width/h-2*a.scale[0],d=l*c+2*(.5-l)*f,v=u*s.height/h+2*(.5-u)*f;return{label:s,anchorX:d,anchorY:v}},n.prototype.execute_=function(e,t,i,r,a,s,o,h){var l;this.pixelCoordinates_&&Ae(i,this.renderedTransform_)?l=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),l=me(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),Vh(this.renderedTransform_,i));for(var u=0,f=r.length,c=0,d,v,p,_,y,g,m,M,E,C,S,O,P=0,F=0,N=null,G=null,k=this.coordinateCache_,H=this.viewRotation_,Y=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,V={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:H},U=this.instructions!=r||this.overlaps?0:200,tt,K,et,ut;u<f;){var I=r[u],Bt=I[0];switch(Bt){case L.BEGIN_GEOMETRY:tt=I[1],ut=I[3],tt.getGeometry()?o!==void 0&&!It(o,ut.getExtent())?u=I[2]+1:++u:u=I[2];break;case L.BEGIN_PATH:P>U&&(this.fill_(e),P=0),F>U&&(e.stroke(),F=0),!P&&!F&&(e.beginPath(),_=NaN,y=NaN),++u;break;case L.CIRCLE:c=I[1];var jt=l[c],si=l[c+1],Ki=l[c+2],Vn=l[c+3],fa=Ki-jt,ca=Vn-si,da=Math.sqrt(fa*fa+ca*ca);e.moveTo(jt+da,si),e.arc(jt,si,da,0,2*Math.PI,!0),++u;break;case L.CLOSE_PATH:e.closePath(),++u;break;case L.CUSTOM:c=I[1],d=I[2];var uh=I[3],fh=I[4],va=I.length==6?I[5]:void 0;V.geometry=uh,V.feature=tt,u in k||(k[u]=[]);var oi=k[u];va?va(l,c,d,2,oi):(oi[0]=l[c],oi[1]=l[c+1],oi.length=2),fh(oi,V),++u;break;case L.DRAW_IMAGE:c=I[1],d=I[2],M=I[3],v=I[4],p=I[5];var Kn=I[6],ch=I[7],dh=I[8],vh=I[9],pa=I[10],qn=I[11],ph=I[12],qi=I[13],hi=I[14];if(!M&&I.length>=19){E=I[18],C=I[19],S=I[20],O=I[21];var Hn=this.drawLabelWithPointPlacement_(E,C,S,O);M=Hn.label,I[3]=M;var _h=I[22];v=(Hn.anchorX-_h)*this.pixelRatio,I[4]=v;var gh=I[23];p=(Hn.anchorY-gh)*this.pixelRatio,I[5]=p,Kn=M.height,I[6]=Kn,qi=M.width,I[13]=qi}var Zn=void 0;I.length>24&&(Zn=I[24]);var Jn=void 0,Hi=void 0,Zi=void 0;I.length>16?(Jn=I[15],Hi=I[16],Zi=I[17]):(Jn=Ie,Hi=!1,Zi=!1),pa&&Y?qn+=H:!pa&&!Y&&(qn-=H);for(var yh=0;c<d;c+=2)if(!(Zn&&Zn[yh++]<qi/this.pixelRatio)){var $t=this.calculateImageOrLabelDimensions_(M.width,M.height,l[c],l[c+1],qi,Kn,v,p,dh,vh,qn,ph,a,Jn,Hi||Zi,tt),_a=[e,t,M,$t,ch,Hi?N:null,Zi?G:null],Ji=void 0,Qn=void 0;if(h&&hi){var Qi=d-c;if(!hi[Qi]){hi[Qi]=_a;continue}if(Ji=hi[Qi],delete hi[Qi],Qn=eo(Ji),h.collides(Qn))continue}h&&h.collides($t.declutterBox)||(Ji&&(h&&h.insert(Qn),this.replayImageOrLabel_.apply(this,Ji)),h&&h.insert($t.declutterBox),this.replayImageOrLabel_.apply(this,_a))}++u;break;case L.DRAW_CHARS:var ga=I[1],ya=I[2],tr=I[3],mh=I[4];O=I[5];var Mh=I[6],ma=I[7],Ma=I[8];S=I[9];var er=I[10];E=I[11],C=I[12];var Ea=[I[13],I[13]],ir=this.textStates[C],li=ir.font,ui=[ir.scale[0]*ma,ir.scale[1]*ma],fi=void 0;li in this.widths_?fi=this.widths_[li]:(fi={},this.widths_[li]=fi);var xa=vs(l,ga,ya,2),Ca=Math.abs(ui[0])*$s(li,E,fi);if(mh||Ca<=xa){var Eh=this.textStates[C].textAlign,xh=(xa-Ca)*On[Eh],ci=ic(l,ga,ya,2,E,xh,Mh,Math.abs(ui[0]),$s,li,fi,Y?0:this.viewRotation_);t:if(ci){var di=[],Jt=void 0,tn=void 0,en=void 0,yt=void 0,Ct=void 0;if(S)for(Jt=0,tn=ci.length;Jt<tn;++Jt){Ct=ci[Jt],en=Ct[4],yt=this.createLabel(en,C,"",S),v=Ct[2]+(ui[0]<0?-er:er),p=tr*yt.height+(.5-tr)*2*er*ui[1]/ui[0]-Ma;var $t=this.calculateImageOrLabelDimensions_(yt.width,yt.height,Ct[0],Ct[1],yt.width,yt.height,v,p,0,0,Ct[3],Ea,!1,Ie,!1,tt);if(h&&h.collides($t.declutterBox))break t;di.push([e,t,yt,$t,1,null,null])}if(O)for(Jt=0,tn=ci.length;Jt<tn;++Jt){Ct=ci[Jt],en=Ct[4],yt=this.createLabel(en,C,O,""),v=Ct[2],p=tr*yt.height-Ma;var $t=this.calculateImageOrLabelDimensions_(yt.width,yt.height,Ct[0],Ct[1],yt.width,yt.height,v,p,0,0,Ct[3],Ea,!1,Ie,!1,tt);if(h&&h.collides($t.declutterBox))break t;di.push([e,t,yt,$t,1,null,null])}h&&h.load(di.map(eo));for(var nr=0,Ch=di.length;nr<Ch;++nr)this.replayImageOrLabel_.apply(this,di[nr])}}++u;break;case L.END_GEOMETRY:if(s!==void 0){tt=I[1];var Ia=s(tt,ut);if(Ia)return Ia}++u;break;case L.FILL:U?P++:this.fill_(e),++u;break;case L.MOVE_TO_LINE_TO:for(c=I[1],d=I[2],K=l[c],et=l[c+1],g=K+.5|0,m=et+.5|0,(g!==_||m!==y)&&(e.moveTo(K,et),_=g,y=m),c+=2;c<d;c+=2)K=l[c],et=l[c+1],g=K+.5|0,m=et+.5|0,(c==d-2||g!==_||m!==y)&&(e.lineTo(K,et),_=g,y=m);++u;break;case L.SET_FILL_STYLE:N=I,this.alignFill_=I[2],P&&(this.fill_(e),P=0,F&&(e.stroke(),F=0)),e.fillStyle=I[1],++u;break;case L.SET_STROKE_STYLE:G=I,F&&(e.stroke(),F=0),this.setStrokeStyle_(e,I),++u;break;case L.STROKE:U?F++:e.stroke(),++u;break;default:++u;break}}P&&this.fill_(e),F&&e.stroke()},n.prototype.execute=function(e,t,i,r,a,s){this.viewRotation_=r,this.execute_(e,t,i,this.instructions,a,void 0,void 0,s)},n.prototype.executeHitDetection=function(e,t,i,r,a){return this.viewRotation_=i,this.execute_(e,1,t,this.hitDetectionInstructions,!0,r,a)},n}(),ac=rc,br=[J.POLYGON,J.CIRCLE,J.LINE_STRING,J.IMAGE,J.TEXT,J.DEFAULT],sc=function(){function n(e,t,i,r,a,s){this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=s,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=At(),this.createExecutors_(a)}return n.prototype.clip=function(e,t){var i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()},n.prototype.createExecutors_=function(e){for(var t in e){var i=this.executorsByZIndex_[t];i===void 0&&(i={},this.executorsByZIndex_[t]=i);var r=e[t];for(var a in r){var s=r[a];i[a]=new ac(this.resolution_,this.pixelRatio_,this.overlaps_,s)}}},n.prototype.hasExecutors=function(e){for(var t in this.executorsByZIndex_)for(var i=this.executorsByZIndex_[t],r=0,a=e.length;r<a;++r)if(e[r]in i)return!0;return!1},n.prototype.forEachFeatureAtCoordinate=function(e,t,i,r,a,s){r=Math.round(r);var o=r*2+1,h=ve(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-i,-e[0],-e[1]),l=!this.hitDetectionContext_;l&&(this.hitDetectionContext_=Wt(o,o));var u=this.hitDetectionContext_;u.canvas.width!==o||u.canvas.height!==o?(u.canvas.width=o,u.canvas.height=o):l||u.clearRect(0,0,o,o);var f;this.renderBuffer_!==void 0&&(f=Qt(),Qh(f,e),ar(f,t*(this.renderBuffer_+r),f));var c=oc(r),d;function v(C,S){for(var O=u.getImageData(0,0,o,o).data,P=0,F=c.length;P<F;P++)if(O[c[P]]>0){if(!s||d!==J.IMAGE&&d!==J.TEXT||s.indexOf(C)!==-1){var N=(c[P]-3)/4,G=r-N%o,k=r-(N/o|0),H=a(C,S,G*G+k*k);if(H)return H}u.clearRect(0,0,o,o);break}}var p=Object.keys(this.executorsByZIndex_).map(Number);p.sort(vi);var _,y,g,m,M;for(_=p.length-1;_>=0;--_){var E=p[_].toString();for(g=this.executorsByZIndex_[E],y=br.length-1;y>=0;--y)if(d=br[y],m=g[d],m!==void 0&&(M=m.executeHitDetection(u,h,i,v,f),M))return M}},n.prototype.getClipCoords=function(e){var t=this.maxExtent_;if(!t)return null;var i=t[0],r=t[1],a=t[2],s=t[3],o=[i,r,i,s,a,s,a,r];return me(o,0,8,2,e,o),o},n.prototype.isEmpty=function(){return Ne(this.executorsByZIndex_)},n.prototype.execute=function(e,t,i,r,a,s,o){var h=Object.keys(this.executorsByZIndex_).map(Number);h.sort(vi),this.maxExtent_&&(e.save(),this.clip(e,i));var l=s||br,u,f,c,d,v,p;for(o&&h.reverse(),u=0,f=h.length;u<f;++u){var _=h[u].toString();for(v=this.executorsByZIndex_[_],c=0,d=l.length;c<d;++c){var y=l[c];p=v[y],p!==void 0&&p.execute(e,t,i,r,a,o)}}this.maxExtent_&&e.restore()},n}(),kr={};function oc(n){if(kr[n]!==void 0)return kr[n];for(var e=n*2+1,t=n*n,i=new Array(t+1),r=0;r<=n;++r)for(var a=0;a<=n;++a){var s=r*r+a*a;if(s>t)break;var o=i[s];o||(o=[],i[s]=o),o.push(((n+r)*e+(n+a))*4+3),r>0&&o.push(((n-r)*e+(n+a))*4+3),a>0&&(o.push(((n+r)*e+(n-a))*4+3),r>0&&o.push(((n-r)*e+(n-a))*4+3))}for(var h=[],r=0,l=i.length;r<l;++r)i[r]&&h.push.apply(h,i[r]);return kr[n]=h,h}var no=sc,ct={ANIMATING:0,INTERACTING:1},hc=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),lc=function(n){hc(e,n);function e(t,i,r,a,s,o,h){var l=n.call(this)||this;return l.context_=t,l.pixelRatio_=i,l.extent_=r,l.transform_=a,l.viewRotation_=s,l.squaredTolerance_=o,l.userTransform_=h,l.contextFillState_=null,l.contextStrokeState_=null,l.contextTextState_=null,l.fillState_=null,l.strokeState_=null,l.image_=null,l.imageAnchorX_=0,l.imageAnchorY_=0,l.imageHeight_=0,l.imageOpacity_=0,l.imageOriginX_=0,l.imageOriginY_=0,l.imageRotateWithView_=!1,l.imageRotation_=0,l.imageScale_=[0,0],l.imageWidth_=0,l.text_="",l.textOffsetX_=0,l.textOffsetY_=0,l.textRotateWithView_=!1,l.textRotation_=0,l.textScale_=[0,0],l.textFillState_=null,l.textStrokeState_=null,l.textState_=null,l.pixelCoordinates_=[],l.tmpLocalTransform_=At(),l}return e.prototype.drawImages_=function(t,i,r,a){if(!!this.image_){var s=me(t,i,r,a,this.transform_,this.pixelCoordinates_),o=this.context_,h=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);var u=this.imageRotation_;this.imageRotateWithView_&&(u+=this.viewRotation_);for(var f=0,c=s.length;f<c;f+=2){var d=s[f]-this.imageAnchorX_,v=s[f+1]-this.imageAnchorY_;if(u!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){var p=d+this.imageAnchorX_,_=v+this.imageAnchorY_;ve(h,p,_,1,1,u,-p,-_),o.setTransform.apply(o,h),o.translate(p,_),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.setTransform(1,0,0,1,0,0)}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,d,v,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}},e.prototype.drawText_=function(t,i,r,a){if(!(!this.textState_||this.text_==="")){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var s=me(t,i,r,a,this.transform_,this.pixelCoordinates_),o=this.context_,h=this.textRotation_;for(this.textRotateWithView_&&(h+=this.viewRotation_);i<r;i+=a){var l=s[i]+this.textOffsetX_,u=s[i+1]+this.textOffsetY_;if(h!==0||this.textScale_[0]!=1||this.textScale_[1]!=1){var f=ve(this.tmpLocalTransform_,l,u,1,1,h,-l,-u);o.setTransform.apply(o,f),o.translate(l,u),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.setTransform(1,0,0,1,0,0)}else this.textStrokeState_&&o.strokeText(this.text_,l,u),this.textFillState_&&o.fillText(this.text_,l,u)}}},e.prototype.moveToLineTo_=function(t,i,r,a,s){var o=this.context_,h=me(t,i,r,a,this.transform_,this.pixelCoordinates_);o.moveTo(h[0],h[1]);var l=h.length;s&&(l-=2);for(var u=2;u<l;u+=2)o.lineTo(h[u],h[u+1]);return s&&o.closePath(),r},e.prototype.drawRings_=function(t,i,r,a){for(var s=0,o=r.length;s<o;++s)i=this.moveToLineTo_(t,i,r[s],a,!0);return i},e.prototype.drawCircle=function(t){if(!!It(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var i=Xl(t,this.transform_,this.pixelCoordinates_),r=i[2]-i[0],a=i[3]-i[1],s=Math.sqrt(r*r+a*a),o=this.context_;o.beginPath(),o.arc(i[0],i[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}},e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},e.prototype.setTransform=function(t){this.transform_=t},e.prototype.drawGeometry=function(t){var i=t.getType();switch(i){case T.POINT:this.drawPoint(t);break;case T.LINE_STRING:this.drawLineString(t);break;case T.POLYGON:this.drawPolygon(t);break;case T.MULTI_POINT:this.drawMultiPoint(t);break;case T.MULTI_LINE_STRING:this.drawMultiLineString(t);break;case T.MULTI_POLYGON:this.drawMultiPolygon(t);break;case T.GEOMETRY_COLLECTION:this.drawGeometryCollection(t);break;case T.CIRCLE:this.drawCircle(t);break}},e.prototype.drawFeature=function(t,i){var r=i.getGeometryFunction()(t);!r||!It(this.extent_,r.getExtent())||(this.setStyle(i),this.drawGeometry(r))},e.prototype.drawGeometryCollection=function(t){for(var i=t.getGeometriesArray(),r=0,a=i.length;r<a;++r)this.drawGeometry(i[r])},e.prototype.drawPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var i=t.getFlatCoordinates(),r=t.getStride();this.image_&&this.drawImages_(i,0,i.length,r),this.text_!==""&&this.drawText_(i,0,i.length,r)},e.prototype.drawMultiPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var i=t.getFlatCoordinates(),r=t.getStride();this.image_&&this.drawImages_(i,0,i.length,r),this.text_!==""&&this.drawText_(i,0,i.length,r)},e.prototype.drawLineString=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!It(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var i=this.context_,r=t.getFlatCoordinates();i.beginPath(),this.moveToLineTo_(r,0,r.length,t.getStride(),!1),i.stroke()}if(this.text_!==""){var a=t.getFlatMidpoint();this.drawText_(a,0,2,2)}}},e.prototype.drawMultiLineString=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var i=t.getExtent();if(!!It(this.extent_,i)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var r=this.context_,a=t.getFlatCoordinates(),s=0,o=t.getEnds(),h=t.getStride();r.beginPath();for(var l=0,u=o.length;l<u;++l)s=this.moveToLineTo_(a,s,o[l],h,!1);r.stroke()}if(this.text_!==""){var f=t.getFlatMidpoints();this.drawText_(f,0,f.length,2)}}},e.prototype.drawPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!It(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var i=this.context_;i.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&i.fill(),this.strokeState_&&i.stroke()}if(this.text_!==""){var r=t.getFlatInteriorPoint();this.drawText_(r,0,2,2)}}},e.prototype.drawMultiPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!It(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var i=this.context_,r=t.getOrientedFlatCoordinates(),a=0,s=t.getEndss(),o=t.getStride();i.beginPath();for(var h=0,l=s.length;h<l;++h){var u=s[h];a=this.drawRings_(r,a,u,o)}this.fillState_&&i.fill(),this.strokeState_&&i.stroke()}if(this.text_!==""){var f=t.getFlatInteriorPoints();this.drawText_(f,0,f.length,2)}}},e.prototype.setContextFillState_=function(t){var i=this.context_,r=this.contextFillState_;r?r.fillStyle!=t.fillStyle&&(r.fillStyle=t.fillStyle,i.fillStyle=t.fillStyle):(i.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},e.prototype.setContextStrokeState_=function(t){var i=this.context_,r=this.contextStrokeState_;r?(r.lineCap!=t.lineCap&&(r.lineCap=t.lineCap,i.lineCap=t.lineCap),i.setLineDash&&(Ae(r.lineDash,t.lineDash)||i.setLineDash(r.lineDash=t.lineDash),r.lineDashOffset!=t.lineDashOffset&&(r.lineDashOffset=t.lineDashOffset,i.lineDashOffset=t.lineDashOffset)),r.lineJoin!=t.lineJoin&&(r.lineJoin=t.lineJoin,i.lineJoin=t.lineJoin),r.lineWidth!=t.lineWidth&&(r.lineWidth=t.lineWidth,i.lineWidth=t.lineWidth),r.miterLimit!=t.miterLimit&&(r.miterLimit=t.miterLimit,i.miterLimit=t.miterLimit),r.strokeStyle!=t.strokeStyle&&(r.strokeStyle=t.strokeStyle,i.strokeStyle=t.strokeStyle)):(i.lineCap=t.lineCap,i.setLineDash&&(i.setLineDash(t.lineDash),i.lineDashOffset=t.lineDashOffset),i.lineJoin=t.lineJoin,i.lineWidth=t.lineWidth,i.miterLimit=t.miterLimit,i.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},e.prototype.setContextTextState_=function(t){var i=this.context_,r=this.contextTextState_,a=t.textAlign?t.textAlign:Oi;r?(r.font!=t.font&&(r.font=t.font,i.font=t.font),r.textAlign!=a&&(r.textAlign=a,i.textAlign=a),r.textBaseline!=t.textBaseline&&(r.textBaseline=t.textBaseline,i.textBaseline=t.textBaseline)):(i.font=t.font,i.textAlign=a,i.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:a,textBaseline:t.textBaseline})},e.prototype.setFillStrokeStyle=function(t,i){var r=this;if(!t)this.fillState_=null;else{var a=t.getColor();this.fillState_={fillStyle:Lt(a||Yt)}}if(!i)this.strokeState_=null;else{var s=i.getColor(),o=i.getLineCap(),h=i.getLineDash(),l=i.getLineDashOffset(),u=i.getLineJoin(),f=i.getWidth(),c=i.getMiterLimit(),d=h||Ei;this.strokeState_={lineCap:o!==void 0?o:yn,lineDash:this.pixelRatio_===1?d:d.map(function(v){return v*r.pixelRatio_}),lineDashOffset:(l||xi)*this.pixelRatio_,lineJoin:u!==void 0?u:We,lineWidth:(f!==void 0?f:Ri)*this.pixelRatio_,miterLimit:c!==void 0?c:Ci,strokeStyle:Lt(s||Ii)}}},e.prototype.setImageStyle=function(t){var i;if(!t||!(i=t.getSize())){this.image_=null;return}var r=t.getAnchor(),a=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*this.pixelRatio_,this.imageAnchorY_=r[1]*this.pixelRatio_,this.imageHeight_=i[1]*this.pixelRatio_,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=a[0],this.imageOriginY_=a[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScaleArray(),this.imageWidth_=i[0]*this.pixelRatio_},e.prototype.setTextStyle=function(t){if(!t)this.text_="";else{var i=t.getFill();if(!i)this.textFillState_=null;else{var r=i.getColor();this.textFillState_={fillStyle:Lt(r||Yt)}}var a=t.getStroke();if(!a)this.textStrokeState_=null;else{var s=a.getColor(),o=a.getLineCap(),h=a.getLineDash(),l=a.getLineDashOffset(),u=a.getLineJoin(),f=a.getWidth(),c=a.getMiterLimit();this.textStrokeState_={lineCap:o!==void 0?o:yn,lineDash:h||Ei,lineDashOffset:l||xi,lineJoin:u!==void 0?u:We,lineWidth:f!==void 0?f:Ri,miterLimit:c!==void 0?c:Ci,strokeStyle:Lt(s||Ii)}}var d=t.getFont(),v=t.getOffsetX(),p=t.getOffsetY(),_=t.getRotateWithView(),y=t.getRotation(),g=t.getScaleArray(),m=t.getText(),M=t.getTextAlign(),E=t.getTextBaseline();this.textState_={font:d!==void 0?d:Bs,textAlign:M!==void 0?M:Oi,textBaseline:E!==void 0?E:mn},this.text_=m!==void 0?m:"",this.textOffsetX_=v!==void 0?this.pixelRatio_*v:0,this.textOffsetY_=p!==void 0?this.pixelRatio_*p:0,this.textRotateWithView_=_!==void 0?_:!1,this.textRotation_=y!==void 0?y:0,this.textScale_=[this.pixelRatio_*g[0],this.pixelRatio_*g[1]]}},e}(Zs),uc=lc,re={FRACTION:"fraction",PIXELS:"pixels"},Rt={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},fc=function(){function n(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}return n.prototype.clear=function(){this.cache_={},this.cacheSize_=0},n.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_},n.prototype.expire=function(){if(this.canExpireCache()){var e=0;for(var t in this.cache_){var i=this.cache_[t];(e++&3)==0&&!i.hasListener()&&(delete this.cache_[t],--this.cacheSize_)}}},n.prototype.get=function(e,t,i){var r=ro(e,t,i);return r in this.cache_?this.cache_[r]:null},n.prototype.set=function(e,t,i,r){var a=ro(e,t,i);this.cache_[a]=r,++this.cacheSize_},n.prototype.setSize=function(e){this.maxCacheSize_=e,this.expire()},n}();function ro(n,e,t){var i=t?Ps(t):"null";return e+":"+n+":"+i}var Rn=new fc,cc=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),dc=function(n){cc(e,n);function e(t,i,r,a){var s=n.call(this)||this;return s.extent=t,s.pixelRatio_=r,s.resolution=i,s.state=a,s}return e.prototype.changed=function(){this.dispatchEvent(b.CHANGE)},e.prototype.getExtent=function(){return this.extent},e.prototype.getImage=function(){return A()},e.prototype.getPixelRatio=function(){return this.pixelRatio_},e.prototype.getResolution=function(){return this.resolution},e.prototype.getState=function(){return this.state},e.prototype.load=function(){A()},e}(_i),vc=dc,pc=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();(function(n){pc(e,n);function e(t,i,r,a,s,o){var h=n.call(this,t,i,r,W.IDLE)||this;return h.src_=a,h.image_=new Image,s!==null&&(h.image_.crossOrigin=s),h.unlisten_=null,h.state=W.IDLE,h.imageLoadFunction_=o,h}return e.prototype.getImage=function(){return this.image_},e.prototype.handleImageError_=function(){this.state=W.ERROR,this.unlistenImage_(),this.changed()},e.prototype.handleImageLoad_=function(){this.resolution===void 0&&(this.resolution=_e(this.extent)/this.image_.height),this.state=W.LOADED,this.unlistenImage_(),this.changed()},e.prototype.load=function(){(this.state==W.IDLE||this.state==W.ERROR)&&(this.state=W.LOADING,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=ao(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.setImage=function(t){this.image_=t,this.resolution=_e(this.extent)/this.image_.height},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e})(vc);function ao(n,e,t){var i=n;if(i.src&&Wh){var r=i.decode(),a=!0,s=function(){a=!1};return r.then(function(){a&&e()}).catch(function(h){a&&(h.name==="EncodingError"&&h.message==="Invalid image type."?e():t())}),s}var o=[rn(i,b.LOAD,e),rn(i,b.ERROR,t)];return function(){o.forEach(Z)}}var _c=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Li=null,gc=function(n){_c(e,n);function e(t,i,r,a,s,o){var h=n.call(this)||this;return h.hitDetectionImage_=null,h.image_=t||new Image,a!==null&&(h.image_.crossOrigin=a),h.canvas_={},h.color_=o,h.unlisten_=null,h.imageState_=s,h.size_=r,h.src_=i,h.tainted_,h}return e.prototype.isTainted_=function(){if(this.tainted_===void 0&&this.imageState_===W.LOADED){Li||(Li=Wt(1,1)),Li.drawImage(this.image_,0,0);try{Li.getImageData(0,0,1,1),this.tainted_=!1}catch(t){Li=null,this.tainted_=!0}}return this.tainted_===!0},e.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(b.CHANGE)},e.prototype.handleImageError_=function(){this.imageState_=W.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.handleImageLoad_=function(){this.imageState_=W.LOADED,this.size_?(this.image_.width=this.size_[0],this.image_.height=this.size_[1]):this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.getImage=function(t){return this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_},e.prototype.getPixelRatio=function(t){return this.replaceColor_(t),this.canvas_[t]?t:1},e.prototype.getImageState=function(){return this.imageState_},e.prototype.getHitDetectionImage=function(){if(!this.hitDetectionImage_)if(this.isTainted_()){var t=this.size_[0],i=this.size_[1],r=Wt(t,i);r.fillRect(0,0,t,i),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},e.prototype.getSize=function(){return this.size_},e.prototype.getSrc=function(){return this.src_},e.prototype.load=function(){if(this.imageState_==W.IDLE){this.imageState_=W.LOADING;try{this.image_.src=this.src_}catch(t){this.handleImageError_()}this.unlisten_=ao(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}},e.prototype.replaceColor_=function(t){if(!(!this.color_||this.canvas_[t]||this.imageState_!==W.LOADED)){var i=document.createElement("canvas");this.canvas_[t]=i,i.width=Math.ceil(this.image_.width*t),i.height=Math.ceil(this.image_.height*t);var r=i.getContext("2d");if(r.scale(t,t),r.drawImage(this.image_,0,0),r.globalCompositeOperation="multiply",r.globalCompositeOperation==="multiply"||this.isTainted_())r.fillStyle=Ps(this.color_),r.fillRect(0,0,i.width/t,i.height/t),r.globalCompositeOperation="destination-in",r.drawImage(this.image_,0,0);else{for(var a=r.getImageData(0,0,i.width,i.height),s=a.data,o=this.color_[0]/255,h=this.color_[1]/255,l=this.color_[2]/255,u=this.color_[3],f=0,c=s.length;f<c;f+=4)s[f]*=o,s[f+1]*=h,s[f+2]*=l,s[f+3]*=u;r.putImageData(a,0,0)}}},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(_i);function yc(n,e,t,i,r,a){var s=Rn.get(e,i,a);return s||(s=new gc(n,e,t,i,r,a),Rn.set(e,i,a,s)),s}var mc=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Mc=function(n){mc(e,n);function e(t){var i=this,r=t||{},a=r.opacity!==void 0?r.opacity:1,s=r.rotation!==void 0?r.rotation:0,o=r.scale!==void 0?r.scale:1,h=r.rotateWithView!==void 0?r.rotateWithView:!1;i=n.call(this,{opacity:a,rotation:s,scale:o,displacement:r.displacement!==void 0?r.displacement:[0,0],rotateWithView:h})||this,i.anchor_=r.anchor!==void 0?r.anchor:[.5,.5],i.normalizedAnchor_=null,i.anchorOrigin_=r.anchorOrigin!==void 0?r.anchorOrigin:Rt.TOP_LEFT,i.anchorXUnits_=r.anchorXUnits!==void 0?r.anchorXUnits:re.FRACTION,i.anchorYUnits_=r.anchorYUnits!==void 0?r.anchorYUnits:re.FRACTION,i.crossOrigin_=r.crossOrigin!==void 0?r.crossOrigin:null;var l=r.img!==void 0?r.img:null,u=r.imgSize!==void 0?r.imgSize:null,f=r.src;X(!(f!==void 0&&l),4),X(!l||l&&u,5),(f===void 0||f.length===0)&&l&&(f=l.src||it(l)),X(f!==void 0&&f.length>0,6);var c=r.src!==void 0?W.IDLE:W.LOADED;return i.color_=r.color!==void 0?As(r.color):null,i.iconImage_=yc(l,f,u,i.crossOrigin_,c,i.color_),i.offset_=r.offset!==void 0?r.offset:[0,0],i.offsetOrigin_=r.offsetOrigin!==void 0?r.offsetOrigin:Rt.TOP_LEFT,i.origin_=null,i.size_=r.size!==void 0?r.size:null,i}return e.prototype.clone=function(){var t=this.getScale();return new e({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:this.size_!==null?this.size_.slice():void 0,opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},e.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var t=this.anchor_,i=this.getSize();if(this.anchorXUnits_==re.FRACTION||this.anchorYUnits_==re.FRACTION){if(!i)return null;t=this.anchor_.slice(),this.anchorXUnits_==re.FRACTION&&(t[0]*=i[0]),this.anchorYUnits_==re.FRACTION&&(t[1]*=i[1])}if(this.anchorOrigin_!=Rt.TOP_LEFT){if(!i)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_==Rt.TOP_RIGHT||this.anchorOrigin_==Rt.BOTTOM_RIGHT)&&(t[0]=-t[0]+i[0]),(this.anchorOrigin_==Rt.BOTTOM_LEFT||this.anchorOrigin_==Rt.BOTTOM_RIGHT)&&(t[1]=-t[1]+i[1])}var r=this.getDisplacement();return t[0]-=r[0],t[1]+=r[1],this.normalizedAnchor_=t,this.normalizedAnchor_},e.prototype.setAnchor=function(t){this.anchor_=t,this.normalizedAnchor_=null},e.prototype.getColor=function(){return this.color_},e.prototype.getImage=function(t){return this.iconImage_.getImage(t)},e.prototype.getPixelRatio=function(t){return this.iconImage_.getPixelRatio(t)},e.prototype.getImageSize=function(){return this.iconImage_.getSize()},e.prototype.getImageState=function(){return this.iconImage_.getImageState()},e.prototype.getHitDetectionImage=function(){return this.iconImage_.getHitDetectionImage()},e.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var t=this.offset_;if(this.offsetOrigin_!=Rt.TOP_LEFT){var i=this.getSize(),r=this.iconImage_.getSize();if(!i||!r)return null;t=t.slice(),(this.offsetOrigin_==Rt.TOP_RIGHT||this.offsetOrigin_==Rt.BOTTOM_RIGHT)&&(t[0]=r[0]-i[0]-t[0]),(this.offsetOrigin_==Rt.BOTTOM_LEFT||this.offsetOrigin_==Rt.BOTTOM_RIGHT)&&(t[1]=r[1]-i[1]-t[1])}return this.origin_=t,this.origin_},e.prototype.getSrc=function(){return this.iconImage_.getSrc()},e.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},e.prototype.listenImageChange=function(t){this.iconImage_.addEventListener(b.CHANGE,t)},e.prototype.load=function(){this.iconImage_.load()},e.prototype.unlistenImageChange=function(t){this.iconImage_.removeEventListener(b.CHANGE,t)},e}(Ts),Ec=Mc,Nt=.5;function xc(n,e,t,i,r,a,s){var o=n[0]*Nt,h=n[1]*Nt,l=Wt(o,h);l.imageSmoothingEnabled=!1;for(var u=l.canvas,f=new uc(l,Nt,r,null,s),c=t.length,d=Math.floor((256*256*256-1)/c),v={},p=1;p<=c;++p){var _=t[p-1],y=_.getStyleFunction()||i;if(!!i){var g=y(_,a);if(!!g){Array.isArray(g)||(g=[g]);for(var m=p*d,M="#"+("000000"+m.toString(16)).slice(-6),E=0,C=g.length;E<C;++E){var S=g[E],O=S.getGeometryFunction()(_);if(!(!O||!It(r,O.getExtent()))){var P=S.clone(),F=P.getFill();F&&F.setColor(M);var N=P.getStroke();N&&(N.setColor(M),N.setLineDash(null)),P.setText(void 0);var G=S.getImage();if(G&&G.getOpacity()!==0){var k=G.getImageSize();if(!k)continue;var H=Wt(k[0],k[1],void 0,{alpha:!1}),Y=H.canvas;H.fillStyle=M,H.fillRect(0,0,Y.width,Y.height),P.setImage(new Ec({img:Y,imgSize:k,anchor:G.getAnchor(),anchorXUnits:re.PIXELS,anchorYUnits:re.PIXELS,offset:G.getOrigin(),opacity:1,size:G.getSize(),scale:G.getScale(),rotation:G.getRotation(),rotateWithView:G.getRotateWithView()}))}var V=P.getZIndex()||0,U=v[V];U||(U={},v[V]=U,U[T.POLYGON]=[],U[T.CIRCLE]=[],U[T.LINE_STRING]=[],U[T.POINT]=[]),U[O.getType().replace("Multi","")].push(O,P)}}}}}for(var tt=Object.keys(v).map(Number).sort(vi),p=0,K=tt.length;p<K;++p){var U=v[tt[p]];for(var et in U)for(var ut=U[et],E=0,C=ut.length;E<C;E+=2){f.setStyle(ut[E+1]);for(var I=0,Bt=e.length;I<Bt;++I)f.setTransform(e[I]),f.drawGeometry(ut[E])}}return l.getImageData(0,0,u.width,u.height)}function Cc(n,e,t){var i=[];if(t){var r=Math.floor(Math.round(n[0])*Nt),a=Math.floor(Math.round(n[1])*Nt),s=(at(r,0,t.width-1)+at(a,0,t.height-1)*t.width)*4,o=t.data[s],h=t.data[s+1],l=t.data[s+2],u=l+256*(h+256*o),f=Math.floor((256*256*256-1)/e.length);u&&u%f==0&&i.push(e[u/f-1])}return i}var Ic=.5,so={Point:Nc,LineString:Pc,Polygon:Fc,MultiPoint:Dc,MultiLineString:Ac,MultiPolygon:Lc,GeometryCollection:Tc,Circle:wc};function Oc(n,e){return parseInt(it(n),10)-parseInt(it(e),10)}function Rc(n,e){var t=Br(n,e);return t*t}function Br(n,e){return Ic*n/e}function wc(n,e,t,i,r){var a=t.getFill(),s=t.getStroke();if(a||s){var o=n.getBuilder(t.getZIndex(),J.CIRCLE);o.setFillStrokeStyle(a,s),o.drawCircle(e,i)}var h=t.getText();if(h&&h.getText()){var l=(r||n).getBuilder(t.getZIndex(),J.TEXT);l.setTextStyle(h),l.drawText(e,i)}}function oo(n,e,t,i,r,a,s){var o=!1,h=t.getImage();if(h){var l=h.getImageState();l==W.LOADED||l==W.ERROR?h.unlistenImageChange(r):(l==W.IDLE&&h.load(),l=h.getImageState(),h.listenImageChange(r),o=!0)}return Sc(n,e,t,i,a,s),o}function Sc(n,e,t,i,r,a){var s=t.getGeometryFunction()(e);if(!!s){var o=s.simplifyTransformed(i,r),h=t.getRenderer();if(h)ho(n,o,t,e);else{var l=so[o.getType()];l(n,o,t,e,a)}}}function ho(n,e,t,i){if(e.getType()==T.GEOMETRY_COLLECTION){for(var r=e.getGeometries(),a=0,s=r.length;a<s;++a)ho(n,r[a],t,i);return}var o=n.getBuilder(t.getZIndex(),J.DEFAULT);o.drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer())}function Tc(n,e,t,i,r){var a=e.getGeometriesArray(),s,o;for(s=0,o=a.length;s<o;++s){var h=so[a[s].getType()];h(n,a[s],t,i,r)}}function Pc(n,e,t,i,r){var a=t.getStroke();if(a){var s=n.getBuilder(t.getZIndex(),J.LINE_STRING);s.setFillStrokeStyle(null,a),s.drawLineString(e,i)}var o=t.getText();if(o&&o.getText()){var h=(r||n).getBuilder(t.getZIndex(),J.TEXT);h.setTextStyle(o),h.drawText(e,i)}}function Ac(n,e,t,i,r){var a=t.getStroke();if(a){var s=n.getBuilder(t.getZIndex(),J.LINE_STRING);s.setFillStrokeStyle(null,a),s.drawMultiLineString(e,i)}var o=t.getText();if(o&&o.getText()){var h=(r||n).getBuilder(t.getZIndex(),J.TEXT);h.setTextStyle(o),h.drawText(e,i)}}function Lc(n,e,t,i,r){var a=t.getFill(),s=t.getStroke();if(s||a){var o=n.getBuilder(t.getZIndex(),J.POLYGON);o.setFillStrokeStyle(a,s),o.drawMultiPolygon(e,i)}var h=t.getText();if(h&&h.getText()){var l=(r||n).getBuilder(t.getZIndex(),J.TEXT);l.setTextStyle(h),l.drawText(e,i)}}function Nc(n,e,t,i,r){var a=t.getImage(),s=t.getText(),o;if(r&&(n=r,o=a&&s&&s.getText()?{}:void 0),a){if(a.getImageState()!=W.LOADED)return;var h=n.getBuilder(t.getZIndex(),J.IMAGE);h.setImageStyle(a,o),h.drawPoint(e,i)}if(s&&s.getText()){var l=n.getBuilder(t.getZIndex(),J.TEXT);l.setTextStyle(s,o),l.drawText(e,i)}}function Dc(n,e,t,i,r){var a=t.getImage(),s=t.getText(),o;if(r&&(n=r,o=a&&s&&s.getText()?{}:void 0),a){if(a.getImageState()!=W.LOADED)return;var h=n.getBuilder(t.getZIndex(),J.IMAGE);h.setImageStyle(a,o),h.drawMultiPoint(e,i)}if(s&&s.getText()){var l=(r||n).getBuilder(t.getZIndex(),J.TEXT);l.setTextStyle(s,o),l.drawText(e,i)}}function Fc(n,e,t,i,r){var a=t.getFill(),s=t.getStroke();if(a||s){var o=n.getBuilder(t.getZIndex(),J.POLYGON);o.setFillStrokeStyle(a,s),o.drawPolygon(e,i)}var h=t.getText();if(h&&h.getText()){var l=(r||n).getBuilder(t.getZIndex(),J.TEXT);l.setTextStyle(h),l.drawText(e,i)}}var Gc=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),bc=function(n){Gc(e,n);function e(t){var i=n.call(this,t)||this;return i.boundHandleStyleImageChange_=i.handleStyleImageChange_.bind(i),i.animatingOrInteracting_,i.dirty_=!1,i.hitDetectionImageData_=null,i.renderedFeatures_=null,i.renderedRevision_=-1,i.renderedResolution_=NaN,i.renderedExtent_=Qt(),i.wrappedRenderedExtent_=Qt(),i.renderedRotation_,i.renderedCenter_=null,i.renderedProjection_=null,i.renderedRenderOrder_=null,i.replayGroup_=null,i.replayGroupChanged=!0,i.declutterExecutorGroup=null,i.clipping=!0,i}return e.prototype.useContainer=function(t,i,r){r<1&&(t=null),n.prototype.useContainer.call(this,t,i,r)},e.prototype.renderWorlds=function(t,i,r){var a=i.extent,s=i.viewState,o=s.center,h=s.resolution,l=s.projection,u=s.rotation,f=l.getExtent(),c=this.getLayer().getSource(),d=i.pixelRatio,v=i.viewHints,p=!(v[ct.ANIMATING]||v[ct.INTERACTING]),_=this.context,y=Math.round(i.size[0]*d),g=Math.round(i.size[1]*d),m=c.getWrapX()&&l.canWrapX(),M=m?xt(f):null,E=m?Math.ceil((a[2]-f[2])/M)+1:1,C=m?Math.floor((a[0]-f[0])/M):0;do{var S=this.getRenderTransform(o,h,u,d,y,g,C*M);t.execute(_,1,S,u,p,void 0,r)}while(++C<E)},e.prototype.renderDeclutter=function(t){this.declutterExecutorGroup&&this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree)},e.prototype.renderFrame=function(t,i){var r=t.pixelRatio,a=t.layerStatesArray[t.layerIndex];Kh(this.pixelTransform,1/r,1/r),Na(this.inversePixelTransform,this.pixelTransform);var s=Hh(this.pixelTransform);this.useContainer(i,s,a.opacity);var o=this.context,h=o.canvas,l=this.replayGroup_,u=this.declutterExecutorGroup;if((!l||l.isEmpty())&&(!u||u.isEmpty()))return null;var f=Math.round(t.size[0]*r),c=Math.round(t.size[1]*r);h.width!=f||h.height!=c?(h.width=f,h.height=c,h.style.transform!==s&&(h.style.transform=s)):this.containerReused||o.clearRect(0,0,f,c),this.preRender(o,t);var d=t.viewState;d.projection;var v=!1,p=!0;if(a.extent&&this.clipping){var _=mi(a.extent);p=It(_,t.extent),v=p&&!be(_,t.extent),v&&this.clipUnrotated(o,t,_)}p&&this.renderWorlds(l,t),v&&o.restore(),this.postRender(o,t);var y=ks(a.opacity),g=this.container;return y!==g.style.opacity&&(g.style.opacity=y),this.renderedRotation_!==d.rotation&&(this.renderedRotation_=d.rotation,this.hitDetectionImageData_=null),this.container},e.prototype.getFeatures=function(t){return new Promise(function(i){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){var r=[this.context.canvas.width,this.context.canvas.height];ot(this.pixelTransform,r);var a=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,h=this.renderedProjection_,l=this.wrappedRenderedExtent_,u=this.getLayer(),f=[],c=r[0]*Nt,d=r[1]*Nt;f.push(this.getRenderTransform(a,s,o,Nt,c,d,0).slice());var v=u.getSource(),p=h.getExtent();if(v.getWrapX()&&h.canWrapX()&&!be(p,l)){for(var _=l[0],y=xt(p),g=0,m=void 0;_<p[0];)--g,m=y*g,f.push(this.getRenderTransform(a,s,o,Nt,c,d,m).slice()),_+=y;for(g=0,_=l[2];_>p[2];)++g,m=y*g,f.push(this.getRenderTransform(a,s,o,Nt,c,d,m).slice()),_-=y}this.hitDetectionImageData_=xc(r,f,this.renderedFeatures_,u.getStyleFunction(),l,s,o)}i(Cc(t,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))},e.prototype.forEachFeatureAtCoordinate=function(t,i,r,a,s){var o=this;if(!!this.replayGroup_){var h=i.viewState.resolution,l=i.viewState.rotation,u=this.getLayer(),f={},c=function(p,_,y){var g=it(p),m=f[g];if(m){if(m!==!0&&y<m.distanceSq){if(y===0)return f[g]=!0,s.splice(s.lastIndexOf(m),1),a(p,u,_);m.geometry=_,m.distanceSq=y}}else{if(y===0)return f[g]=!0,a(p,u,_);s.push(f[g]={feature:p,layer:u,geometry:_,distanceSq:y,callback:a})}},d,v=[this.replayGroup_];return this.declutterExecutorGroup&&v.push(this.declutterExecutorGroup),v.some(function(p){return d=p.forEachFeatureAtCoordinate(t,h,l,r,c,p===o.declutterExecutorGroup?i.declutterTree.all().map(function(_){return _.value}):null)}),d}},e.prototype.handleFontsChanged=function(){var t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.prepareFrame=function(t){var i=this.getLayer(),r=i.getSource();if(!r)return!1;var a=t.viewHints[ct.ANIMATING],s=t.viewHints[ct.INTERACTING],o=i.getUpdateWhileAnimating(),h=i.getUpdateWhileInteracting();if(!this.dirty_&&!o&&a||!h&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var l=t.extent,u=t.viewState,f=u.projection,c=u.resolution,d=t.pixelRatio,v=i.getRevision(),p=i.getRenderBuffer(),_=i.getRenderOrder();_===void 0&&(_=Oc);var y=u.center.slice(),g=ar(l,p*c),m=g.slice(),M=[g.slice()],E=f.getExtent();if(r.getWrapX()&&f.canWrapX()&&!be(E,t.extent)){var C=xt(E),S=Math.max(xt(g)/2,C);g[0]=E[0]-S,g[2]=E[2]+S,qa(y,f);var O=al(M[0],f);O[0]<E[0]&&O[2]<E[2]?M.push([O[0]+C,O[1],O[2]+C,O[3]]):O[0]>E[0]&&O[2]>E[2]&&M.push([O[0]-C,O[1],O[2]-C,O[3]])}if(!this.dirty_&&this.renderedResolution_==c&&this.renderedRevision_==v&&this.renderedRenderOrder_==_&&be(this.wrappedRenderedExtent_,g))return Ae(this.renderedExtent_,m)||(this.hitDetectionImageData_=null,this.renderedExtent_=m),this.renderedCenter_=y,this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;var P=new Qs(Br(c,d),g,c,d),F;this.getLayer().getDeclutter()&&(F=new Qs(Br(c,d),g,c,d));for(var N,G,k,G=0,k=M.length;G<k;++G)r.loadFeatures(M[G],c,f);var H=Rc(c,d),Y=function(et){var ut,I=et.getStyleFunction()||i.getStyleFunction();if(I&&(ut=I(et,c)),ut){var Bt=this.renderFeature(et,H,ut,P,N,F);this.dirty_=this.dirty_||Bt}}.bind(this),V=es(g),U=r.getFeaturesInExtent(V);_&&U.sort(_);for(var G=0,k=U.length;G<k;++G)Y(U[G]);this.renderedFeatures_=U;var tt=P.finish(),K=new no(g,c,d,r.getOverlaps(),tt,i.getRenderBuffer());return F&&(this.declutterExecutorGroup=new no(g,c,d,r.getOverlaps(),F.finish(),i.getRenderBuffer())),this.renderedResolution_=c,this.renderedRevision_=v,this.renderedRenderOrder_=_,this.renderedExtent_=m,this.wrappedRenderedExtent_=g,this.renderedCenter_=y,this.renderedProjection_=f,this.replayGroup_=K,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0},e.prototype.renderFeature=function(t,i,r,a,s,o){if(!r)return!1;var h=!1;if(Array.isArray(r))for(var l=0,u=r.length;l<u;++l)h=oo(a,t,r[l],i,this.boundHandleStyleImageChange_,s,o)||h;else h=oo(a,t,r,i,this.boundHandleStyleImageChange_,s,o);return h},e}(ec),kc=bc,Bc=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),jc=function(n){Bc(e,n);function e(t){return n.call(this,t)||this}return e.prototype.createRenderer=function(){return new kc(this)},e}(Pf),my=jc,$c=function(){function n(e){this.rbush_=new Vs(e),this.items_={}}return n.prototype.insert=function(e,t){var i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[it(t)]=i},n.prototype.load=function(e,t){for(var i=new Array(t.length),r=0,a=t.length;r<a;r++){var s=e[r],o=t[r],h={minX:s[0],minY:s[1],maxX:s[2],maxY:s[3],value:o};i[r]=h,this.items_[it(o)]=h}this.rbush_.load(i)},n.prototype.remove=function(e){var t=it(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null},n.prototype.update=function(e,t){var i=this.items_[it(t)],r=[i.minX,i.minY,i.maxX,i.maxY];on(r,e)||(this.remove(t),this.insert(e,t))},n.prototype.getAll=function(){var e=this.rbush_.all();return e.map(function(t){return t.value})},n.prototype.getInExtent=function(e){var t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]},i=this.rbush_.search(t);return i.map(function(r){return r.value})},n.prototype.forEach=function(e){return this.forEach_(this.getAll(),e)},n.prototype.forEachInExtent=function(e,t){return this.forEach_(this.getInExtent(e),t)},n.prototype.forEach_=function(e,t){for(var i,r=0,a=e.length;r<a;r++)if(i=t(e[r]),i)return i;return i},n.prototype.isEmpty=function(){return Ne(this.items_)},n.prototype.clear=function(){this.rbush_.clear(),this.items_={}},n.prototype.getExtent=function(e){var t=this.rbush_.toJSON();return ke(t.minX,t.minY,t.maxX,t.maxY,e)},n.prototype.concat=function(e){this.rbush_.load(e.rbush_.all());for(var t in e.items_)this.items_[t]=e.items_[t]},n}(),lo=$c,Uc=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),zc=function(n){Uc(e,n);function e(t){var i=n.call(this)||this;i.projection=st(t.projection),i.attributions_=uo(t.attributions),i.attributionsCollapsible_=t.attributionsCollapsible!==void 0?t.attributionsCollapsible:!0,i.loading=!1,i.state_=t.state!==void 0?t.state:Oe.READY,i.wrapX_=t.wrapX!==void 0?t.wrapX:!1,i.viewResolver=null,i.viewRejector=null;var r=i;return i.viewPromise_=new Promise(function(a,s){r.viewResolver=a,r.viewRejector=s}),i}return e.prototype.getAttributions=function(){return this.attributions_},e.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},e.prototype.getProjection=function(){return this.projection},e.prototype.getResolutions=function(){return A()},e.prototype.getView=function(){return this.viewPromise_},e.prototype.getState=function(){return this.state_},e.prototype.getWrapX=function(){return this.wrapX_},e.prototype.getContextOptions=function(){},e.prototype.refresh=function(){this.changed()},e.prototype.setAttributions=function(t){this.attributions_=uo(t),this.changed()},e.prototype.setState=function(t){this.state_=t,this.changed()},e}(Pt);function uo(n){return n?Array.isArray(n)?function(e){return n}:typeof n=="function"?n:function(e){return[n]}:null}var Xc=zc,Dt={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};function Wc(n,e){return[[-1/0,-1/0,1/0,1/0]]}var Yc=!1;function Vc(n,e,t,i,r,a,s){var o=new XMLHttpRequest;o.open("GET",typeof n=="function"?n(t,i,r):n,!0),e.getType()==Xe.ARRAY_BUFFER&&(o.responseType="arraybuffer"),o.withCredentials=Yc,o.onload=function(h){if(!o.status||o.status>=200&&o.status<300){var l=e.getType(),u=void 0;l==Xe.JSON||l==Xe.TEXT?u=o.responseText:l==Xe.XML?(u=o.responseXML,u||(u=new DOMParser().parseFromString(o.responseText,"application/xml"))):l==Xe.ARRAY_BUFFER&&(u=o.response),u?a(e.readFeatures(u,{extent:t,featureProjection:r}),e.readProjection(u)):s()}else s()},o.onerror=s,o.send()}function fo(n,e){return function(t,i,r,a,s){var o=this;Vc(n,e,t,i,r,function(h,l){o.addFeatures(h),a!==void 0&&a(h)},s||ce)}}var co=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ae=function(n){co(e,n);function e(t,i,r){var a=n.call(this,t)||this;return a.feature=i,a.features=r,a}return e}(ue),Kc=function(n){co(e,n);function e(t){var i=this,r=t||{};i=n.call(this,{attributions:r.attributions,projection:void 0,state:Oe.READY,wrapX:r.wrapX!==void 0?r.wrapX:!0})||this,i.on,i.once,i.un,i.loader_=ce,i.format_=r.format,i.overlaps_=r.overlaps===void 0?!0:r.overlaps,i.url_=r.url,r.loader!==void 0?i.loader_=r.loader:i.url_!==void 0&&(X(i.format_,7),i.loader_=fo(i.url_,i.format_)),i.strategy_=r.strategy!==void 0?r.strategy:Wc;var a=r.useSpatialIndex!==void 0?r.useSpatialIndex:!0;i.featuresRtree_=a?new lo:null,i.loadedExtentsRtree_=new lo,i.loadingExtentsCount_=0,i.nullGeometryFeatures_={},i.idIndex_={},i.uidIndex_={},i.featureChangeKeys_={},i.featuresCollection_=null;var s,o;return Array.isArray(r.features)?o=r.features:r.features&&(s=r.features,o=s.getArray()),!a&&s===void 0&&(s=new Ot(o)),o!==void 0&&i.addFeaturesInternal(o),s!==void 0&&i.bindFeaturesCollection_(s),i}return e.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},e.prototype.addFeatureInternal=function(t){var i=it(t);if(!this.addToIndex_(i,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(i,t);var r=t.getGeometry();if(r){var a=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(a,t)}else this.nullGeometryFeatures_[i]=t;this.dispatchEvent(new ae(Dt.ADDFEATURE,t))},e.prototype.setupChangeEvents_=function(t,i){this.featureChangeKeys_[t]=[B(i,b.CHANGE,this.handleFeatureChange_,this),B(i,fe.PROPERTYCHANGE,this.handleFeatureChange_,this)]},e.prototype.addToIndex_=function(t,i){var r=!0,a=i.getId();return a!==void 0&&(a.toString()in this.idIndex_?r=!1:this.idIndex_[a.toString()]=i),r&&(X(!(t in this.uidIndex_),30),this.uidIndex_[t]=i),r},e.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},e.prototype.addFeaturesInternal=function(t){for(var i=[],r=[],a=[],s=0,o=t.length;s<o;s++){var h=t[s],l=it(h);this.addToIndex_(l,h)&&r.push(h)}for(var s=0,u=r.length;s<u;s++){var h=r[s],l=it(h);this.setupChangeEvents_(l,h);var f=h.getGeometry();if(f){var c=f.getExtent();i.push(c),a.push(h)}else this.nullGeometryFeatures_[l]=h}this.featuresRtree_&&this.featuresRtree_.load(i,a);for(var s=0,d=r.length;s<d;s++)this.dispatchEvent(new ae(Dt.ADDFEATURE,r[s]))},e.prototype.bindFeaturesCollection_=function(t){var i=!1;this.addEventListener(Dt.ADDFEATURE,function(r){i||(i=!0,t.push(r.feature),i=!1)}),this.addEventListener(Dt.REMOVEFEATURE,function(r){i||(i=!0,t.remove(r.feature),i=!1)}),t.addEventListener(mt.ADD,function(r){i||(i=!0,this.addFeature(r.element),i=!1)}.bind(this)),t.addEventListener(mt.REMOVE,function(r){i||(i=!0,this.removeFeature(r.element),i=!1)}.bind(this)),this.featuresCollection_=t},e.prototype.clear=function(t){if(t){for(var i in this.featureChangeKeys_){var r=this.featureChangeKeys_[i];r.forEach(Z)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(this.removeFeatureInternal.bind(this));for(var a in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[a])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var s=new ae(Dt.CLEAR);this.dispatchEvent(s),this.changed()},e.prototype.forEachFeature=function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},e.prototype.forEachFeatureAtCoordinateDirect=function(t,i){var r=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(r,function(a){var s=a.getGeometry();if(s.intersectsCoordinate(t))return i(a)})},e.prototype.forEachFeatureInExtent=function(t,i){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,i);this.featuresCollection_&&this.featuresCollection_.forEach(i)},e.prototype.forEachFeatureIntersectingExtent=function(t,i){return this.forEachFeatureInExtent(t,function(r){var a=r.getGeometry();if(a.intersectsExtent(t)){var s=i(r);if(s)return s}})},e.prototype.getFeaturesCollection=function(){return this.featuresCollection_},e.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),Ne(this.nullGeometryFeatures_)||Ut(t,Ra(this.nullGeometryFeatures_))),t},e.prototype.getFeaturesAtCoordinate=function(t){var i=[];return this.forEachFeatureAtCoordinateDirect(t,function(r){i.push(r)}),i},e.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_?this.featuresRtree_.getInExtent(t):this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]},e.prototype.getClosestFeatureToCoordinate=function(t,i){var r=t[0],a=t[1],s=null,o=[NaN,NaN],h=1/0,l=[-1/0,-1/0,1/0,1/0],u=i||Le;return this.featuresRtree_.forEachInExtent(l,function(f){if(u(f)){var c=f.getGeometry(),d=h;if(h=c.closestPointXY(r,a,o,h),h<d){s=f;var v=Math.sqrt(h);l[0]=r-v,l[1]=a-v,l[2]=r+v,l[3]=a+v}}}),s},e.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},e.prototype.getFeatureById=function(t){var i=this.idIndex_[t.toString()];return i!==void 0?i:null},e.prototype.getFeatureByUid=function(t){var i=this.uidIndex_[t];return i!==void 0?i:null},e.prototype.getFormat=function(){return this.format_},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.getUrl=function(){return this.url_},e.prototype.handleFeatureChange_=function(t){var i=t.target,r=it(i),a=i.getGeometry();if(!a)r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(i),this.nullGeometryFeatures_[r]=i);else{var s=a.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(s,i)):this.featuresRtree_&&this.featuresRtree_.update(s,i)}var o=i.getId();if(o!==void 0){var h=o.toString();this.idIndex_[h]!==i&&(this.removeFromIdIndex_(i),this.idIndex_[h]=i)}else this.removeFromIdIndex_(i),this.uidIndex_[r]=i;this.changed(),this.dispatchEvent(new ae(Dt.CHANGEFEATURE,i))},e.prototype.hasFeature=function(t){var i=t.getId();return i!==void 0?i in this.idIndex_:it(t)in this.uidIndex_},e.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&Ne(this.nullGeometryFeatures_)},e.prototype.loadFeatures=function(t,i,r){for(var a=this.loadedExtentsRtree_,s=this.strategy_(t,i,r),o=function(f,c){var d=s[f],v=a.forEachInExtent(d,function(p){return be(p.extent,d)});v||(++h.loadingExtentsCount_,h.dispatchEvent(new ae(Dt.FEATURESLOADSTART)),h.loader_.call(h,d,i,r,function(p){--this.loadingExtentsCount_,this.dispatchEvent(new ae(Dt.FEATURESLOADEND,void 0,p))}.bind(h),function(){--this.loadingExtentsCount_,this.dispatchEvent(new ae(Dt.FEATURESLOADERROR))}.bind(h)),a.insert(d,{extent:d.slice()}))},h=this,l=0,u=s.length;l<u;++l)o(l);this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0},e.prototype.refresh=function(){this.clear(!0),this.loadedExtentsRtree_.clear(),n.prototype.refresh.call(this)},e.prototype.removeLoadedExtent=function(t){var i=this.loadedExtentsRtree_,r;i.forEachInExtent(t,function(a){if(on(a.extent,t))return r=a,!0}),r&&i.remove(r)},e.prototype.removeFeature=function(t){var i=it(t);i in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[i]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()},e.prototype.removeFeatureInternal=function(t){var i=it(t);this.featureChangeKeys_[i].forEach(Z),delete this.featureChangeKeys_[i];var r=t.getId();r!==void 0&&delete this.idIndex_[r.toString()],delete this.uidIndex_[i],this.dispatchEvent(new ae(Dt.REMOVEFEATURE,t))},e.prototype.removeFromIdIndex_=function(t){var i=!1;for(var r in this.idIndex_)if(this.idIndex_[r]===t){delete this.idIndex_[r],i=!0;break}return i},e.prototype.setLoader=function(t){this.loader_=t},e.prototype.setUrl=function(t){X(this.format_,7),this.url_=t,this.setLoader(fo(t,this.format_))},e}(Xc),My=Kc,wn={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function qc(n){return Math.pow(n,3)}function He(n){return 1-qc(1-n)}function Hc(n){return 3*n*n-2*n*n*n}function Zc(n){return n}var Jc=function(){function n(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}return n.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},n.prototype.update=function(e,t){this.points_.push(e,t,Date.now())},n.prototype.end=function(){if(this.points_.length<6)return!1;var e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;for(var i=t-3;i>0&&this.points_[i+2]>e;)i-=3;var r=this.points_[t+2]-this.points_[i+2];if(r<1e3/60)return!1;var a=this.points_[t]-this.points_[i],s=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(s,a),this.initialVelocity_=Math.sqrt(a*a+s*s)/r,this.initialVelocity_>this.minVelocity_},n.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},n.prototype.getAngle=function(){return this.angle_},n}(),Qc=Jc,td=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ed=function(n){td(e,n);function e(t){var i=n.call(this)||this;return i.map_=t,i}return e.prototype.dispatchRenderEvent=function(t,i){A()},e.prototype.calculateMatrices2D=function(t){var i=t.viewState,r=t.coordinateToPixelTransform,a=t.pixelToCoordinateTransform;ve(r,t.size[0]/2,t.size[1]/2,1/i.resolution,-1/i.resolution,-i.rotation,-i.center[0],-i.center[1]),Na(a,r)},e.prototype.forEachFeatureAtCoordinate=function(t,i,r,a,s,o,h,l){var u,f=i.viewState;function c(Y,V,U,tt){return s.call(o,V,Y?U:null,tt)}var d=f.projection,v=qa(t.slice(),d),p=[[0,0]];if(d.canWrapX()&&a){var _=d.getExtent(),y=xt(_);p.push([-y,0],[y,0])}for(var g=i.layerStatesArray,m=g.length,M=[],E=[],C=0;C<p.length;C++)for(var S=m-1;S>=0;--S){var O=g[S],P=O.layer;if(P.hasRenderer()&&En(O,f)&&h.call(l,P)){var F=P.getRenderer(),N=P.getSource();if(F&&N){var G=N.getWrapX()?v:t,k=c.bind(null,O.managed);E[0]=G[0]+p[C][0],E[1]=G[1]+p[C][1],u=F.forEachFeatureAtCoordinate(E,i,r,k,M)}if(u)return u}}if(M.length!==0){var H=1/M.length;return M.forEach(function(Y,V){return Y.distanceSq+=V*H}),M.sort(function(Y,V){return Y.distanceSq-V.distanceSq}),M.some(function(Y){return u=Y.callback(Y.feature,Y.layer,Y.geometry)}),u}},e.prototype.forEachLayerAtPixel=function(t,i,r,a,s){return A()},e.prototype.hasFeatureAtCoordinate=function(t,i,r,a,s,o){var h=this.forEachFeatureAtCoordinate(t,i,r,a,Le,this,s,o);return h!==void 0},e.prototype.getMap=function(){return this.map_},e.prototype.renderFrame=function(t){A()},e.prototype.scheduleExpireIconCache=function(t){Rn.canExpireCache()&&t.postRenderFunctions.push(id)},e}(rr);function id(n,e){Rn.expire()}var nd=ed,rd=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ad=function(n){rd(e,n);function e(t){var i=n.call(this,t)||this;i.fontChangeListenerKey_=B(Vt,fe.PROPERTYCHANGE,t.redrawText.bind(t)),i.element_=document.createElement("div");var r=i.element_.style;r.position="absolute",r.width="100%",r.height="100%",r.zIndex="0",i.element_.className=gn+" ol-layers";var a=t.getViewport();return a.insertBefore(i.element_,a.firstChild||null),i.children_=[],i.renderedVisible_=!0,i}return e.prototype.dispatchRenderEvent=function(t,i){var r=this.getMap();if(r.hasListener(t)){var a=new to(t,void 0,i);r.dispatchEvent(a)}},e.prototype.disposeInternal=function(){Z(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),n.prototype.disposeInternal.call(this)},e.prototype.renderFrame=function(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(Ce.PRECOMPOSE,t);var i=t.layerStatesArray.sort(function(c,d){return c.zIndex-d.zIndex}),r=t.viewState;this.children_.length=0;for(var a=[],s=null,o=0,h=i.length;o<h;++o){var l=i[o];if(t.layerIndex=o,!(!En(l,r)||l.sourceState!=Oe.READY&&l.sourceState!=Oe.UNDEFINED)){var u=l.layer,f=u.render(t,s);!f||(f!==s&&(this.children_.push(f),s=f),"getDeclutter"in u&&a.push(u))}}for(var o=a.length-1;o>=0;--o)a[o].renderDeclutter(t);Zu(this.element_,this.children_),this.dispatchRenderEvent(Ce.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)},e.prototype.forEachLayerAtPixel=function(t,i,r,a,s){for(var o=i.viewState,h=i.layerStatesArray,l=h.length,u=l-1;u>=0;--u){var f=h[u],c=f.layer;if(c.hasRenderer()&&En(f,o)&&s(c)){var d=c.getRenderer(),v=d.getDataAtPixel(t,i,r);if(v){var p=a(c,v);if(p)return p}}}},e}(nd),sd=ad,od=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),jr={LAYERS:"layers"},hd=function(n){od(e,n);function e(t){var i=this,r=t||{},a=pt({},r);delete a.layers;var s=r.layers;return i=n.call(this,a)||this,i.on,i.once,i.un,i.layersListenerKeys_=[],i.listenerKeys_={},i.addChangeListener(jr.LAYERS,i.handleLayersChanged_),s?Array.isArray(s)?s=new Ot(s.slice(),{unique:!0}):X(typeof s.getArray=="function",43):s=new Ot(void 0,{unique:!0}),i.setLayers(s),i}return e.prototype.handleLayerChange_=function(){this.changed()},e.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(Z),this.layersListenerKeys_.length=0;var t=this.getLayers();this.layersListenerKeys_.push(B(t,mt.ADD,this.handleLayersAdd_,this),B(t,mt.REMOVE,this.handleLayersRemove_,this));for(var i in this.listenerKeys_)this.listenerKeys_[i].forEach(Z);pi(this.listenerKeys_);for(var r=t.getArray(),a=0,s=r.length;a<s;a++){var o=r[a];this.listenerKeys_[it(o)]=[B(o,fe.PROPERTYCHANGE,this.handleLayerChange_,this),B(o,b.CHANGE,this.handleLayerChange_,this)]}this.changed()},e.prototype.handleLayersAdd_=function(t){var i=t.element;this.listenerKeys_[it(i)]=[B(i,fe.PROPERTYCHANGE,this.handleLayerChange_,this),B(i,b.CHANGE,this.handleLayerChange_,this)],this.changed()},e.prototype.handleLayersRemove_=function(t){var i=t.element,r=it(i);this.listenerKeys_[r].forEach(Z),delete this.listenerKeys_[r],this.changed()},e.prototype.getLayers=function(){return this.get(jr.LAYERS)},e.prototype.setLayers=function(t){this.set(jr.LAYERS,t)},e.prototype.getLayersArray=function(t){var i=t!==void 0?t:[];return this.getLayers().forEach(function(r){r.getLayersArray(i)}),i},e.prototype.getLayerStatesArray=function(t){var i=t!==void 0?t:[],r=i.length;this.getLayers().forEach(function(u){u.getLayerStatesArray(i)});var a=this.getLayerState(),s=a.zIndex;!t&&a.zIndex===void 0&&(s=0);for(var o=r,h=i.length;o<h;o++){var l=i[o];l.opacity*=a.opacity,l.visible=l.visible&&a.visible,l.maxResolution=Math.min(l.maxResolution,a.maxResolution),l.minResolution=Math.max(l.minResolution,a.minResolution),l.minZoom=Math.max(l.minZoom,a.minZoom),l.maxZoom=Math.min(l.maxZoom,a.maxZoom),a.extent!==void 0&&(l.extent!==void 0?l.extent=il(l.extent,a.extent):l.extent=a.extent),l.zIndex===void 0&&(l.zIndex=s)}return i},e.prototype.getSourceState=function(){return Oe.READY},e}(Ws),ld=hd,ud=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),fd=function(n){ud(e,n);function e(t,i,r){var a=n.call(this,t)||this;return a.map=i,a.frameState=r!==void 0?r:null,a}return e}(ue),Sn=fd,cd=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),dd=function(n){cd(e,n);function e(t,i,r,a,s){var o=n.call(this,t,i,s)||this;return o.originalEvent=r,o.pixel_=null,o.coordinate_=null,o.dragging=a!==void 0?a:!1,o}return Object.defineProperty(e.prototype,"pixel",{get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"coordinate",{get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t},enumerable:!1,configurable:!0}),e.prototype.preventDefault=function(){n.prototype.preventDefault.call(this),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){n.prototype.stopPropagation.call(this),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()},e}(Sn),se=dd,q={SINGLECLICK:"singleclick",CLICK:b.CLICK,DBLCLICK:b.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},$r={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},vd=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),pd=function(n){vd(e,n);function e(t,i){var r=n.call(this,t)||this;r.map_=t,r.clickTimeoutId_,r.emulateClicks_=!1,r.dragging_=!1,r.dragListenerKeys_=[],r.moveTolerance_=i===void 0?1:i,r.down_=null;var a=r.map_.getViewport();return r.activePointers_=0,r.trackedTouches_={},r.element_=a,r.pointerdownListenerKey_=B(a,$r.POINTERDOWN,r.handlePointerDown_,r),r.originalPointerMoveEvent_,r.relayedListenerKey_=B(a,$r.POINTERMOVE,r.relayEvent_,r),r.boundHandleTouchMove_=r.handleTouchMove_.bind(r),r.element_.addEventListener(b.TOUCHMOVE,r.boundHandleTouchMove_,La?{passive:!1}:!1),r}return e.prototype.emulateClick_=function(t){var i=new se(q.CLICK,this.map_,t);this.dispatchEvent(i),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,i=new se(q.DBLCLICK,this.map_,t),this.dispatchEvent(i)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var r=new se(q.SINGLECLICK,this.map_,t);this.dispatchEvent(r)}.bind(this),250)},e.prototype.updateActivePointers_=function(t){var i=t;i.type==q.POINTERUP||i.type==q.POINTERCANCEL?delete this.trackedTouches_[i.pointerId]:i.type==q.POINTERDOWN&&(this.trackedTouches_[i.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},e.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var i=new se(q.POINTERUP,this.map_,t);this.dispatchEvent(i),this.emulateClicks_&&!i.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_===0&&(this.dragListenerKeys_.forEach(Z),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)},e.prototype.isMouseActionButton_=function(t){return t.button===0},e.prototype.handlePointerDown_=function(t){this.emulateClicks_=this.activePointers_===0,this.updateActivePointers_(t);var i=new se(q.POINTERDOWN,this.map_,t);this.dispatchEvent(i),this.down_={};for(var r in t){var a=t[r];this.down_[r]=typeof a=="function"?ce:a}if(this.dragListenerKeys_.length===0){var s=this.map_.getOwnerDocument();this.dragListenerKeys_.push(B(s,q.POINTERMOVE,this.handlePointerMove_,this),B(s,q.POINTERUP,this.handlePointerUp_,this),B(this.element_,q.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==s&&this.dragListenerKeys_.push(B(this.element_.getRootNode(),q.POINTERUP,this.handlePointerUp_,this))}},e.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=!0;var i=new se(q.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(i)}},e.prototype.relayEvent_=function(t){this.originalPointerMoveEvent_=t;var i=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new se(t.type,this.map_,t,i))},e.prototype.handleTouchMove_=function(t){var i=this.originalPointerMoveEvent_;(!i||i.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()},e.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},e.prototype.disposeInternal=function(){this.relayedListenerKey_&&(Z(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(b.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Z(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Z),this.dragListenerKeys_.length=0,this.element_=null,n.prototype.disposeInternal.call(this)},e}(_i),_d=pd,Tn={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend"},dt={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},Pn=1/0,gd=function(){function n(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}return n.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,pi(this.queuedElements_)},n.prototype.dequeue=function(){var e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));var r=this.keyFunction_(i);return delete this.queuedElements_[r],i},n.prototype.enqueue=function(e){X(!(this.keyFunction_(e)in this.queuedElements_),31);var t=this.priorityFunction_(e);return t!=Pn?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1},n.prototype.getCount=function(){return this.elements_.length},n.prototype.getLeftChildIndex_=function(e){return e*2+1},n.prototype.getRightChildIndex_=function(e){return e*2+2},n.prototype.getParentIndex_=function(e){return e-1>>1},n.prototype.heapify_=function(){var e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)},n.prototype.isEmpty=function(){return this.elements_.length===0},n.prototype.isKeyQueued=function(e){return e in this.queuedElements_},n.prototype.isQueued=function(e){return this.isKeyQueued(this.keyFunction_(e))},n.prototype.siftUp_=function(e){for(var t=this.elements_,i=this.priorities_,r=t.length,a=t[e],s=i[e],o=e;e<r>>1;){var h=this.getLeftChildIndex_(e),l=this.getRightChildIndex_(e),u=l<r&&i[l]<i[h]?l:h;t[e]=t[u],i[e]=i[u],e=u}t[e]=a,i[e]=s,this.siftDown_(o,e)},n.prototype.siftDown_=function(e,t){for(var i=this.elements_,r=this.priorities_,a=i[t],s=r[t];t>e;){var o=this.getParentIndex_(t);if(r[o]>s)i[t]=i[o],r[t]=r[o],t=o;else break}i[t]=a,r[t]=s},n.prototype.reprioritize=function(){var e=this.priorityFunction_,t=this.elements_,i=this.priorities_,r=0,a=t.length,s,o,h;for(o=0;o<a;++o)s=t[o],h=e(s),h==Pn?delete this.queuedElements_[this.keyFunction_(s)]:(i[r]=h,t[r++]=s);t.length=r,i.length=r,this.heapify_()},n}(),yd=gd,md=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Md=function(n){md(e,n);function e(t,i){var r=n.call(this,function(a){return t.apply(null,a)},function(a){return a[0].getKey()})||this;return r.boundHandleTileChange_=r.handleTileChange.bind(r),r.tileChangeCallback_=i,r.tilesLoading_=0,r.tilesLoadingKeys_={},r}return e.prototype.enqueue=function(t){var i=n.prototype.enqueue.call(this,t);if(i){var r=t[0];r.addEventListener(b.CHANGE,this.boundHandleTileChange_)}return i},e.prototype.getTilesLoading=function(){return this.tilesLoading_},e.prototype.handleTileChange=function(t){var i=t.target,r=i.getState();if(r===wn.LOADED||r===wn.ERROR||r===wn.EMPTY){i.removeEventListener(b.CHANGE,this.boundHandleTileChange_);var a=i.getKey();a in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[a],--this.tilesLoading_),this.tileChangeCallback_()}},e.prototype.loadMoreTiles=function(t,i){for(var r=0,a,s,o;this.tilesLoading_<t&&r<i&&this.getCount()>0;)s=this.dequeue()[0],o=s.getKey(),a=s.getState(),a===wn.IDLE&&!(o in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[o]=!0,++this.tilesLoading_,++r,s.load())},e}(yd),Ed=Md;function xd(n,e,t,i,r){if(!n||!(t in n.wantedTiles)||!n.wantedTiles[t][e.getKey()])return Pn;var a=n.viewState.center,s=i[0]-a[0],o=i[1]-a[1];return 65536*Math.log(r)+Math.sqrt(s*s+o*o)/r}var Ft={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},Cd=256;function vo(n,e,t){return function(i,r,a,s,o){if(i){var h=e?0:a[0]*r,l=e?0:a[1]*r,u=o?o[0]:0,f=o?o[1]:0,c=n[0]+h/2+u,d=n[2]-h/2+u,v=n[1]+l/2+f,p=n[3]-l/2+f;c>d&&(c=(d+c)/2,d=c),v>p&&(v=(p+v)/2,p=v);var _=at(i[0],c,d),y=at(i[1],v,p),g=30*r;return s&&t&&(_+=-g*Math.log(1+Math.max(0,c-i[0])/g)+g*Math.log(1+Math.max(0,i[0]-d)/g),y+=-g*Math.log(1+Math.max(0,v-i[1])/g)+g*Math.log(1+Math.max(0,i[1]-p)/g)),[_,y]}else return}}function Id(n){return n}function Ur(n,e,t,i){var r=xt(e)/t[0],a=_e(e)/t[1];return i?Math.min(n,Math.max(r,a)):Math.min(n,Math.min(r,a))}function zr(n,e,t){var i=Math.min(n,e),r=50;return i*=Math.log(1+r*Math.max(0,n/e-1))/r+1,t&&(i=Math.max(i,t),i/=Math.log(1+r*Math.max(0,t/n-1))/r+1),at(i,t/2,e*2)}function Od(n,e,t,i){return function(r,a,s,o){if(r!==void 0){var h=n[0],l=n[n.length-1],u=t?Ur(h,t,s,i):h;if(o){var f=e!==void 0?e:!0;return f?zr(r,u,l):at(r,l,u)}var c=Math.min(u,r),d=Math.floor(Oa(n,c,a));return n[d]>u&&d<n.length-1?n[d+1]:n[d]}else return}}function Rd(n,e,t,i,r,a){return function(s,o,h,l){if(s!==void 0){var u=r?Ur(e,r,h,a):e,f=t!==void 0?t:0;if(l){var c=i!==void 0?i:!0;return c?zr(s,u,f):at(s,f,u)}var d=1e-9,v=Math.ceil(Math.log(e/u)/Math.log(n)-d),p=-o*(.5-d)+.5,_=Math.min(u,s),y=Math.floor(Math.log(e/_)/Math.log(n)+p),g=Math.max(v,y),m=e/Math.pow(n,g);return at(m,f,u)}else return}}function po(n,e,t,i,r){return function(a,s,o,h){if(a!==void 0){var l=i?Ur(n,i,o,r):n,u=t!==void 0?t:!0;return!u||!h?at(a,e,l):zr(a,l,e)}else return}}function Xr(n){if(n!==void 0)return 0}function _o(n){if(n!==void 0)return n}function wd(n){var e=2*Math.PI/n;return function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t}}function Sd(n){var e=n||ll(5);return function(t,i){if(i)return t;if(t!==void 0)return Math.abs(t)<=e?0:t}}var Td=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Wr=0,Pd=function(n){Td(e,n);function e(t){var i=n.call(this)||this;i.on,i.once,i.un;var r=pt({},t);return i.hints_=[0,0],i.animations_=[],i.updateAnimationKey_,i.projection_=pr(r.projection,"EPSG:3857"),i.viewportSize_=[100,100],i.targetCenter_=null,i.targetResolution_,i.targetRotation_,i.nextCenter_=null,i.nextResolution_,i.nextRotation_,i.cancelAnchor_=void 0,r.center&&(r.center=Xt(r.center,i.projection_)),r.extent&&(r.extent=mi(r.extent,i.projection_)),i.applyOptions_(r),i}return e.prototype.applyOptions_=function(t){var i={},r=Ld(t);this.maxResolution_=r.maxResolution,this.minResolution_=r.minResolution,this.zoomFactor_=r.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=r.minZoom;var a=Ad(t),s=r.constraint,o=Nd(t);this.constraints_={center:a,resolution:s,rotation:o},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom),this.setProperties(i),this.options_=t},Object.defineProperty(e.prototype,"padding",{get:function(){return this.padding_},set:function(t){var i=this.padding_;this.padding_=t;var r=this.getCenter();if(r){var a=t||[0,0,0,0];i=i||[0,0,0,0];var s=this.getResolution(),o=s/2*(a[3]-i[3]+i[1]-a[1]),h=s/2*(a[0]-i[0]+i[2]-a[2]);this.setCenterInternal([r[0]+o,r[1]-h])}},enumerable:!1,configurable:!0}),e.prototype.getUpdatedOptions_=function(t){var i=pt({},this.options_);return i.resolution!==void 0?i.resolution=this.getResolution():i.zoom=this.getZoom(),i.center=this.getCenterInternal(),i.rotation=this.getRotation(),pt({},i,t)},e.prototype.animate=function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var i=new Array(arguments.length),r=0;r<i.length;++r){var a=arguments[r];a.center&&(a=pt({},a),a.center=Xt(a.center,this.getProjection())),a.anchor&&(a=pt({},a),a.anchor=Xt(a.anchor,this.getProjection())),i[r]=a}this.animateInternal.apply(this,i)},e.prototype.animateInternal=function(t){var i=arguments.length,r;i>1&&typeof arguments[i-1]=="function"&&(r=arguments[i-1],--i);for(var a=0;a<i&&!this.isDef();++a){var s=arguments[a];s.center&&this.setCenterInternal(s.center),s.zoom!==void 0?this.setZoom(s.zoom):s.resolution&&this.setResolution(s.resolution),s.rotation!==void 0&&this.setRotation(s.rotation)}if(a===i){r&&An(r,!0);return}for(var o=Date.now(),h=this.targetCenter_.slice(),l=this.targetResolution_,u=this.targetRotation_,f=[];a<i;++a){var c=arguments[a],d={start:o,complete:!1,anchor:c.anchor,duration:c.duration!==void 0?c.duration:1e3,easing:c.easing||Hc,callback:r};if(c.center&&(d.sourceCenter=h,d.targetCenter=c.center.slice(),h=d.targetCenter),c.zoom!==void 0?(d.sourceResolution=l,d.targetResolution=this.getResolutionForZoom(c.zoom),l=d.targetResolution):c.resolution&&(d.sourceResolution=l,d.targetResolution=c.resolution,l=d.targetResolution),c.rotation!==void 0){d.sourceRotation=u;var v=Xa(c.rotation-u+Math.PI,2*Math.PI)-Math.PI;d.targetRotation=u+v,u=d.targetRotation}Dd(d)?d.complete=!0:o+=d.duration,f.push(d)}this.animations_.push(f),this.setHint(ct.ANIMATING,1),this.updateAnimations_()},e.prototype.getAnimating=function(){return this.hints_[ct.ANIMATING]>0},e.prototype.getInteracting=function(){return this.hints_[ct.INTERACTING]>0},e.prototype.cancelAnimations=function(){this.setHint(ct.ANIMATING,-this.hints_[ct.ANIMATING]);for(var t,i=0,r=this.animations_.length;i<r;++i){var a=this.animations_[i];if(a[0].callback&&An(a[0].callback,!1),!t)for(var s=0,o=a.length;s<o;++s){var h=a[s];if(!h.complete){t=h.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN},e.prototype.updateAnimations_=function(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!!this.getAnimating()){for(var t=Date.now(),i=!1,r=this.animations_.length-1;r>=0;--r){for(var a=this.animations_[r],s=!0,o=0,h=a.length;o<h;++o){var l=a[o];if(!l.complete){var u=t-l.start,f=l.duration>0?u/l.duration:1;f>=1?(l.complete=!0,f=1):s=!1;var c=l.easing(f);if(l.sourceCenter){var d=l.sourceCenter[0],v=l.sourceCenter[1],p=l.targetCenter[0],_=l.targetCenter[1];this.nextCenter_=l.targetCenter;var y=d+c*(p-d),g=v+c*(_-v);this.targetCenter_=[y,g]}if(l.sourceResolution&&l.targetResolution){var m=c===1?l.targetResolution:l.sourceResolution+c*(l.targetResolution-l.sourceResolution);if(l.anchor){var M=this.getViewportSize_(this.getRotation()),E=this.constraints_.resolution(m,0,M,!0);this.targetCenter_=this.calculateCenterZoom(E,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=m,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){var C=c===1?Xa(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+c*(l.targetRotation-l.sourceRotation);if(l.anchor){var S=this.constraints_.rotation(C,!0);this.targetCenter_=this.calculateCenterRotate(S,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=C}if(this.applyTargetState_(!0),i=!0,!l.complete)break}}if(s){this.animations_[r]=null,this.setHint(ct.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;var O=a[0].callback;O&&An(O,!0)}}this.animations_=this.animations_.filter(Boolean),i&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}},e.prototype.calculateCenterRotate=function(t,i){var r,a=this.getCenterInternal();return a!==void 0&&(r=[a[0]-i[0],a[1]-i[1]],cr(r,t-this.getRotation()),Ml(r,i)),r},e.prototype.calculateCenterZoom=function(t,i){var r,a=this.getCenterInternal(),s=this.getResolution();if(a!==void 0&&s!==void 0){var o=i[0]-t*(i[0]-a[0])/s,h=i[1]-t*(i[1]-a[1])/s;r=[o,h]}return r},e.prototype.getViewportSize_=function(t){var i=this.viewportSize_;if(t){var r=i[0],a=i[1];return[Math.abs(r*Math.cos(t))+Math.abs(a*Math.sin(t)),Math.abs(r*Math.sin(t))+Math.abs(a*Math.cos(t))]}else return i},e.prototype.setViewportSize=function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)},e.prototype.getCenter=function(){var t=this.getCenterInternal();return t&&_r(t,this.getProjection())},e.prototype.getCenterInternal=function(){return this.get(Ft.CENTER)},e.prototype.getConstraints=function(){return this.constraints_},e.prototype.getConstrainResolution=function(){return this.options_.constrainResolution},e.prototype.getHints=function(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},e.prototype.calculateExtent=function(t){var i=this.calculateExtentInternal(t);return es(i,this.getProjection())},e.prototype.calculateExtentInternal=function(t){var i=t||this.getViewportSizeMinusPadding_(),r=this.getCenterInternal();X(r,1);var a=this.getResolution();X(a!==void 0,2);var s=this.getRotation();return X(s!==void 0,3),hr(r,a,s,i)},e.prototype.getMaxResolution=function(){return this.maxResolution_},e.prototype.getMinResolution=function(){return this.minResolution_},e.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},e.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},e.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},e.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},e.prototype.setConstrainResolution=function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolution=function(){return this.get(Ft.RESOLUTION)},e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.getResolutionForExtent=function(t,i){return this.getResolutionForExtentInternal(mi(t,this.getProjection()),i)},e.prototype.getResolutionForExtentInternal=function(t,i){var r=i||this.getViewportSizeMinusPadding_(),a=xt(t)/r[0],s=_e(t)/r[1];return Math.max(a,s)},e.prototype.getResolutionForValueFunction=function(t){var i=t||2,r=this.getConstrainedResolution(this.maxResolution_),a=this.minResolution_,s=Math.log(r/a)/Math.log(i);return function(o){var h=r/Math.pow(i,o*s);return h}},e.prototype.getRotation=function(){return this.get(Ft.ROTATION)},e.prototype.getValueForResolutionFunction=function(t){var i=Math.log(t||2),r=this.getConstrainedResolution(this.maxResolution_),a=this.minResolution_,s=Math.log(r/a)/i;return function(o){var h=Math.log(r/o)/i/s;return h}},e.prototype.getViewportSizeMinusPadding_=function(t){var i=this.getViewportSize_(t),r=this.padding_;return r&&(i=[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]),i},e.prototype.getState=function(){var t=this.getProjection(),i=this.getResolution(),r=this.getRotation(),a=this.getCenterInternal(),s=this.padding_;if(s){var o=this.getViewportSizeMinusPadding_();a=Yr(a,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],i,r)}return{center:a.slice(0),projection:t!==void 0?t:null,resolution:i,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:r,zoom:this.getZoom()}},e.prototype.getZoom=function(){var t,i=this.getResolution();return i!==void 0&&(t=this.getZoomForResolution(i)),t},e.prototype.getZoomForResolution=function(t){var i=this.minZoom_||0,r,a;if(this.resolutions_){var s=Oa(this.resolutions_,t,1);i=s,r=this.resolutions_[s],s==this.resolutions_.length-1?a=2:a=r/this.resolutions_[s+1]}else r=this.maxResolution_,a=this.zoomFactor_;return i+Math.log(r/t)/Math.log(a)},e.prototype.getResolutionForZoom=function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var i=at(Math.floor(t),0,this.resolutions_.length-2),r=this.resolutions_[i]/this.resolutions_[i+1];return this.resolutions_[i]/Math.pow(r,at(t-i,0,1))}else return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)},e.prototype.fit=function(t,i){var r;if(X(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function",24),Array.isArray(t)){X(!za(t),25);var a=mi(t,this.getProjection());r=Is(a)}else if(t.getType()===T.CIRCLE){var a=mi(t.getExtent(),this.getProjection());r=Is(a),r.rotate(this.getRotation(),Be(a))}else{var s=Sl();s?r=t.clone().transform(s,this.getProjection()):r=t}this.fitInternal(r,i)},e.prototype.rotatedExtentForGeometry=function(t){for(var i=this.getRotation(),r=Math.cos(i),a=Math.sin(-i),s=t.getFlatCoordinates(),o=t.getStride(),h=1/0,l=1/0,u=-1/0,f=-1/0,c=0,d=s.length;c<d;c+=o){var v=s[c]*r-s[c+1]*a,p=s[c]*a+s[c+1]*r;h=Math.min(h,v),l=Math.min(l,p),u=Math.max(u,v),f=Math.max(f,p)}return[h,l,u,f]},e.prototype.fitInternal=function(t,i){var r=i||{},a=r.size;a||(a=this.getViewportSizeMinusPadding_());var s=r.padding!==void 0?r.padding:[0,0,0,0],o=r.nearest!==void 0?r.nearest:!1,h;r.minResolution!==void 0?h=r.minResolution:r.maxZoom!==void 0?h=this.getResolutionForZoom(r.maxZoom):h=0;var l=this.rotatedExtentForGeometry(t),u=this.getResolutionForExtentInternal(l,[a[0]-s[1]-s[3],a[1]-s[0]-s[2]]);u=isNaN(u)?h:Math.max(u,h),u=this.getConstrainedResolution(u,o?0:1);var f=this.getRotation(),c=Math.sin(f),d=Math.cos(f),v=Be(l);v[0]+=(s[1]-s[3])/2*u,v[1]+=(s[0]-s[2])/2*u;var p=v[0]*d-v[1]*c,_=v[1]*d+v[0]*c,y=this.getConstrainedCenter([p,_],u),g=r.callback?r.callback:ce;r.duration!==void 0?this.animateInternal({resolution:u,center:y,duration:r.duration,easing:r.easing},g):(this.targetResolution_=u,this.targetCenter_=y,this.applyTargetState_(!1,!0),An(g,!0))},e.prototype.centerOn=function(t,i,r){this.centerOnInternal(Xt(t,this.getProjection()),i,r)},e.prototype.centerOnInternal=function(t,i,r){this.setCenterInternal(Yr(t,i,r,this.getResolution(),this.getRotation()))},e.prototype.calculateCenterShift=function(t,i,r,a){var s,o=this.padding_;if(o&&t){var h=this.getViewportSizeMinusPadding_(-r),l=Yr(t,a,[h[0]/2+o[3],h[1]/2+o[0]],i,r);s=[t[0]-l[0],t[1]-l[1]]}return s},e.prototype.isDef=function(){return!!this.getCenterInternal()&&this.getResolution()!==void 0},e.prototype.adjustCenter=function(t){var i=_r(this.targetCenter_,this.getProjection());this.setCenter([i[0]+t[0],i[1]+t[1]])},e.prototype.adjustCenterInternal=function(t){var i=this.targetCenter_;this.setCenterInternal([i[0]+t[0],i[1]+t[1]])},e.prototype.adjustResolution=function(t,i){var r=i&&Xt(i,this.getProjection());this.adjustResolutionInternal(t,r)},e.prototype.adjustResolutionInternal=function(t,i){var r=this.getAnimating()||this.getInteracting(),a=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*t,0,a,r);i&&(this.targetCenter_=this.calculateCenterZoom(s,i)),this.targetResolution_*=t,this.applyTargetState_()},e.prototype.adjustZoom=function(t,i){this.adjustResolution(Math.pow(this.zoomFactor_,-t),i)},e.prototype.adjustRotation=function(t,i){i&&(i=Xt(i,this.getProjection())),this.adjustRotationInternal(t,i)},e.prototype.adjustRotationInternal=function(t,i){var r=this.getAnimating()||this.getInteracting(),a=this.constraints_.rotation(this.targetRotation_+t,r);i&&(this.targetCenter_=this.calculateCenterRotate(a,i)),this.targetRotation_+=t,this.applyTargetState_()},e.prototype.setCenter=function(t){this.setCenterInternal(Xt(t,this.getProjection()))},e.prototype.setCenterInternal=function(t){this.targetCenter_=t,this.applyTargetState_()},e.prototype.setHint=function(t,i){return this.hints_[t]+=i,this.changed(),this.hints_[t]},e.prototype.setResolution=function(t){this.targetResolution_=t,this.applyTargetState_()},e.prototype.setRotation=function(t){this.targetRotation_=t,this.applyTargetState_()},e.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},e.prototype.applyTargetState_=function(t,i){var r=this.getAnimating()||this.getInteracting()||i,a=this.constraints_.rotation(this.targetRotation_,r),s=this.getViewportSize_(a),o=this.constraints_.resolution(this.targetResolution_,0,s,r),h=this.constraints_.center(this.targetCenter_,o,s,r,this.calculateCenterShift(this.targetCenter_,o,a,s));this.get(Ft.ROTATION)!==a&&this.set(Ft.ROTATION,a),this.get(Ft.RESOLUTION)!==o&&this.set(Ft.RESOLUTION,o),(!this.get(Ft.CENTER)||!fr(this.get(Ft.CENTER),h))&&this.set(Ft.CENTER,h),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0},e.prototype.resolveConstraints=function(t,i,r){var a=t!==void 0?t:200,s=i||0,o=this.constraints_.rotation(this.targetRotation_),h=this.getViewportSize_(o),l=this.constraints_.resolution(this.targetResolution_,s,h),u=this.constraints_.center(this.targetCenter_,l,h,!1,this.calculateCenterShift(this.targetCenter_,l,o,h));if(a===0&&!this.cancelAnchor_){this.targetResolution_=l,this.targetRotation_=o,this.targetCenter_=u,this.applyTargetState_();return}var f=r||(a===0?this.cancelAnchor_:void 0);this.cancelAnchor_=void 0,(this.getResolution()!==l||this.getRotation()!==o||!this.getCenterInternal()||!fr(this.getCenterInternal(),u))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:o,center:u,resolution:l,duration:a,easing:He,anchor:f}))},e.prototype.beginInteraction=function(){this.resolveConstraints(0),this.setHint(ct.INTERACTING,1)},e.prototype.endInteraction=function(t,i,r){var a=r&&Xt(r,this.getProjection());this.endInteractionInternal(t,i,a)},e.prototype.endInteractionInternal=function(t,i,r){this.setHint(ct.INTERACTING,-1),this.resolveConstraints(t,i,r)},e.prototype.getConstrainedCenter=function(t,i){var r=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,i||this.getResolution(),r)},e.prototype.getConstrainedZoom=function(t,i){var r=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(r,i))},e.prototype.getConstrainedResolution=function(t,i){var r=i||0,a=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,r,a)},e}(Pt);function An(n,e){setTimeout(function(){n(e)},0)}function Ad(n){if(n.extent!==void 0){var e=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return vo(n.extent,n.constrainOnlyCenter,e)}var t=pr(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&t.isGlobal()){var i=t.getExtent().slice();return i[0]=-1/0,i[2]=1/0,vo(i,!1,!1)}return Id}function Ld(n){var e,t,i,r=28,a=2,s=n.minZoom!==void 0?n.minZoom:Wr,o=n.maxZoom!==void 0?n.maxZoom:r,h=n.zoomFactor!==void 0?n.zoomFactor:a,l=n.multiWorld!==void 0?n.multiWorld:!1,u=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,f=n.showFullExtent!==void 0?n.showFullExtent:!1,c=pr(n.projection,"EPSG:3857"),d=c.getExtent(),v=n.constrainOnlyCenter,p=n.extent;if(!l&&!p&&c.isGlobal()&&(v=!1,p=d),n.resolutions!==void 0){var _=n.resolutions;t=_[s],i=_[o]!==void 0?_[o]:_[_.length-1],n.constrainResolution?e=Od(_,u,!v&&p,f):e=po(t,i,u,!v&&p,f)}else{var y=d?Math.max(xt(d),_e(d)):360*de[Fe.DEGREES]/c.getMetersPerUnit(),g=y/Cd/Math.pow(a,Wr),m=g/Math.pow(a,r-Wr);t=n.maxResolution,t!==void 0?s=0:t=g/Math.pow(h,s),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=t/Math.pow(h,o):i=g/Math.pow(h,o):i=m),o=s+Math.floor(Math.log(t/i)/Math.log(h)),i=t/Math.pow(h,o-s),n.constrainResolution?e=Rd(h,t,i,u,!v&&p,f):e=po(t,i,u,!v&&p,f)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:s,zoomFactor:h}}function Nd(n){var e=n.enableRotation!==void 0?n.enableRotation:!0;if(e){var t=n.constrainRotation;return t===void 0||t===!0?Sd():t===!1?_o:typeof t=="number"?wd(t):_o}else return Xr}function Dd(n){return!(n.sourceCenter&&n.targetCenter&&!fr(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function Yr(n,e,t,i,r){var a=Math.cos(-r),s=Math.sin(-r),o=n[0]*a-n[1]*s,h=n[1]*a+n[0]*s;o+=(e[0]/2-t[0])*i,h+=(t[1]-e[1]/2)*i,s=-s;var l=o*a-h*s,u=h*a+o*s;return[l,u]}var we=Pd,Fd=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Gd=function(n){Fd(e,n);function e(t){var i=n.call(this)||this;i.on,i.once,i.un;var r=bd(t);i.boundHandleBrowserEvent_=i.handleBrowserEvent.bind(i),i.maxTilesLoading_=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,i.pixelRatio_=t.pixelRatio!==void 0?t.pixelRatio:Aa,i.postRenderTimeoutHandle_,i.animationDelayKey_,i.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}.bind(i),i.coordinateToPixelTransform_=At(),i.pixelToCoordinateTransform_=At(),i.frameIndex_=0,i.frameState_=null,i.previousExtent_=null,i.viewPropertyListenerKey_=null,i.viewChangeListenerKey_=null,i.layerGroupPropertyListenerKeys_=null,i.viewport_=document.createElement("div"),i.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),i.viewport_.style.position="relative",i.viewport_.style.overflow="hidden",i.viewport_.style.width="100%",i.viewport_.style.height="100%",i.overlayContainer_=document.createElement("div"),i.overlayContainer_.style.position="absolute",i.overlayContainer_.style.zIndex="0",i.overlayContainer_.style.width="100%",i.overlayContainer_.style.height="100%",i.overlayContainer_.style.pointerEvents="none",i.overlayContainer_.className="ol-overlaycontainer",i.viewport_.appendChild(i.overlayContainer_),i.overlayContainerStopEvent_=document.createElement("div"),i.overlayContainerStopEvent_.style.position="absolute",i.overlayContainerStopEvent_.style.zIndex="0",i.overlayContainerStopEvent_.style.width="100%",i.overlayContainerStopEvent_.style.height="100%",i.overlayContainerStopEvent_.style.pointerEvents="none",i.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",i.viewport_.appendChild(i.overlayContainerStopEvent_),i.mapBrowserEventHandler_=null,i.moveTolerance_=t.moveTolerance,i.keyboardEventTarget_=r.keyboardEventTarget,i.keyHandlerKeys_=null,i.controls=r.controls||new Ot,i.interactions=r.interactions||new Ot,i.overlays_=r.overlays,i.overlayIdIndex_={},i.renderer_=null,i.handleResize_,i.postRenderFunctions_=[],i.tileQueue_=new Ed(i.getTilePriority.bind(i),i.handleTileChange_.bind(i)),i.addChangeListener(dt.LAYERGROUP,i.handleLayerGroupChanged_),i.addChangeListener(dt.VIEW,i.handleViewChanged_),i.addChangeListener(dt.SIZE,i.handleSizeChanged_),i.addChangeListener(dt.TARGET,i.handleTargetChanged_),i.setProperties(r.values);var a=i;return t.view&&!(t.view instanceof we)&&t.view.then(function(s){a.setView(new we(s))}),i.controls.addEventListener(mt.ADD,function(s){s.element.setMap(this)}.bind(i)),i.controls.addEventListener(mt.REMOVE,function(s){s.element.setMap(null)}.bind(i)),i.interactions.addEventListener(mt.ADD,function(s){s.element.setMap(this)}.bind(i)),i.interactions.addEventListener(mt.REMOVE,function(s){s.element.setMap(null)}.bind(i)),i.overlays_.addEventListener(mt.ADD,function(s){this.addOverlayInternal_(s.element)}.bind(i)),i.overlays_.addEventListener(mt.REMOVE,function(s){var o=s.element,h=o.getId();h!==void 0&&delete this.overlayIdIndex_[h.toString()],s.element.setMap(null)}.bind(i)),i.controls.forEach(function(s){s.setMap(this)}.bind(i)),i.interactions.forEach(function(s){s.setMap(this)}.bind(i)),i.overlays_.forEach(i.addOverlayInternal_.bind(i)),i}return e.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},e.prototype.addControl=function(t){this.getControls().push(t)},e.prototype.addInteraction=function(t){this.getInteractions().push(t)},e.prototype.addLayer=function(t){var i=this.getLayerGroup().getLayers();i.push(t)},e.prototype.addOverlay=function(t){this.getOverlays().push(t)},e.prototype.addOverlayInternal_=function(t){var i=t.getId();i!==void 0&&(this.overlayIdIndex_[i.toString()]=t),t.setMap(this)},e.prototype.disposeInternal=function(){this.setTarget(null),n.prototype.disposeInternal.call(this)},e.prototype.forEachFeatureAtPixel=function(t,i,r){if(!!this.frameState_){var a=this.getCoordinateFromPixelInternal(t);r=r!==void 0?r:{};var s=r.hitTolerance!==void 0?r.hitTolerance:0,o=r.layerFilter!==void 0?r.layerFilter:Le,h=r.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(a,this.frameState_,s,h,i,null,o,null)}},e.prototype.getFeaturesAtPixel=function(t,i){var r=[];return this.forEachFeatureAtPixel(t,function(a){r.push(a)},i),r},e.prototype.forEachLayerAtPixel=function(t,i,r){if(!!this.frameState_){var a=r||{},s=a.hitTolerance!==void 0?a.hitTolerance:0,o=a.layerFilter||Le;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,s,i,o)}},e.prototype.hasFeatureAtPixel=function(t,i){if(!this.frameState_)return!1;var r=this.getCoordinateFromPixelInternal(t);i=i!==void 0?i:{};var a=i.layerFilter!==void 0?i.layerFilter:Le,s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,s,o,a,null)},e.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},e.prototype.getEventCoordinateInternal=function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))},e.prototype.getEventPixel=function(t){var i=this.viewport_.getBoundingClientRect(),r="changedTouches"in t?t.changedTouches[0]:t;return[r.clientX-i.left,r.clientY-i.top]},e.prototype.getTarget=function(){return this.get(dt.TARGET)},e.prototype.getTargetElement=function(){var t=this.getTarget();return t!==void 0?typeof t=="string"?document.getElementById(t):t:null},e.prototype.getCoordinateFromPixel=function(t){return _r(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())},e.prototype.getCoordinateFromPixelInternal=function(t){var i=this.frameState_;return i?ot(i.pixelToCoordinateTransform,t.slice()):null},e.prototype.getControls=function(){return this.controls},e.prototype.getOverlays=function(){return this.overlays_},e.prototype.getOverlayById=function(t){var i=this.overlayIdIndex_[t.toString()];return i!==void 0?i:null},e.prototype.getInteractions=function(){return this.interactions},e.prototype.getLayerGroup=function(){return this.get(dt.LAYERGROUP)},e.prototype.setLayers=function(t){var i=this.getLayerGroup();if(t instanceof Ot){i.setLayers(t);return}var r=i.getLayers();r.clear(),r.extend(t)},e.prototype.getLayers=function(){var t=this.getLayerGroup().getLayers();return t},e.prototype.getLoading=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),i=0,r=t.length;i<r;++i){var a=t[i].layer,s=a.getSource();if(s&&s.loading)return!0}return!1},e.prototype.getPixelFromCoordinate=function(t){var i=Xt(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(i)},e.prototype.getPixelFromCoordinateInternal=function(t){var i=this.frameState_;return i?ot(i.coordinateToPixelTransform,t.slice(0,2)):null},e.prototype.getRenderer=function(){return this.renderer_},e.prototype.getSize=function(){return this.get(dt.SIZE)},e.prototype.getView=function(){return this.get(dt.VIEW)},e.prototype.getViewport=function(){return this.viewport_},e.prototype.getOverlayContainer=function(){return this.overlayContainer_},e.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},e.prototype.getOwnerDocument=function(){var t=this.getTargetElement();return t?t.ownerDocument:document},e.prototype.getTilePriority=function(t,i,r,a){return xd(this.frameState_,t,i,r,a)},e.prototype.handleBrowserEvent=function(t,i){var r=i||t.type,a=new se(r,this,t);this.handleMapBrowserEvent(a)},e.prototype.handleMapBrowserEvent=function(t){if(!!this.frameState_){var i=t.originalEvent,r=i.type;if(r===$r.POINTERDOWN||r===b.WHEEL||r===b.KEYDOWN){var a=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():a,o=i.target;if(this.overlayContainerStopEvent_.contains(o)||!(s===a?a.documentElement:s).contains(o))return}if(t.frameState=this.frameState_,this.dispatchEvent(t)!==!1)for(var h=this.getInteractions().getArray().slice(),l=h.length-1;l>=0;l--){var u=h[l];if(!(u.getMap()!==this||!u.getActive()||!this.getTargetElement())){var f=u.handleEvent(t);if(!f||t.propagationStopped)break}}}},e.prototype.handlePostRender=function(){var t=this.frameState_,i=this.tileQueue_;if(!i.isEmpty()){var r=this.maxTilesLoading_,a=r;if(t){var s=t.viewHints;if(s[ct.ANIMATING]||s[ct.INTERACTING]){var o=Date.now()-t.time>8;r=o?0:8,a=o?0:2}}i.getTilesLoading()<r&&(i.reprioritize(),i.loadMoreTiles(r,a))}t&&this.hasListener(Ce.RENDERCOMPLETE)&&!t.animate&&!this.tileQueue_.getTilesLoading()&&!this.getLoading()&&this.renderer_.dispatchRenderEvent(Ce.RENDERCOMPLETE,t);for(var h=this.postRenderFunctions_,l=0,u=h.length;l<u;++l)h[l](this,t);h.length=0},e.prototype.handleSizeChanged_=function(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()},e.prototype.handleTargetChanged_=function(){var t;if(this.getTarget()&&(t=this.getTargetElement()),this.mapBrowserEventHandler_){for(var i=0,r=this.keyHandlerKeys_.length;i<r;++i)Z(this.keyHandlerKeys_[i]);this.keyHandlerKeys_=null,this.viewport_.removeEventListener(b.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(b.WHEEL,this.boundHandleBrowserEvent_),this.handleResize_!==void 0&&(removeEventListener(b.RESIZE,this.handleResize_,!1),this.handleResize_=void 0),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,Pr(this.viewport_)}if(!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{t.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer()),this.mapBrowserEventHandler_=new _d(this,this.moveTolerance_);for(var a in q)this.mapBrowserEventHandler_.addEventListener(q[a],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(b.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(b.WHEEL,this.boundHandleBrowserEvent_,La?{passive:!1}:!1);var s=this.keyboardEventTarget_?this.keyboardEventTarget_:t;this.keyHandlerKeys_=[B(s,b.KEYDOWN,this.handleBrowserEvent,this),B(s,b.KEYPRESS,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),window.addEventListener(b.RESIZE,this.handleResize_,!1))}this.updateSize()},e.prototype.handleTileChange_=function(){this.render()},e.prototype.handleViewPropertyChanged_=function(){this.render()},e.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(Z(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Z(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=B(t,fe.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=B(t,b.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()},e.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Z),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.layerGroupPropertyListenerKeys_=[B(t,fe.PROPERTYCHANGE,this.render,this),B(t,b.CHANGE,this.render,this)]),this.render()},e.prototype.isRendered=function(){return!!this.frameState_},e.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},e.prototype.redrawText=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),i=0,r=t.length;i<r;++i){var a=t[i].layer;a.hasRenderer()&&a.getRenderer().handleFontsChanged()}},e.prototype.render=function(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},e.prototype.removeControl=function(t){return this.getControls().remove(t)},e.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},e.prototype.removeLayer=function(t){var i=this.getLayerGroup().getLayers();return i.remove(t)},e.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},e.prototype.renderFrame_=function(t){var i=this,r=this.getSize(),a=this.getView(),s=this.frameState_,o=null;if(r!==void 0&&Ss(r)&&a&&a.isDef()){var h=a.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=a.getState();if(o={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:hr(l.center,l.resolution,l.rotation,r),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:r,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:l,viewHints:h,wantedTiles:{}},l.nextCenter&&l.nextResolution){var u=isNaN(l.nextRotation)?l.rotation:l.nextRotation;o.nextExtent=hr(l.nextCenter,l.nextResolution,u,r)}}if(this.frameState_=o,this.renderer_.renderFrame(o),o){if(o.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,o.postRenderFunctions),s){var f=!this.previousExtent_||!za(this.previousExtent_)&&!on(o.extent,this.previousExtent_);f&&(this.dispatchEvent(new Sn(Tn.MOVESTART,this,s)),this.previousExtent_=gi(this.previousExtent_))}var c=this.previousExtent_&&!o.viewHints[ct.ANIMATING]&&!o.viewHints[ct.INTERACTING]&&!on(o.extent,this.previousExtent_);c&&(this.dispatchEvent(new Sn(Tn.MOVEEND,this,o)),Fa(o.extent,this.previousExtent_))}this.dispatchEvent(new Sn(Tn.POSTRENDER,this,o)),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(function(){i.postRenderTimeoutHandle_=void 0,i.handlePostRender()},0))},e.prototype.setLayerGroup=function(t){this.set(dt.LAYERGROUP,t)},e.prototype.setSize=function(t){this.set(dt.SIZE,t)},e.prototype.setTarget=function(t){this.set(dt.TARGET,t)},e.prototype.setView=function(t){if(!t||t instanceof we){this.set(dt.VIEW,t);return}this.set(dt.VIEW,new we);var i=this;t.then(function(r){i.setView(new we(r))})},e.prototype.updateSize=function(){var t=this.getTargetElement(),i=void 0;if(t){var r=getComputedStyle(t),a=t.offsetWidth-parseFloat(r.borderLeftWidth)-parseFloat(r.paddingLeft)-parseFloat(r.paddingRight)-parseFloat(r.borderRightWidth),s=t.offsetHeight-parseFloat(r.borderTopWidth)-parseFloat(r.paddingTop)-parseFloat(r.paddingBottom)-parseFloat(r.borderBottomWidth);!isNaN(a)&&!isNaN(s)&&(i=[a,s],!Ss(i)&&!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&console.warn("No map visible because the map container's width or height are 0."))}this.setSize(i),this.updateViewportSize_()},e.prototype.updateViewportSize_=function(){var t=this.getView();if(t){var i=void 0,r=getComputedStyle(this.viewport_);r.width&&r.height&&(i=[parseInt(r.width,10),parseInt(r.height,10)]),t.setViewportSize(i)}},e}(Pt);function bd(n){var e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);var t={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new ld({layers:n.layers});t[dt.LAYERGROUP]=i,t[dt.TARGET]=n.target,t[dt.VIEW]=n.view instanceof we?n.view:new we;var r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new Ot(n.controls.slice()):(X(typeof n.controls.getArray=="function",47),r=n.controls));var a;n.interactions!==void 0&&(Array.isArray(n.interactions)?a=new Ot(n.interactions.slice()):(X(typeof n.interactions.getArray=="function",48),a=n.interactions));var s;return n.overlays!==void 0?Array.isArray(n.overlays)?s=new Ot(n.overlays.slice()):(X(typeof n.overlays.getArray=="function",49),s=n.overlays):s=new Ot,{controls:r,interactions:a,keyboardEventTarget:e,overlays:s,values:t}}var kd=Gd,Bd=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),jd=function(n){Bd(e,n);function e(t){var i=n.call(this)||this,r=t.element;return r&&!t.target&&!r.style.pointerEvents&&(r.style.pointerEvents="auto"),i.element=r||null,i.target_=null,i.map_=null,i.listenerKeys=[],t.render&&(i.render=t.render),t.target&&i.setTarget(t.target),i}return e.prototype.disposeInternal=function(){Pr(this.element),n.prototype.disposeInternal.call(this)},e.prototype.getMap=function(){return this.map_},e.prototype.setMap=function(t){this.map_&&Pr(this.element);for(var i=0,r=this.listenerKeys.length;i<r;++i)Z(this.listenerKeys[i]);if(this.listenerKeys.length=0,this.map_=t,this.map_){var a=this.target_?this.target_:t.getOverlayContainerStopEvent();a.appendChild(this.element),this.render!==ce&&this.listenerKeys.push(B(t,Tn.POSTRENDER,this.render,this)),t.render()}},e.prototype.render=function(t){},e.prototype.setTarget=function(t){this.target_=typeof t=="string"?document.getElementById(t):t},e}(Pt),Vr=jd,$d=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ud=function(n){$d(e,n);function e(t){var i=this,r=t||{};i=n.call(this,{element:document.createElement("div"),render:r.render,target:r.target})||this,i.ulElement_=document.createElement("ul"),i.collapsed_=r.collapsed!==void 0?r.collapsed:!0,i.userCollapsed_=i.collapsed_,i.overrideCollapsible_=r.collapsible!==void 0,i.collapsible_=r.collapsible!==void 0?r.collapsible:!0,i.collapsible_||(i.collapsed_=!1);var a=r.className!==void 0?r.className:"ol-attribution",s=r.tipLabel!==void 0?r.tipLabel:"Attributions",o=r.expandClassName!==void 0?r.expandClassName:a+"-expand",h=r.collapseLabel!==void 0?r.collapseLabel:"\u203A",l=r.collapseClassName!==void 0?r.collapseClassName:a+"-collpase";typeof h=="string"?(i.collapseLabel_=document.createElement("span"),i.collapseLabel_.textContent=h,i.collapseLabel_.className=l):i.collapseLabel_=h;var u=r.label!==void 0?r.label:"i";typeof u=="string"?(i.label_=document.createElement("span"),i.label_.textContent=u,i.label_.className=o):i.label_=u;var f=i.collapsible_&&!i.collapsed_?i.collapseLabel_:i.label_;i.toggleButton_=document.createElement("button"),i.toggleButton_.setAttribute("type","button"),i.toggleButton_.setAttribute("aria-expanded",String(!i.collapsed_)),i.toggleButton_.title=s,i.toggleButton_.appendChild(f),i.toggleButton_.addEventListener(b.CLICK,i.handleClick_.bind(i),!1);var c=a+" "+gn+" "+Ar+(i.collapsed_&&i.collapsible_?" "+Fs:"")+(i.collapsible_?"":" ol-uncollapsible"),d=i.element;return d.className=c,d.appendChild(i.toggleButton_),d.appendChild(i.ulElement_),i.renderedAttributions_=[],i.renderedVisible_=!0,i}return e.prototype.collectSourceAttributions_=function(t){for(var i={},r=[],a=!0,s=t.layerStatesArray,o=0,h=s.length;o<h;++o){var l=s[o];if(!!En(l,t.viewState)){var u=l.layer.getSource();if(!!u){var f=u.getAttributions();if(!!f){var c=f(t);if(!!c)if(a=a&&u.getAttributionsCollapsible()!==!1,Array.isArray(c))for(var d=0,v=c.length;d<v;++d)c[d]in i||(r.push(c[d]),i[c[d]]=!0);else c in i||(r.push(c),i[c]=!0)}}}}return this.overrideCollapsible_||this.setCollapsible(a),r},e.prototype.updateElement_=function(t){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}var i=this.collectSourceAttributions_(t),r=i.length>0;if(this.renderedVisible_!=r&&(this.element.style.display=r?"":"none",this.renderedVisible_=r),!Ae(i,this.renderedAttributions_)){Hu(this.ulElement_);for(var a=0,s=i.length;a<s;++a){var o=document.createElement("li");o.innerHTML=i[a],this.ulElement_.appendChild(o)}this.renderedAttributions_=i}},e.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_},e.prototype.handleToggle_=function(){this.element.classList.toggle(Fs),this.collapsed_?Ds(this.collapseLabel_,this.label_):Ds(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))},e.prototype.getCollapsible=function(){return this.collapsible_},e.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())},e.prototype.setCollapsed=function(t){this.userCollapsed_=t,!(!this.collapsible_||this.collapsed_===t)&&this.handleToggle_()},e.prototype.getCollapsed=function(){return this.collapsed_},e.prototype.render=function(t){this.updateElement_(t.frameState)},e}(Vr),zd=Ud,Xd=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Wd=function(n){Xd(e,n);function e(t){var i=this,r=t||{};i=n.call(this,{element:document.createElement("div"),render:r.render,target:r.target})||this;var a=r.className!==void 0?r.className:"ol-rotate",s=r.label!==void 0?r.label:"\u21E7",o=r.compassClassName!==void 0?r.compassClassName:"ol-compass";i.label_=null,typeof s=="string"?(i.label_=document.createElement("span"),i.label_.className=o,i.label_.textContent=s):(i.label_=s,i.label_.classList.add(o));var h=r.tipLabel?r.tipLabel:"Reset rotation",l=document.createElement("button");l.className=a+"-reset",l.setAttribute("type","button"),l.title=h,l.appendChild(i.label_),l.addEventListener(b.CLICK,i.handleClick_.bind(i),!1);var u=a+" "+gn+" "+Ar,f=i.element;return f.className=u,f.appendChild(l),i.callResetNorth_=r.resetNorth?r.resetNorth:void 0,i.duration_=r.duration!==void 0?r.duration:250,i.autoHide_=r.autoHide!==void 0?r.autoHide:!0,i.rotation_=void 0,i.autoHide_&&i.element.classList.add(_n),i}return e.prototype.handleClick_=function(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()},e.prototype.resetNorth_=function(){var t=this.getMap(),i=t.getView();if(!!i){var r=i.getRotation();r!==void 0&&(this.duration_>0&&r%(2*Math.PI)!=0?i.animate({rotation:0,duration:this.duration_,easing:He}):i.setRotation(0))}},e.prototype.render=function(t){var i=t.frameState;if(!!i){var r=i.viewState.rotation;if(r!=this.rotation_){var a="rotate("+r+"rad)";if(this.autoHide_){var s=this.element.classList.contains(_n);!s&&r===0?this.element.classList.add(_n):s&&r!==0&&this.element.classList.remove(_n)}this.label_.style.transform=a}this.rotation_=r}},e}(Vr),Yd=Wd,Vd=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Kd=function(n){Vd(e,n);function e(t){var i=this,r=t||{};i=n.call(this,{element:document.createElement("div"),target:r.target})||this;var a=r.className!==void 0?r.className:"ol-zoom",s=r.delta!==void 0?r.delta:1,o=r.zoomInClassName!==void 0?r.zoomInClassName:a+"-in",h=r.zoomOutClassName!==void 0?r.zoomOutClassName:a+"-out",l=r.zoomInLabel!==void 0?r.zoomInLabel:"+",u=r.zoomOutLabel!==void 0?r.zoomOutLabel:"\u2013",f=r.zoomInTipLabel!==void 0?r.zoomInTipLabel:"Zoom in",c=r.zoomOutTipLabel!==void 0?r.zoomOutTipLabel:"Zoom out",d=document.createElement("button");d.className=o,d.setAttribute("type","button"),d.title=f,d.appendChild(typeof l=="string"?document.createTextNode(l):l),d.addEventListener(b.CLICK,i.handleClick_.bind(i,s),!1);var v=document.createElement("button");v.className=h,v.setAttribute("type","button"),v.title=c,v.appendChild(typeof u=="string"?document.createTextNode(u):u),v.addEventListener(b.CLICK,i.handleClick_.bind(i,-s),!1);var p=a+" "+gn+" "+Ar,_=i.element;return _.className=p,_.appendChild(d),_.appendChild(v),i.duration_=r.duration!==void 0?r.duration:250,i}return e.prototype.handleClick_=function(t,i){i.preventDefault(),this.zoomByDelta_(t)},e.prototype.zoomByDelta_=function(t){var i=this.getMap(),r=i.getView();if(!!r){var a=r.getZoom();if(a!==void 0){var s=r.getConstrainedZoom(a+t);this.duration_>0?(r.getAnimating()&&r.cancelAnimations(),r.animate({zoom:s,duration:this.duration_,easing:He})):r.setZoom(s)}}},e}(Vr),qd=Kd;function Hd(n){var e=n||{},t=new Ot,i=e.zoom!==void 0?e.zoom:!0;i&&t.push(new qd(e.zoomOptions));var r=e.rotate!==void 0?e.rotate:!0;r&&t.push(new Yd(e.rotateOptions));var a=e.attribution!==void 0?e.attribution:!0;return a&&t.push(new zd(e.attributionOptions)),t}var go={ACTIVE:"active"},Zd=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Jd=function(n){Zd(e,n);function e(t){var i=n.call(this)||this;return i.on,i.once,i.un,t&&t.handleEvent&&(i.handleEvent=t.handleEvent),i.map_=null,i.setActive(!0),i}return e.prototype.getActive=function(){return this.get(go.ACTIVE)},e.prototype.getMap=function(){return this.map_},e.prototype.handleEvent=function(t){return!0},e.prototype.setActive=function(t){this.set(go.ACTIVE,t)},e.prototype.setMap=function(t){this.map_=t},e}(Pt);function Qd(n,e,t){var i=n.getCenterInternal();if(i){var r=[i[0]+e[0],i[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:Zc,center:n.getConstrainedCenter(r)})}}function Kr(n,e,t,i){var r=n.getZoom();if(r!==void 0){var a=n.getConstrainedZoom(r+e),s=n.getResolutionForZoom(a);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:s,anchor:t,duration:i!==void 0?i:250,easing:He})}}var Ni=Jd,tv=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ev=function(n){tv(e,n);function e(t){var i=n.call(this)||this,r=t||{};return i.delta_=r.delta?r.delta:1,i.duration_=r.duration!==void 0?r.duration:250,i}return e.prototype.handleEvent=function(t){var i=!1;if(t.type==q.DBLCLICK){var r=t.originalEvent,a=t.map,s=t.coordinate,o=r.shiftKey?-this.delta_:this.delta_,h=a.getView();Kr(h,o,s,this.duration_),r.preventDefault(),i=!0}return!i},e}(Ni),iv=ev,nv=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),rv=function(n){nv(e,n);function e(t){var i=this,r=t||{};return i=n.call(this,r)||this,r.handleDownEvent&&(i.handleDownEvent=r.handleDownEvent),r.handleDragEvent&&(i.handleDragEvent=r.handleDragEvent),r.handleMoveEvent&&(i.handleMoveEvent=r.handleMoveEvent),r.handleUpEvent&&(i.handleUpEvent=r.handleUpEvent),r.stopDown&&(i.stopDown=r.stopDown),i.handlingDownUpSequence=!1,i.trackedPointers_={},i.targetPointers=[],i}return e.prototype.getPointerCount=function(){return this.targetPointers.length},e.prototype.handleDownEvent=function(t){return!1},e.prototype.handleDragEvent=function(t){},e.prototype.handleEvent=function(t){if(!t.originalEvent)return!0;var i=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==q.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==q.POINTERUP){var r=this.handleUpEvent(t);this.handlingDownUpSequence=r&&this.targetPointers.length>0}}else if(t.type==q.POINTERDOWN){var a=this.handleDownEvent(t);this.handlingDownUpSequence=a,i=this.stopDown(a)}else t.type==q.POINTERMOVE&&this.handleMoveEvent(t);return!i},e.prototype.handleMoveEvent=function(t){},e.prototype.handleUpEvent=function(t){return!1},e.prototype.stopDown=function(t){return t},e.prototype.updateTrackedPointers_=function(t){if(av(t)){var i=t.originalEvent,r=i.pointerId.toString();t.type==q.POINTERUP?delete this.trackedPointers_[r]:t.type==q.POINTERDOWN?this.trackedPointers_[r]=i:r in this.trackedPointers_&&(this.trackedPointers_[r]=i),this.targetPointers=Ra(this.trackedPointers_)}},e}(Ni);function qr(n){for(var e=n.length,t=0,i=0,r=0;r<e;r++)t+=n[r].clientX,i+=n[r].clientY;return[t/e,i/e]}function av(n){var e=n.type;return e===q.POINTERDOWN||e===q.POINTERDRAG||e===q.POINTERUP}var Di=rv;function Hr(n){var e=arguments;return function(t){for(var i=!0,r=0,a=e.length;r<a&&(i=i&&e[r](t),!!i);++r);return i}}var sv=function(n){var e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},ov=function(n){return n.target.getTargetElement().contains(document.activeElement)},yo=function(n){return n.map.getTargetElement().hasAttribute("tabindex")?ov(n):!0},hv=Le,mo=function(n){var e=n.originalEvent;return e.button==0&&!(zh&&Xh&&e.ctrlKey)},Mo=function(n){var e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},lv=function(n){var e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Eo=function(n){var e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"},Zr=function(n){var e=n.originalEvent;return X(e!==void 0,56),e.pointerType=="mouse"},uv=function(n){var e=n.originalEvent;return X(e!==void 0,56),e.isPrimary&&e.button===0},fv=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),cv=function(n){fv(e,n);function e(t){var i=n.call(this,{stopDown:nn})||this,r=t||{};i.kinetic_=r.kinetic,i.lastCentroid=null,i.lastPointersCount_,i.panning_=!1;var a=r.condition?r.condition:Hr(Mo,uv);return i.condition_=r.onFocusOnly?Hr(yo,a):a,i.noKinetic_=!1,i}return e.prototype.handleDragEvent=function(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var i=this.targetPointers,r=qr(i);if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){var a=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],s=t.map,o=s.getView();El(a,o.getResolution()),cr(a,o.getRotation()),o.adjustCenterInternal(a)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,t.originalEvent.preventDefault()},e.prototype.handleUpEvent=function(t){var i=t.map,r=i.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var a=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=r.getCenterInternal(),h=i.getPixelFromCoordinateInternal(o),l=i.getCoordinateFromPixelInternal([h[0]-a*Math.cos(s),h[1]-a*Math.sin(s)]);r.animateInternal({center:r.getConstrainedCenter(l),duration:500,easing:He})}return this.panning_&&(this.panning_=!1,r.endInteraction()),!1}else return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.condition_(t)){var i=t.map,r=i.getView();return this.lastCentroid=null,r.getAnimating()&&r.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}else return!1},e}(Di),dv=cv,vv=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),pv=function(n){vv(e,n);function e(t){var i=this,r=t||{};return i=n.call(this,{stopDown:nn})||this,i.condition_=r.condition?r.condition:sv,i.lastAngle_=void 0,i.duration_=r.duration!==void 0?r.duration:250,i}return e.prototype.handleDragEvent=function(t){if(!!Zr(t)){var i=t.map,r=i.getView();if(r.getConstraints().rotation!==Xr){var a=i.getSize(),s=t.pixel,o=Math.atan2(a[1]/2-s[1],s[0]-a[0]/2);if(this.lastAngle_!==void 0){var h=o-this.lastAngle_;r.adjustRotationInternal(-h)}this.lastAngle_=o}}},e.prototype.handleUpEvent=function(t){if(!Zr(t))return!0;var i=t.map,r=i.getView();return r.endInteraction(this.duration_),!1},e.prototype.handleDownEvent=function(t){if(!Zr(t))return!1;if(mo(t)&&this.condition_(t)){var i=t.map;return i.getView().beginInteraction(),this.lastAngle_=void 0,!0}else return!1},e}(Di),_v=pv,gv=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),yv=function(n){gv(e,n);function e(t){var i=n.call(this)||this;return i.geometry_=null,i.element_=document.createElement("div"),i.element_.style.position="absolute",i.element_.style.pointerEvents="auto",i.element_.className="ol-box "+t,i.map_=null,i.startPixel_=null,i.endPixel_=null,i}return e.prototype.disposeInternal=function(){this.setMap(null)},e.prototype.render_=function(){var t=this.startPixel_,i=this.endPixel_,r="px",a=this.element_.style;a.left=Math.min(t[0],i[0])+r,a.top=Math.min(t[1],i[1])+r,a.width=Math.abs(i[0]-t[0])+r,a.height=Math.abs(i[1]-t[1])+r},e.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var i=this.element_.style;i.left="inherit",i.top="inherit",i.width="inherit",i.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},e.prototype.setPixels=function(t,i){this.startPixel_=t,this.endPixel_=i,this.createOrUpdateGeometry(),this.render_()},e.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,i=this.endPixel_,r=[t,[t[0],i[1]],i,[i[0],t[1]]],a=r.map(this.map_.getCoordinateFromPixelInternal,this.map_);a[4]=a[0].slice(),this.geometry_?this.geometry_.setCoordinates([a]):this.geometry_=new dn([a])},e.prototype.getGeometry=function(){return this.geometry_},e}(rr),mv=yv,xo=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ln={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"},Jr=function(n){xo(e,n);function e(t,i,r){var a=n.call(this,t)||this;return a.coordinate=i,a.mapBrowserEvent=r,a}return e}(ue),Mv=function(n){xo(e,n);function e(t){var i=n.call(this)||this;i.on,i.once,i.un;var r=t||{};return i.box_=new mv(r.className||"ol-dragbox"),i.minArea_=r.minArea!==void 0?r.minArea:64,r.onBoxEnd&&(i.onBoxEnd=r.onBoxEnd),i.startPixel_=null,i.condition_=r.condition?r.condition:mo,i.boxEndCondition_=r.boxEndCondition?r.boxEndCondition:i.defaultBoxEndCondition,i}return e.prototype.defaultBoxEndCondition=function(t,i,r){var a=r[0]-i[0],s=r[1]-i[1];return a*a+s*s>=this.minArea_},e.prototype.getGeometry=function(){return this.box_.getGeometry()},e.prototype.handleDragEvent=function(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new Jr(Ln.BOXDRAG,t.coordinate,t))},e.prototype.handleUpEvent=function(t){this.box_.setMap(null);var i=this.boxEndCondition_(t,this.startPixel_,t.pixel);return i&&this.onBoxEnd(t),this.dispatchEvent(new Jr(i?Ln.BOXEND:Ln.BOXCANCEL,t.coordinate,t)),!1},e.prototype.handleDownEvent=function(t){return this.condition_(t)?(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Jr(Ln.BOXSTART,t.coordinate,t)),!0):!1},e.prototype.onBoxEnd=function(t){},e}(Di),Ev=Mv,xv=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Cv=function(n){xv(e,n);function e(t){var i=this,r=t||{},a=r.condition?r.condition:lv;return i=n.call(this,{condition:a,className:r.className||"ol-dragzoom",minArea:r.minArea})||this,i.duration_=r.duration!==void 0?r.duration:200,i.out_=r.out!==void 0?r.out:!1,i}return e.prototype.onBoxEnd=function(t){var i=this.getMap(),r=i.getView(),a=this.getGeometry();if(this.out_){var s=r.rotatedExtentForGeometry(a),o=r.getResolutionForExtentInternal(s),h=r.getResolution()/o;a=a.clone(),a.scale(h*h)}r.fitInternal(a,{duration:this.duration_,easing:He})},e}(Ev),Iv=Cv,Se={LEFT:37,UP:38,RIGHT:39,DOWN:40},Ov=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Rv=function(n){Ov(e,n);function e(t){var i=n.call(this)||this,r=t||{};return i.defaultCondition_=function(a){return Mo(a)&&Eo(a)},i.condition_=r.condition!==void 0?r.condition:i.defaultCondition_,i.duration_=r.duration!==void 0?r.duration:100,i.pixelDelta_=r.pixelDelta!==void 0?r.pixelDelta:128,i}return e.prototype.handleEvent=function(t){var i=!1;if(t.type==b.KEYDOWN){var r=t.originalEvent,a=r.keyCode;if(this.condition_(t)&&(a==Se.DOWN||a==Se.LEFT||a==Se.RIGHT||a==Se.UP)){var s=t.map,o=s.getView(),h=o.getResolution()*this.pixelDelta_,l=0,u=0;a==Se.DOWN?u=-h:a==Se.LEFT?l=-h:a==Se.RIGHT?l=h:u=h;var f=[l,u];cr(f,o.getRotation()),Qd(o,f,this.duration_),r.preventDefault(),i=!0}}return!i},e}(Ni),wv=Rv,Sv=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Tv=function(n){Sv(e,n);function e(t){var i=n.call(this)||this,r=t||{};return i.condition_=r.condition?r.condition:Eo,i.delta_=r.delta?r.delta:1,i.duration_=r.duration!==void 0?r.duration:100,i}return e.prototype.handleEvent=function(t){var i=!1;if(t.type==b.KEYDOWN||t.type==b.KEYPRESS){var r=t.originalEvent,a=r.charCode;if(this.condition_(t)&&(a=="+".charCodeAt(0)||a=="-".charCodeAt(0))){var s=t.map,o=a=="+".charCodeAt(0)?this.delta_:-this.delta_,h=s.getView();Kr(h,o,void 0,this.duration_),r.preventDefault(),i=!0}}return!i},e}(Ni),Pv=Tv,Av=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Qr={TRACKPAD:"trackpad",WHEEL:"wheel"},Lv=function(n){Av(e,n);function e(t){var i=this,r=t||{};i=n.call(this,r)||this,i.totalDelta_=0,i.lastDelta_=0,i.maxDelta_=r.maxDelta!==void 0?r.maxDelta:1,i.duration_=r.duration!==void 0?r.duration:250,i.timeout_=r.timeout!==void 0?r.timeout:80,i.useAnchor_=r.useAnchor!==void 0?r.useAnchor:!0,i.constrainResolution_=r.constrainResolution!==void 0?r.constrainResolution:!1;var a=r.condition?r.condition:hv;return i.condition_=r.onFocusOnly?Hr(yo,a):a,i.lastAnchor_=null,i.startTime_=void 0,i.timeoutId_,i.mode_=void 0,i.trackpadEventGap_=400,i.trackpadTimeoutId_,i.deltaPerZoom_=300,i}return e.prototype.endInteraction_=function(){this.trackpadTimeoutId_=void 0;var t=this.getMap().getView();t.endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)},e.prototype.handleEvent=function(t){if(!this.condition_(t))return!0;var i=t.type;if(i!==b.WHEEL)return!0;var r=t.map,a=t.originalEvent;a.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate);var s;if(t.type==b.WHEEL&&(s=a.deltaY,Uh&&a.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(s/=Aa),a.deltaMode===WheelEvent.DOM_DELTA_LINE&&(s*=40)),s===0)return!1;this.lastDelta_=s;var o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?Qr.TRACKPAD:Qr.WHEEL);var h=r.getView();if(this.mode_===Qr.TRACKPAD&&!(h.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(h.getAnimating()&&h.cancelAnimations(),h.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),h.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=o,!1;this.totalDelta_+=s;var l=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,r),l),!1},e.prototype.handleWheelZoom_=function(t){var i=t.getView();i.getAnimating()&&i.cancelAnimations();var r=-at(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(i.getConstrainResolution()||this.constrainResolution_)&&(r=r?r>0?1:-1:0),Kr(i,r,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},e.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},e}(Ni),Nv=Lv,Dv=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Fv=function(n){Dv(e,n);function e(t){var i=this,r=t||{},a=r;return a.stopDown||(a.stopDown=nn),i=n.call(this,a)||this,i.anchor_=null,i.lastAngle_=void 0,i.rotating_=!1,i.rotationDelta_=0,i.threshold_=r.threshold!==void 0?r.threshold:.3,i.duration_=r.duration!==void 0?r.duration:250,i}return e.prototype.handleDragEvent=function(t){var i=0,r=this.targetPointers[0],a=this.targetPointers[1],s=Math.atan2(a.clientY-r.clientY,a.clientX-r.clientX);if(this.lastAngle_!==void 0){var o=s-this.lastAngle_;this.rotationDelta_+=o,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),i=o}this.lastAngle_=s;var h=t.map,l=h.getView();if(l.getConstraints().rotation!==Xr){var u=h.getViewport().getBoundingClientRect(),f=qr(this.targetPointers);f[0]-=u.left,f[1]-=u.top,this.anchor_=h.getCoordinateFromPixelInternal(f),this.rotating_&&(h.render(),l.adjustRotationInternal(i,this.anchor_))}},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var i=t.map,r=i.getView();return r.endInteraction(this.duration_),!1}else return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var i=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||i.getView().beginInteraction(),!0}else return!1},e}(Di),Gv=Fv,bv=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),kv=function(n){bv(e,n);function e(t){var i=this,r=t||{},a=r;return a.stopDown||(a.stopDown=nn),i=n.call(this,a)||this,i.anchor_=null,i.duration_=r.duration!==void 0?r.duration:400,i.lastDistance_=void 0,i.lastScaleDelta_=1,i}return e.prototype.handleDragEvent=function(t){var i=1,r=this.targetPointers[0],a=this.targetPointers[1],s=r.clientX-a.clientX,o=r.clientY-a.clientY,h=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(i=this.lastDistance_/h),this.lastDistance_=h;var l=t.map,u=l.getView();i!=1&&(this.lastScaleDelta_=i);var f=l.getViewport().getBoundingClientRect(),c=qr(this.targetPointers);c[0]-=f.left,c[1]-=f.top,this.anchor_=l.getCoordinateFromPixelInternal(c),l.render(),u.adjustResolutionInternal(i,this.anchor_)},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var i=t.map,r=i.getView(),a=this.lastScaleDelta_>1?1:-1;return r.endInteraction(this.duration_,a),!1}else return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var i=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||i.getView().beginInteraction(),!0}else return!1},e}(Di),Bv=kv;function jv(n){var e=n||{},t=new Ot,i=new Qc(-.005,.05,100),r=e.altShiftDragRotate!==void 0?e.altShiftDragRotate:!0;r&&t.push(new _v);var a=e.doubleClickZoom!==void 0?e.doubleClickZoom:!0;a&&t.push(new iv({delta:e.zoomDelta,duration:e.zoomDuration}));var s=e.dragPan!==void 0?e.dragPan:!0;s&&t.push(new dv({onFocusOnly:e.onFocusOnly,kinetic:i}));var o=e.pinchRotate!==void 0?e.pinchRotate:!0;o&&t.push(new Gv);var h=e.pinchZoom!==void 0?e.pinchZoom:!0;h&&t.push(new Bv({duration:e.zoomDuration}));var l=e.keyboard!==void 0?e.keyboard:!0;l&&(t.push(new wv),t.push(new Pv({delta:e.zoomDelta,duration:e.zoomDuration})));var u=e.mouseWheelZoom!==void 0?e.mouseWheelZoom:!0;u&&t.push(new Nv({onFocusOnly:e.onFocusOnly,duration:e.zoomDuration}));var f=e.shiftDragZoom!==void 0?e.shiftDragZoom:!0;return f&&t.push(new Iv({duration:e.zoomDuration})),t}var $v=function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},n(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Uv=function(n){$v(e,n);function e(t){var i=this;return t=pt({},t),t.controls||(t.controls=Hd()),t.interactions||(t.interactions=jv({onFocusOnly:!0})),i=n.call(this,t)||this,i}return e.prototype.createRenderer=function(){return new sd(this)},e}(kd),Ey=Uv;function zv(n){n("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),n("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),n("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),n.WGS84=n["EPSG:4326"],n["EPSG:3785"]=n["EPSG:3857"],n.GOOGLE=n["EPSG:3857"],n["EPSG:900913"]=n["EPSG:3857"],n["EPSG:102113"]=n["EPSG:3857"]}var Te=1,Pe=2,Nn=3,Xv=4,ta=5,Co=6378137,Wv=6356752314e-3,Io=.0066943799901413165,Fi=484813681109536e-20,x=Math.PI/2,Yv=.16666666666666666,Vv=.04722222222222222,Kv=.022156084656084655,R=1e-10,ft=.017453292519943295,Gt=57.29577951308232,j=Math.PI/4,Gi=Math.PI*2,rt=3.14159265359,Mt={};Mt.greenwich=0;Mt.lisbon=-9.131906111111;Mt.paris=2.337229166667;Mt.bogota=-74.080916666667;Mt.madrid=-3.687938888889;Mt.rome=12.452333333333;Mt.bern=7.439583333333;Mt.jakarta=106.807719444444;Mt.ferro=-17.666666666667;Mt.brussels=4.367975;Mt.stockholm=18.058277777778;Mt.athens=23.7163375;Mt.oslo=10.722916666667;var qv={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},Oo=/[\s_\-\/\(\)]/g;function oe(n,e){if(n[e])return n[e];for(var t=Object.keys(n),i=e.toLowerCase().replace(Oo,""),r=-1,a,s;++r<t.length;)if(a=t[r],s=a.toLowerCase().replace(Oo,""),s===i)return n[a]}function ea(n){var e={},t=n.split("+").map(function(o){return o.trim()}).filter(function(o){return o}).reduce(function(o,h){var l=h.split("=");return l.push(!0),o[l[0].toLowerCase()]=l[1],o},{}),i,r,a,s={proj:"projName",datum:"datumCode",rf:function(o){e.rf=parseFloat(o)},lat_0:function(o){e.lat0=o*ft},lat_1:function(o){e.lat1=o*ft},lat_2:function(o){e.lat2=o*ft},lat_ts:function(o){e.lat_ts=o*ft},lon_0:function(o){e.long0=o*ft},lon_1:function(o){e.long1=o*ft},lon_2:function(o){e.long2=o*ft},alpha:function(o){e.alpha=parseFloat(o)*ft},gamma:function(o){e.rectified_grid_angle=parseFloat(o)},lonc:function(o){e.longc=o*ft},x_0:function(o){e.x0=parseFloat(o)},y_0:function(o){e.y0=parseFloat(o)},k_0:function(o){e.k0=parseFloat(o)},k:function(o){e.k0=parseFloat(o)},a:function(o){e.a=parseFloat(o)},b:function(o){e.b=parseFloat(o)},r_a:function(){e.R_A=!0},zone:function(o){e.zone=parseInt(o,10)},south:function(){e.utmSouth=!0},towgs84:function(o){e.datum_params=o.split(",").map(function(h){return parseFloat(h)})},to_meter:function(o){e.to_meter=parseFloat(o)},units:function(o){e.units=o;var h=oe(qv,o);h&&(e.to_meter=h.to_meter)},from_greenwich:function(o){e.from_greenwich=o*ft},pm:function(o){var h=oe(Mt,o);e.from_greenwich=(h||parseFloat(o))*ft},nadgrids:function(o){o==="@null"?e.datumCode="none":e.nadgrids=o},axis:function(o){var h="ewnsud";o.length===3&&h.indexOf(o.substr(0,1))!==-1&&h.indexOf(o.substr(1,1))!==-1&&h.indexOf(o.substr(2,1))!==-1&&(e.axis=o)},approx:function(){e.approx=!0}};for(i in t)r=t[i],i in s?(a=s[i],typeof a=="function"?a(r):e[a]=r):e[i]=r;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e}var bi=1,Ro=2,wo=3,Dn=4,So=5,ia=-1,Hv=/\s/,Zv=/[A-Za-z]/,Jv=/[A-Za-z84_]/,Fn=/[,\]]/,To=/[\d\.E\-\+]/;function Ht(n){if(typeof n!="string")throw new Error("not a string");this.text=n.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=bi}Ht.prototype.readCharicter=function(){var n=this.text[this.place++];if(this.state!==Dn)for(;Hv.test(n);){if(this.place>=this.text.length)return;n=this.text[this.place++]}switch(this.state){case bi:return this.neutral(n);case Ro:return this.keyword(n);case Dn:return this.quoted(n);case So:return this.afterquote(n);case wo:return this.number(n);case ia:return}};Ht.prototype.afterquote=function(n){if(n==='"'){this.word+='"',this.state=Dn;return}if(Fn.test(n)){this.word=this.word.trim(),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in afterquote yet, index '+this.place)};Ht.prototype.afterItem=function(n){if(n===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=bi;return}if(n==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=bi,this.currentObject=this.stack.pop(),this.currentObject||(this.state=ia);return}};Ht.prototype.number=function(n){if(To.test(n)){this.word+=n;return}if(Fn.test(n)){this.word=parseFloat(this.word),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in number yet, index '+this.place)};Ht.prototype.quoted=function(n){if(n==='"'){this.state=So;return}this.word+=n};Ht.prototype.keyword=function(n){if(Jv.test(n)){this.word+=n;return}if(n==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=bi;return}if(Fn.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in keyword yet, index '+this.place)};Ht.prototype.neutral=function(n){if(Zv.test(n)){this.word=n,this.state=Ro;return}if(n==='"'){this.word="",this.state=Dn;return}if(To.test(n)){this.word=n,this.state=wo;return}if(Fn.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in neutral yet, index '+this.place)};Ht.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===ia)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function Qv(n){var e=new Ht(n);return e.output()}function Po(n,e,t){Array.isArray(e)&&(t.unshift(e),e=null);var i=e?{}:n,r=t.reduce(function(a,s){return Ze(s,a),a},i);e&&(n[e]=r)}function Ze(n,e){if(!Array.isArray(n)){e[n]=!0;return}var t=n.shift();if(t==="PARAMETER"&&(t=n.shift()),n.length===1){if(Array.isArray(n[0])){e[t]={},Ze(n[0],e[t]);return}e[t]=n[0];return}if(!n.length){e[t]=!0;return}if(t==="TOWGS84"){e[t]=n;return}if(t==="AXIS"){t in e||(e[t]=[]),e[t].push(n);return}Array.isArray(t)||(e[t]={});var i;switch(t){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[t]={name:n[0].toLowerCase(),convert:n[1]},n.length===3&&Ze(n[2],e[t]);return;case"SPHEROID":case"ELLIPSOID":e[t]={name:n[0],a:n[1],rf:n[2]},n.length===4&&Ze(n[3],e[t]);return;case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":n[0]=["name",n[0]],Po(e,t,n);return;default:for(i=-1;++i<n.length;)if(!Array.isArray(n[i]))return Ze(n,e[t]);return Po(e,t,n)}}var tp=.017453292519943295;function ep(n,e){var t=e[0],i=e[1];!(t in n)&&i in n&&(n[t]=n[i],e.length===3&&(n[t]=e[2](n[t])))}function Zt(n){return n*tp}function ip(n){if(n.type==="GEOGCS"?n.projName="longlat":n.type==="LOCAL_CS"?(n.projName="identity",n.local=!0):typeof n.PROJECTION=="object"?n.projName=Object.keys(n.PROJECTION)[0]:n.projName=n.PROJECTION,n.AXIS){for(var e="",t=0,i=n.AXIS.length;t<i;++t){var r=[n.AXIS[t][0].toLowerCase(),n.AXIS[t][1].toLowerCase()];r[0].indexOf("north")!==-1||(r[0]==="y"||r[0]==="lat")&&r[1]==="north"?e+="n":r[0].indexOf("south")!==-1||(r[0]==="y"||r[0]==="lat")&&r[1]==="south"?e+="s":r[0].indexOf("east")!==-1||(r[0]==="x"||r[0]==="lon")&&r[1]==="east"?e+="e":(r[0].indexOf("west")!==-1||(r[0]==="x"||r[0]==="lon")&&r[1]==="west")&&(e+="w")}e.length===2&&(e+="u"),e.length===3&&(n.axis=e)}n.UNIT&&(n.units=n.UNIT.name.toLowerCase(),n.units==="metre"&&(n.units="meter"),n.UNIT.convert&&(n.type==="GEOGCS"?n.DATUM&&n.DATUM.SPHEROID&&(n.to_meter=n.UNIT.convert*n.DATUM.SPHEROID.a):n.to_meter=n.UNIT.convert));var a=n.GEOGCS;n.type==="GEOGCS"&&(a=n),a&&(a.DATUM?n.datumCode=a.DATUM.name.toLowerCase():n.datumCode=a.name.toLowerCase(),n.datumCode.slice(0,2)==="d_"&&(n.datumCode=n.datumCode.slice(2)),(n.datumCode==="new_zealand_geodetic_datum_1949"||n.datumCode==="new_zealand_1949")&&(n.datumCode="nzgd49"),(n.datumCode==="wgs_1984"||n.datumCode==="world_geodetic_system_1984")&&(n.PROJECTION==="Mercator_Auxiliary_Sphere"&&(n.sphere=!0),n.datumCode="wgs84"),n.datumCode.slice(-6)==="_ferro"&&(n.datumCode=n.datumCode.slice(0,-6)),n.datumCode.slice(-8)==="_jakarta"&&(n.datumCode=n.datumCode.slice(0,-8)),~n.datumCode.indexOf("belge")&&(n.datumCode="rnb72"),a.DATUM&&a.DATUM.SPHEROID&&(n.ellps=a.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),n.ellps.toLowerCase().slice(0,13)==="international"&&(n.ellps="intl"),n.a=a.DATUM.SPHEROID.a,n.rf=parseFloat(a.DATUM.SPHEROID.rf,10)),a.DATUM&&a.DATUM.TOWGS84&&(n.datum_params=a.DATUM.TOWGS84),~n.datumCode.indexOf("osgb_1936")&&(n.datumCode="osgb36"),~n.datumCode.indexOf("osni_1952")&&(n.datumCode="osni52"),(~n.datumCode.indexOf("tm65")||~n.datumCode.indexOf("geodetic_datum_of_1965"))&&(n.datumCode="ire65"),n.datumCode==="ch1903+"&&(n.datumCode="ch1903"),~n.datumCode.indexOf("israel")&&(n.datumCode="isr93")),n.b&&!isFinite(n.b)&&(n.b=n.a);function s(l){var u=n.to_meter||1;return l*u}var o=function(l){return ep(n,l)},h=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Zt],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Zt],["x0","false_easting",s],["y0","false_northing",s],["long0","central_meridian",Zt],["lat0","latitude_of_origin",Zt],["lat0","standard_parallel_1",Zt],["lat1","standard_parallel_1",Zt],["lat2","standard_parallel_2",Zt],["azimuth","Azimuth"],["alpha","azimuth",Zt],["srsCode","name"]];h.forEach(o),!n.long0&&n.longc&&(n.projName==="Albers_Conic_Equal_Area"||n.projName==="Lambert_Azimuthal_Equal_Area")&&(n.long0=n.longc),!n.lat_ts&&n.lat1&&(n.projName==="Stereographic_South_Pole"||n.projName==="Polar Stereographic (variant B)")&&(n.lat0=Zt(n.lat1>0?90:-90),n.lat_ts=n.lat1)}function Ao(n){var e=Qv(n),t=e.shift(),i=e.shift();e.unshift(["name",i]),e.unshift(["type",t]);var r={};return Ze(e,r),ip(r),r}function _t(n){var e=this;if(arguments.length===2){var t=arguments[1];typeof t=="string"?t.charAt(0)==="+"?_t[n]=ea(arguments[1]):_t[n]=Ao(arguments[1]):_t[n]=t}else if(arguments.length===1){if(Array.isArray(n))return n.map(function(i){Array.isArray(i)?_t.apply(e,i):_t(i)});if(typeof n=="string"){if(n in _t)return _t[n]}else"EPSG"in n?_t["EPSG:"+n.EPSG]=n:"ESRI"in n?_t["ESRI:"+n.ESRI]=n:"IAU2000"in n?_t["IAU2000:"+n.IAU2000]=n:console.log(n);return}}zv(_t);function np(n){return typeof n=="string"}function rp(n){return n in _t}var ap=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function sp(n){return ap.some(function(e){return n.indexOf(e)>-1})}var op=["3857","900913","3785","102113"];function hp(n){var e=oe(n,"authority");if(!!e){var t=oe(e,"epsg");return t&&op.indexOf(t)>-1}}function lp(n){var e=oe(n,"extension");if(!!e)return oe(e,"proj4")}function up(n){return n[0]==="+"}function fp(n){if(np(n)){if(rp(n))return _t[n];if(sp(n)){var e=Ao(n);if(hp(e))return _t["EPSG:3857"];var t=lp(e);return t?ea(t):e}if(up(n))return ea(n)}else return n}function Lo(n,e){n=n||{};var t,i;if(!e)return n;for(i in e)t=e[i],t!==void 0&&(n[i]=t);return n}function bt(n,e,t){var i=n*e;return t/Math.sqrt(1-i*i)}function ki(n){return n<0?-1:1}function w(n){return Math.abs(n)<=rt?n:n-ki(n)*Gi}function Tt(n,e,t){var i=n*t,r=.5*n;return i=Math.pow((1-i)/(1+i),r),Math.tan(.5*(x-e))/i}function Bi(n,e){for(var t=.5*n,i,r,a=x-2*Math.atan(e),s=0;s<=15;s++)if(i=n*Math.sin(a),r=x-2*Math.atan(e*Math.pow((1-i)/(1+i),t))-a,a+=r,Math.abs(r)<=1e-10)return a;return-9999}function cp(){var n=this.b/this.a;this.es=1-n*n,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=bt(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function dp(n){var e=n.x,t=n.y;if(t*Gt>90&&t*Gt<-90&&e*Gt>180&&e*Gt<-180)return null;var i,r;if(Math.abs(Math.abs(t)-x)<=R)return null;if(this.sphere)i=this.x0+this.a*this.k0*w(e-this.long0),r=this.y0+this.a*this.k0*Math.log(Math.tan(j+.5*t));else{var a=Math.sin(t),s=Tt(this.e,t,a);i=this.x0+this.a*this.k0*w(e-this.long0),r=this.y0-this.a*this.k0*Math.log(s)}return n.x=i,n.y=r,n}function vp(n){var e=n.x-this.x0,t=n.y-this.y0,i,r;if(this.sphere)r=x-2*Math.atan(Math.exp(-t/(this.a*this.k0)));else{var a=Math.exp(-t/(this.a*this.k0));if(r=Bi(this.e,a),r===-9999)return null}return i=w(this.long0+e/(this.a*this.k0)),n.x=i,n.y=r,n}var pp=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"],_p={init:cp,forward:dp,inverse:vp,names:pp};function gp(){}function No(n){return n}var yp=["longlat","identity"],mp={init:gp,forward:No,inverse:No,names:yp},Mp=[_p,mp],Gn={},bn=[];function Do(n,e){var t=bn.length;return n.names?(bn[t]=n,n.names.forEach(function(i){Gn[i.toLowerCase()]=t}),this):(console.log(e),!0)}function Ep(n){if(!n)return!1;var e=n.toLowerCase();if(typeof Gn[e]!="undefined"&&bn[Gn[e]])return bn[Gn[e]]}function xp(){Mp.forEach(Do)}var Cp={start:xp,add:Do,get:Ep},D={};D.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};D.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};D.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"};D.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};D.airy={a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"};D.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};D.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};D.mod_airy={a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"};D.andrae={a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};D.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"};D.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};D.bessel={a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"};D.bess_nam={a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};D.clrk66={a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"};D.clrk80={a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."};D.clrk58={a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"};D.CPM={a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};D.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};D.engelis={a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"};D.evrst30={a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"};D.evrst48={a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"};D.evrst56={a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"};D.evrst69={a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"};D.evrstSS={a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"};D.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};D.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};D.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};D.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};D.hough={a:6378270,rf:297,ellipseName:"Hough"};D.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};D.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};D.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};D.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};D.new_intl={a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"};D.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};D.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};D.SEasia={a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"};D.walbeck={a:6376896,b:63558348467e-4,ellipseName:"Walbeck"};D.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"};D.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};D.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var Ip=D.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};D.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};function Op(n,e,t,i){var r=n*n,a=e*e,s=(r-a)/r,o=0;i?(n*=1-s*(Yv+s*(Vv+s*Kv)),r=n*n,s=0):o=Math.sqrt(s);var h=(r-a)/a;return{es:s,e:o,ep2:h}}function Rp(n,e,t,i,r){if(!n){var a=oe(D,i);a||(a=Ip),n=a.a,e=a.b,t=a.rf}return t&&!e&&(e=(1-1/t)*n),(t===0||Math.abs(n-e)<R)&&(r=!0,e=n),{a:n,b:e,rf:t,sphere:r}}var lt={};lt.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"};lt.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"};lt.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"};lt.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"};lt.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"};lt.potsdam={towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"};lt.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"};lt.hermannskogel={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"};lt.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"};lt.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"};lt.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"};lt.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"};lt.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"};lt.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"};lt.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"};lt.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"};lt.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"};function wp(n,e,t,i,r,a,s){var o={};return n===void 0||n==="none"?o.datum_type=ta:o.datum_type=Xv,e&&(o.datum_params=e.map(parseFloat),(o.datum_params[0]!==0||o.datum_params[1]!==0||o.datum_params[2]!==0)&&(o.datum_type=Te),o.datum_params.length>3&&(o.datum_params[3]!==0||o.datum_params[4]!==0||o.datum_params[5]!==0||o.datum_params[6]!==0)&&(o.datum_type=Pe,o.datum_params[3]*=Fi,o.datum_params[4]*=Fi,o.datum_params[5]*=Fi,o.datum_params[6]=o.datum_params[6]/1e6+1)),s&&(o.datum_type=Nn,o.grids=s),o.a=t,o.b=i,o.es=r,o.ep2=a,o}var Fo={};function Sp(n,e){var t=new DataView(e),i=Ap(t),r=Lp(t,i);r.nSubgrids>1&&console.log("Only single NTv2 subgrids are currently supported, subsequent sub grids are ignored");var a=Np(t,r,i),s={header:r,subgrids:a};return Fo[n]=s,s}function Tp(n){if(n===void 0)return null;var e=n.split(",");return e.map(Pp)}function Pp(n){if(n.length===0)return null;var e=n[0]==="@";return e&&(n=n.slice(1)),n==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:n,mandatory:!e,grid:Fo[n]||null,isNull:!1}}function Je(n){return n/3600*Math.PI/180}function Ap(n){var e=n.getInt32(8,!1);return e===11?!1:(e=n.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function Lp(n,e){return{nFields:n.getInt32(8,e),nSubgridFields:n.getInt32(24,e),nSubgrids:n.getInt32(40,e),shiftType:na(n,56,56+8).trim(),fromSemiMajorAxis:n.getFloat64(120,e),fromSemiMinorAxis:n.getFloat64(136,e),toSemiMajorAxis:n.getFloat64(152,e),toSemiMinorAxis:n.getFloat64(168,e)}}function na(n,e,t){return String.fromCharCode.apply(null,new Uint8Array(n.buffer.slice(e,t)))}function Np(n,e,t){for(var i=176,r=[],a=0;a<e.nSubgrids;a++){var s=Fp(n,i,t),o=Gp(n,i,s,t),h=Math.round(1+(s.upperLongitude-s.lowerLongitude)/s.longitudeInterval),l=Math.round(1+(s.upperLatitude-s.lowerLatitude)/s.latitudeInterval);r.push({ll:[Je(s.lowerLongitude),Je(s.lowerLatitude)],del:[Je(s.longitudeInterval),Je(s.latitudeInterval)],lim:[h,l],count:s.gridNodeCount,cvs:Dp(o)})}return r}function Dp(n){return n.map(function(e){return[Je(e.longitudeShift),Je(e.latitudeShift)]})}function Fp(n,e,t){return{name:na(n,e+8,e+16).trim(),parent:na(n,e+24,e+24+8).trim(),lowerLatitude:n.getFloat64(e+72,t),upperLatitude:n.getFloat64(e+88,t),lowerLongitude:n.getFloat64(e+104,t),upperLongitude:n.getFloat64(e+120,t),latitudeInterval:n.getFloat64(e+136,t),longitudeInterval:n.getFloat64(e+152,t),gridNodeCount:n.getInt32(e+168,t)}}function Gp(n,e,t,i){for(var r=e+176,a=16,s=[],o=0;o<t.gridNodeCount;o++){var h={latitudeShift:n.getFloat32(r+o*a,i),longitudeShift:n.getFloat32(r+o*a+4,i),latitudeAccuracy:n.getFloat32(r+o*a+8,i),longitudeAccuracy:n.getFloat32(r+o*a+12,i)};s.push(h)}return s}function kt(n,e){if(!(this instanceof kt))return new kt(n);e=e||function(l){if(l)throw l};var t=fp(n);if(typeof t!="object"){e(n);return}var i=kt.projections.get(t.projName);if(!i){e(n);return}if(t.datumCode&&t.datumCode!=="none"){var r=oe(lt,t.datumCode);r&&(t.datum_params=t.datum_params||(r.towgs84?r.towgs84.split(","):null),t.ellps=r.ellipse,t.datumName=r.datumName?r.datumName:t.datumCode)}t.k0=t.k0||1,t.axis=t.axis||"enu",t.ellps=t.ellps||"wgs84",t.lat1=t.lat1||t.lat0;var a=Rp(t.a,t.b,t.rf,t.ellps,t.sphere),s=Op(a.a,a.b,a.rf,t.R_A),o=Tp(t.nadgrids),h=t.datum||wp(t.datumCode,t.datum_params,a.a,a.b,s.es,s.ep2,o);Lo(this,t),Lo(this,i),this.a=a.a,this.b=a.b,this.rf=a.rf,this.sphere=a.sphere,this.es=s.es,this.e=s.e,this.ep2=s.ep2,this.datum=h,this.init(),e(null,this)}kt.projections=Cp;kt.projections.start();function bp(n,e){return n.datum_type!==e.datum_type||n.a!==e.a||Math.abs(n.es-e.es)>5e-11?!1:n.datum_type===Te?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]:n.datum_type===Pe?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]&&n.datum_params[3]===e.datum_params[3]&&n.datum_params[4]===e.datum_params[4]&&n.datum_params[5]===e.datum_params[5]&&n.datum_params[6]===e.datum_params[6]:!0}function Go(n,e,t){var i=n.x,r=n.y,a=n.z?n.z:0,s,o,h,l;if(r<-x&&r>-1.001*x)r=-x;else if(r>x&&r<1.001*x)r=x;else{if(r<-x)return{x:-1/0,y:-1/0,z:n.z};if(r>x)return{x:1/0,y:1/0,z:n.z}}return i>Math.PI&&(i-=2*Math.PI),o=Math.sin(r),l=Math.cos(r),h=o*o,s=t/Math.sqrt(1-e*h),{x:(s+a)*l*Math.cos(i),y:(s+a)*l*Math.sin(i),z:(s*(1-e)+a)*o}}function bo(n,e,t,i){var r=1e-12,a=r*r,s=30,o,h,l,u,f,c,d,v,p,_,y,g,m,M=n.x,E=n.y,C=n.z?n.z:0,S,O,P;if(o=Math.sqrt(M*M+E*E),h=Math.sqrt(M*M+E*E+C*C),o/t<r){if(S=0,h/t<r)return O=x,P=-i,{x:n.x,y:n.y,z:n.z}}else S=Math.atan2(E,M);l=C/h,u=o/h,f=1/Math.sqrt(1-e*(2-e)*u*u),v=u*(1-e)*f,p=l*f,m=0;do m++,d=t/Math.sqrt(1-e*p*p),P=o*v+C*p-d*(1-e*p*p),c=e*d/(d+P),f=1/Math.sqrt(1-c*(2-c)*u*u),_=u*(1-c)*f,y=l*f,g=y*v-_*p,v=_,p=y;while(g*g>a&&m<s);return O=Math.atan(y/Math.abs(_)),{x:S,y:O,z:P}}function kp(n,e,t){if(e===Te)return{x:n.x+t[0],y:n.y+t[1],z:n.z+t[2]};if(e===Pe){var i=t[0],r=t[1],a=t[2],s=t[3],o=t[4],h=t[5],l=t[6];return{x:l*(n.x-h*n.y+o*n.z)+i,y:l*(h*n.x+n.y-s*n.z)+r,z:l*(-o*n.x+s*n.y+n.z)+a}}}function Bp(n,e,t){if(e===Te)return{x:n.x-t[0],y:n.y-t[1],z:n.z-t[2]};if(e===Pe){var i=t[0],r=t[1],a=t[2],s=t[3],o=t[4],h=t[5],l=t[6],u=(n.x-i)/l,f=(n.y-r)/l,c=(n.z-a)/l;return{x:u+h*f-o*c,y:-h*u+f+s*c,z:o*u-s*f+c}}}function kn(n){return n===Te||n===Pe}function jp(n,e,t){if(bp(n,e)||n.datum_type===ta||e.datum_type===ta)return t;var i=n.a,r=n.es;if(n.datum_type===Nn){var a=ko(n,!1,t);if(a!==0)return;i=Co,r=Io}var s=e.a,o=e.b,h=e.es;if(e.datum_type===Nn&&(s=Co,o=Wv,h=Io),r===h&&i===s&&!kn(n.datum_type)&&!kn(e.datum_type))return t;if(t=Go(t,r,i),kn(n.datum_type)&&(t=kp(t,n.datum_type,n.datum_params)),kn(e.datum_type)&&(t=Bp(t,e.datum_type,e.datum_params)),t=bo(t,h,s,o),e.datum_type===Nn){var l=ko(e,!0,t);if(l!==0)return}return t}function ko(n,e,t){if(n.grids===null||n.grids.length===0)return console.log("Grid shift grids not found"),-1;for(var i={x:-t.x,y:t.y},r={x:Number.NaN,y:Number.NaN},a=[],s=0;s<n.grids.length;s++){var o=n.grids[s];if(a.push(o.name),o.isNull){r=i;break}if(o.grid===null){if(o.mandatory)return console.log("Unable to find mandatory grid '"+o.name+"'"),-1;continue}var h=o.grid.subgrids[0],l=(Math.abs(h.del[1])+Math.abs(h.del[0]))/1e4,u=h.ll[0]-l,f=h.ll[1]-l,c=h.ll[0]+(h.lim[0]-1)*h.del[0]+l,d=h.ll[1]+(h.lim[1]-1)*h.del[1]+l;if(!(f>i.y||u>i.x||d<i.y||c<i.x)&&(r=$p(i,e,h),!isNaN(r.x)))break}return isNaN(r.x)?(console.log("Failed to find a grid shift table for location '"+-i.x*Gt+" "+i.y*Gt+" tried: '"+a+"'"),-1):(t.x=-r.x,t.y=r.y,0)}function $p(n,e,t){var i={x:Number.NaN,y:Number.NaN};if(isNaN(n.x))return i;var r={x:n.x,y:n.y};r.x-=t.ll[0],r.y-=t.ll[1],r.x=w(r.x-Math.PI)+Math.PI;var a=Bo(r,t);if(e){if(isNaN(a.x))return i;a.x=r.x-a.x,a.y=r.y-a.y;var s=9,o=1e-12,h,l;do{if(l=Bo(a,t),isNaN(l.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}h={x:r.x-(l.x+a.x),y:r.y-(l.y+a.y)},a.x+=h.x,a.y+=h.y}while(s--&&Math.abs(h.x)>o&&Math.abs(h.y)>o);if(s<0)return console.log("Inverse grid shift iterator failed to converge."),i;i.x=w(a.x+t.ll[0]),i.y=a.y+t.ll[1]}else isNaN(a.x)||(i.x=n.x+a.x,i.y=n.y+a.y);return i}function Bo(n,e){var t={x:n.x/e.del[0],y:n.y/e.del[1]},i={x:Math.floor(t.x),y:Math.floor(t.y)},r={x:t.x-1*i.x,y:t.y-1*i.y},a={x:Number.NaN,y:Number.NaN},s;if(i.x<0||i.x>=e.lim[0]||i.y<0||i.y>=e.lim[1])return a;s=i.y*e.lim[0]+i.x;var o={x:e.cvs[s][0],y:e.cvs[s][1]};s++;var h={x:e.cvs[s][0],y:e.cvs[s][1]};s+=e.lim[0];var l={x:e.cvs[s][0],y:e.cvs[s][1]};s--;var u={x:e.cvs[s][0],y:e.cvs[s][1]},f=r.x*r.y,c=r.x*(1-r.y),d=(1-r.x)*(1-r.y),v=(1-r.x)*r.y;return a.x=d*o.x+c*h.x+v*u.x+f*l.x,a.y=d*o.y+c*h.y+v*u.y+f*l.y,a}function jo(n,e,t){var i=t.x,r=t.y,a=t.z||0,s,o,h,l={};for(h=0;h<3;h++)if(!(e&&h===2&&t.z===void 0))switch(h===0?(s=i,"ew".indexOf(n.axis[h])!==-1?o="x":o="y"):h===1?(s=r,"ns".indexOf(n.axis[h])!==-1?o="y":o="x"):(s=a,o="z"),n.axis[h]){case"e":l[o]=s;break;case"w":l[o]=-s;break;case"n":l[o]=s;break;case"s":l[o]=-s;break;case"u":t[o]!==void 0&&(l.z=s);break;case"d":t[o]!==void 0&&(l.z=-s);break;default:return null}return l}function $o(n){var e={x:n[0],y:n[1]};return n.length>2&&(e.z=n[2]),n.length>3&&(e.m=n[3]),e}function Up(n){Uo(n.x),Uo(n.y)}function Uo(n){if(typeof Number.isFinite=="function"){if(Number.isFinite(n))return;throw new TypeError("coordinates must be finite numbers")}if(typeof n!="number"||n!==n||!isFinite(n))throw new TypeError("coordinates must be finite numbers")}function zp(n,e){return(n.datum.datum_type===Te||n.datum.datum_type===Pe)&&e.datumCode!=="WGS84"||(e.datum.datum_type===Te||e.datum.datum_type===Pe)&&n.datumCode!=="WGS84"}function Bn(n,e,t,i){var r;if(Array.isArray(t)&&(t=$o(t)),Up(t),n.datum&&e.datum&&zp(n,e)&&(r=new kt("WGS84"),t=Bn(n,r,t,i),n=r),i&&n.axis!=="enu"&&(t=jo(n,!1,t)),n.projName==="longlat")t={x:t.x*ft,y:t.y*ft,z:t.z||0};else if(n.to_meter&&(t={x:t.x*n.to_meter,y:t.y*n.to_meter,z:t.z||0}),t=n.inverse(t),!t)return;if(n.from_greenwich&&(t.x+=n.from_greenwich),t=jp(n.datum,e.datum,t),!!t)return e.from_greenwich&&(t={x:t.x-e.from_greenwich,y:t.y,z:t.z||0}),e.projName==="longlat"?t={x:t.x*Gt,y:t.y*Gt,z:t.z||0}:(t=e.forward(t),e.to_meter&&(t={x:t.x/e.to_meter,y:t.y/e.to_meter,z:t.z||0})),i&&e.axis!=="enu"?jo(e,!0,t):t}var zo=kt("WGS84");function ra(n,e,t,i){var r,a,s;return Array.isArray(t)?(r=Bn(n,e,t,i)||{x:NaN,y:NaN},t.length>2?typeof n.name!="undefined"&&n.name==="geocent"||typeof e.name!="undefined"&&e.name==="geocent"?typeof r.z=="number"?[r.x,r.y,r.z].concat(t.splice(3)):[r.x,r.y,t[2]].concat(t.splice(3)):[r.x,r.y].concat(t.splice(2)):[r.x,r.y]):(a=Bn(n,e,t,i),s=Object.keys(t),s.length===2||s.forEach(function(o){if(typeof n.name!="undefined"&&n.name==="geocent"||typeof e.name!="undefined"&&e.name==="geocent"){if(o==="x"||o==="y"||o==="z")return}else if(o==="x"||o==="y")return;a[o]=t[o]}),a)}function Xo(n){return n instanceof kt?n:n.oProj?n.oProj:kt(n)}function wt(n,e,t){n=Xo(n);var i=!1,r;return typeof e=="undefined"?(e=n,n=zo,i=!0):(typeof e.x!="undefined"||Array.isArray(e))&&(t=e,e=n,n=zo,i=!0),e=Xo(e),t?ra(n,e,t):(r={forward:function(a,s){return ra(n,e,a,s)},inverse:function(a,s){return ra(e,n,a,s)}},i&&(r.oProj=e),r)}var Wo=6,Yo="AJSAJS",Vo="AFAFAF",Qe=65,Et=73,St=79,ji=86,$i=90,Xp={forward:Ko,inverse:Wp,toPoint:qo};function Ko(n,e){return e=e||5,Kp(Yp({lat:n[1],lon:n[0]}),e)}function Wp(n){var e=sa(Jo(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function qo(n){var e=sa(Jo(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function aa(n){return n*(Math.PI/180)}function Ho(n){return 180*(n/Math.PI)}function Yp(n){var e=n.lat,t=n.lon,i=6378137,r=.00669438,a=.9996,s,o,h,l,u,f,c,d=aa(e),v=aa(t),p,_;_=Math.floor((t+180)/6)+1,t===180&&(_=60),e>=56&&e<64&&t>=3&&t<12&&(_=32),e>=72&&e<84&&(t>=0&&t<9?_=31:t>=9&&t<21?_=33:t>=21&&t<33?_=35:t>=33&&t<42&&(_=37)),s=(_-1)*6-180+3,p=aa(s),o=r/(1-r),h=i/Math.sqrt(1-r*Math.sin(d)*Math.sin(d)),l=Math.tan(d)*Math.tan(d),u=o*Math.cos(d)*Math.cos(d),f=Math.cos(d)*(v-p),c=i*((1-r/4-3*r*r/64-5*r*r*r/256)*d-(3*r/8+3*r*r/32+45*r*r*r/1024)*Math.sin(2*d)+(15*r*r/256+45*r*r*r/1024)*Math.sin(4*d)-35*r*r*r/3072*Math.sin(6*d));var y=a*h*(f+(1-l+u)*f*f*f/6+(5-18*l+l*l+72*u-58*o)*f*f*f*f*f/120)+5e5,g=a*(c+h*Math.tan(d)*(f*f/2+(5-l+9*u+4*u*u)*f*f*f*f/24+(61-58*l+l*l+600*u-330*o)*f*f*f*f*f*f/720));return e<0&&(g+=1e7),{northing:Math.round(g),easting:Math.round(y),zoneNumber:_,zoneLetter:Vp(e)}}function sa(n){var e=n.northing,t=n.easting,i=n.zoneLetter,r=n.zoneNumber;if(r<0||r>60)return null;var a=.9996,s=6378137,o=.00669438,h,l=(1-Math.sqrt(1-o))/(1+Math.sqrt(1-o)),u,f,c,d,v,p,_,y,g,m=t-5e5,M=e;i<"N"&&(M-=1e7),_=(r-1)*6-180+3,h=o/(1-o),p=M/a,y=p/(s*(1-o/4-3*o*o/64-5*o*o*o/256)),g=y+(3*l/2-27*l*l*l/32)*Math.sin(2*y)+(21*l*l/16-55*l*l*l*l/32)*Math.sin(4*y)+151*l*l*l/96*Math.sin(6*y),u=s/Math.sqrt(1-o*Math.sin(g)*Math.sin(g)),f=Math.tan(g)*Math.tan(g),c=h*Math.cos(g)*Math.cos(g),d=s*(1-o)/Math.pow(1-o*Math.sin(g)*Math.sin(g),1.5),v=m/(u*a);var E=g-u*Math.tan(g)/d*(v*v/2-(5+3*f+10*c-4*c*c-9*h)*v*v*v*v/24+(61+90*f+298*c+45*f*f-252*h-3*c*c)*v*v*v*v*v*v/720);E=Ho(E);var C=(v-(1+2*f+c)*v*v*v/6+(5-2*c+28*f-3*c*c+8*h+24*f*f)*v*v*v*v*v/120)/Math.cos(g);C=_+Ho(C);var S;if(n.accuracy){var O=sa({northing:n.northing+n.accuracy,easting:n.easting+n.accuracy,zoneLetter:n.zoneLetter,zoneNumber:n.zoneNumber});S={top:O.lat,right:O.lon,bottom:E,left:C}}else S={lat:E,lon:C};return S}function Vp(n){var e="Z";return 84>=n&&n>=72?e="X":72>n&&n>=64?e="W":64>n&&n>=56?e="V":56>n&&n>=48?e="U":48>n&&n>=40?e="T":40>n&&n>=32?e="S":32>n&&n>=24?e="R":24>n&&n>=16?e="Q":16>n&&n>=8?e="P":8>n&&n>=0?e="N":0>n&&n>=-8?e="M":-8>n&&n>=-16?e="L":-16>n&&n>=-24?e="K":-24>n&&n>=-32?e="J":-32>n&&n>=-40?e="H":-40>n&&n>=-48?e="G":-48>n&&n>=-56?e="F":-56>n&&n>=-64?e="E":-64>n&&n>=-72?e="D":-72>n&&n>=-80&&(e="C"),e}function Kp(n,e){var t="00000"+n.easting,i="00000"+n.northing;return n.zoneNumber+n.zoneLetter+qp(n.easting,n.northing,n.zoneNumber)+t.substr(t.length-5,e)+i.substr(i.length-5,e)}function qp(n,e,t){var i=Zo(t),r=Math.floor(n/1e5),a=Math.floor(e/1e5)%20;return Hp(r,a,i)}function Zo(n){var e=n%Wo;return e===0&&(e=Wo),e}function Hp(n,e,t){var i=t-1,r=Yo.charCodeAt(i),a=Vo.charCodeAt(i),s=r+n-1,o=a+e,h=!1;s>$i&&(s=s-$i+Qe-1,h=!0),(s===Et||r<Et&&s>Et||(s>Et||r<Et)&&h)&&s++,(s===St||r<St&&s>St||(s>St||r<St)&&h)&&(s++,s===Et&&s++),s>$i&&(s=s-$i+Qe-1),o>ji?(o=o-ji+Qe-1,h=!0):h=!1,(o===Et||a<Et&&o>Et||(o>Et||a<Et)&&h)&&o++,(o===St||a<St&&o>St||(o>St||a<St)&&h)&&(o++,o===Et&&o++),o>ji&&(o=o-ji+Qe-1);var l=String.fromCharCode(s)+String.fromCharCode(o);return l}function Jo(n){if(n&&n.length===0)throw"MGRSPoint coverting from nothing";for(var e=n.length,t=null,i="",r,a=0;!/[A-Z]/.test(r=n.charAt(a));){if(a>=2)throw"MGRSPoint bad conversion from: "+n;i+=r,a++}var s=parseInt(i,10);if(a===0||a+3>e)throw"MGRSPoint bad conversion from: "+n;var o=n.charAt(a++);if(o<="A"||o==="B"||o==="Y"||o>="Z"||o==="I"||o==="O")throw"MGRSPoint zone letter "+o+" not handled: "+n;t=n.substring(a,a+=2);for(var h=Zo(s),l=Zp(t.charAt(0),h),u=Jp(t.charAt(1),h);u<Qp(o);)u+=2e6;var f=e-a;if(f%2!=0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+n;var c=f/2,d=0,v=0,p,_,y,g,m;return c>0&&(p=1e5/Math.pow(10,c),_=n.substring(a,a+c),d=parseFloat(_)*p,y=n.substring(a+c),v=parseFloat(y)*p),g=d+l,m=v+u,{easting:g,northing:m,zoneLetter:o,zoneNumber:s,accuracy:p}}function Zp(n,e){for(var t=Yo.charCodeAt(e-1),i=1e5,r=!1;t!==n.charCodeAt(0);){if(t++,t===Et&&t++,t===St&&t++,t>$i){if(r)throw"Bad character: "+n;t=Qe,r=!0}i+=1e5}return i}function Jp(n,e){if(n>"V")throw"MGRSPoint given invalid Northing "+n;for(var t=Vo.charCodeAt(e-1),i=0,r=!1;t!==n.charCodeAt(0);){if(t++,t===Et&&t++,t===St&&t++,t>ji){if(r)throw"Bad character: "+n;t=Qe,r=!0}i+=1e5}return i}function Qp(n){var e;switch(n){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+n}function ti(n,e,t){if(!(this instanceof ti))return new ti(n,e,t);if(Array.isArray(n))this.x=n[0],this.y=n[1],this.z=n[2]||0;else if(typeof n=="object")this.x=n.x,this.y=n.y,this.z=n.z||0;else if(typeof n=="string"&&typeof e=="undefined"){var i=n.split(",");this.x=parseFloat(i[0],10),this.y=parseFloat(i[1],10),this.z=parseFloat(i[2],10)||0}else this.x=n,this.y=e,this.z=t||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}ti.fromMGRS=function(n){return new ti(qo(n))};ti.prototype.toMGRS=function(n){return Ko([this.x,this.y],n)};var t_=1,e_=.25,Qo=.046875,th=.01953125,eh=.01068115234375,i_=.75,n_=.46875,r_=.013020833333333334,a_=.007120768229166667,s_=.3645833333333333,o_=.005696614583333333,h_=.3076171875;function ih(n){var e=[];e[0]=t_-n*(e_+n*(Qo+n*(th+n*eh))),e[1]=n*(i_-n*(Qo+n*(th+n*eh)));var t=n*n;return e[2]=t*(n_-n*(r_+n*a_)),t*=n,e[3]=t*(s_-n*o_),e[4]=t*n*h_,e}function jn(n,e,t,i){return t*=e,e*=e,i[0]*n-t*(i[1]+e*(i[2]+e*(i[3]+e*i[4])))}var l_=20;function nh(n,e,t){for(var i=1/(1-e),r=n,a=l_;a;--a){var s=Math.sin(r),o=1-e*s*s;if(o=(jn(r,s,Math.cos(r),t)-n)*(o*Math.sqrt(o))*i,r-=o,Math.abs(o)<R)return r}return r}function u_(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=ih(this.es),this.ml0=jn(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function f_(n){var e=n.x,t=n.y,i=w(e-this.long0),r,a,s,o=Math.sin(t),h=Math.cos(t);if(this.es){var u=h*i,f=Math.pow(u,2),c=this.ep2*Math.pow(h,2),d=Math.pow(c,2),v=Math.abs(h)>R?Math.tan(t):0,p=Math.pow(v,2),_=Math.pow(p,2);r=1-this.es*Math.pow(o,2),u=u/Math.sqrt(r);var y=jn(t,o,h,this.en);a=this.a*(this.k0*u*(1+f/6*(1-p+c+f/20*(5-18*p+_+14*c-58*p*c+f/42*(61+179*_-_*p-479*p)))))+this.x0,s=this.a*(this.k0*(y-this.ml0+o*i*u/2*(1+f/12*(5-p+9*c+4*d+f/30*(61+_-58*p+270*c-330*p*c+f/56*(1385+543*_-_*p-3111*p))))))+this.y0}else{var l=h*Math.sin(i);if(Math.abs(Math.abs(l)-1)<R)return 93;if(a=.5*this.a*this.k0*Math.log((1+l)/(1-l))+this.x0,s=h*Math.cos(i)/Math.sqrt(1-Math.pow(l,2)),l=Math.abs(s),l>=1){if(l-1>R)return 93;s=0}else s=Math.acos(s);t<0&&(s=-s),s=this.a*this.k0*(s-this.lat0)+this.y0}return n.x=a,n.y=s,n}function c_(n){var e,t,i,r,a=(n.x-this.x0)*(1/this.a),s=(n.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+s/this.k0,t=nh(e,this.es,this.en),Math.abs(t)<x){var f=Math.sin(t),c=Math.cos(t),d=Math.abs(c)>R?Math.tan(t):0,v=this.ep2*Math.pow(c,2),p=Math.pow(v,2),_=Math.pow(d,2),y=Math.pow(_,2);e=1-this.es*Math.pow(f,2);var g=a*Math.sqrt(e)/this.k0,m=Math.pow(g,2);e=e*d,i=t-e*m/(1-this.es)*.5*(1-m/12*(5+3*_-9*v*_+v-4*p-m/30*(61+90*_-252*v*_+45*y+46*v-m/56*(1385+3633*_+4095*y+1574*y*_)))),r=w(this.long0+g*(1-m/6*(1+2*_+v-m/20*(5+28*_+24*y+8*v*_+6*v-m/42*(61+662*_+1320*y+720*y*_))))/c)}else i=x*ki(s),r=0;else{var o=Math.exp(a/this.k0),h=.5*(o-1/o),l=this.lat0+s/this.k0,u=Math.cos(l);e=Math.sqrt((1-Math.pow(u,2))/(1+Math.pow(h,2))),i=Math.asin(e),s<0&&(i=-i),h===0&&u===0?r=0:r=w(Math.atan2(h,u)+this.long0)}return n.x=r,n.y=i,n}var d_=["Fast_Transverse_Mercator","Fast Transverse Mercator"],$n={init:u_,forward:f_,inverse:c_,names:d_};function rh(n){var e=Math.exp(n);return e=(e-1/e)/2,e}function Un(n,e){n=Math.abs(n),e=Math.abs(e);var t=Math.max(n,e),i=Math.min(n,e)/(t||1);return t*Math.sqrt(1+Math.pow(i,2))}function v_(n){var e=1+n,t=e-1;return t===0?n:n*Math.log(e)/t}function p_(n){var e=Math.abs(n);return e=v_(e*(1+e/(Un(1,e)+1))),n<0?-e:e}function oa(n,e){for(var t=2*Math.cos(2*e),i=n.length-1,r=n[i],a=0,s;--i>=0;)s=-a+t*r+n[i],a=r,r=s;return e+s*Math.sin(2*e)}function __(n,e){for(var t=2*Math.cos(e),i=n.length-1,r=n[i],a=0,s;--i>=0;)s=-a+t*r+n[i],a=r,r=s;return Math.sin(e)*s}function g_(n){var e=Math.exp(n);return e=(e+1/e)/2,e}function ah(n,e,t){for(var i=Math.sin(e),r=Math.cos(e),a=rh(t),s=g_(t),o=2*r*s,h=-2*i*a,l=n.length-1,u=n[l],f=0,c=0,d=0,v,p;--l>=0;)v=c,p=f,c=u,f=d,u=-v+o*c-h*f+n[l],d=-p+h*c+o*f;return o=i*s,h=r*a,[o*u-h*d,o*d+h*u]}function y_(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&($n.init.apply(this),this.forward=$n.forward,this.inverse=$n.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var n=this.es/(1+Math.sqrt(1-this.es)),e=n/(2-n),t=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),t=t*e,this.cgb[1]=t*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=t*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),t=t*e,this.cgb[2]=t*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=t*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),t=t*e,this.cgb[3]=t*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=t*(1237/630+e*(-12/5+e*(-24832/14175))),t=t*e,this.cgb[4]=t*(4174/315+e*(-144838/6237)),this.cbg[4]=t*(-734/315+e*(109598/31185)),t=t*e,this.cgb[5]=t*(601676/22275),this.cbg[5]=t*(444337/155925),t=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+t*(1/4+t*(1/64+t/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=t*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=t*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),t=t*e,this.utg[2]=t*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=t*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),t=t*e,this.utg[3]=t*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=t*(49561/161280+e*(-179/168+e*(6601661/7257600))),t=t*e,this.utg[4]=t*(-4583/161280+e*(108847/3991680)),this.gtu[4]=t*(34729/80640+e*(-3418889/1995840)),t=t*e,this.utg[5]=t*(-20648693/638668800),this.gtu[5]=t*(212378941/319334400);var i=oa(this.cbg,this.lat0);this.Zb=-this.Qn*(i+__(this.gtu,2*i))}function m_(n){var e=w(n.x-this.long0),t=n.y;t=oa(this.cbg,t);var i=Math.sin(t),r=Math.cos(t),a=Math.sin(e),s=Math.cos(e);t=Math.atan2(i,s*r),e=Math.atan2(a*r,Un(i,r*s)),e=p_(Math.tan(e));var o=ah(this.gtu,2*t,2*e);t=t+o[0],e=e+o[1];var h,l;return Math.abs(e)<=2.623395162778?(h=this.a*(this.Qn*e)+this.x0,l=this.a*(this.Qn*t+this.Zb)+this.y0):(h=1/0,l=1/0),n.x=h,n.y=l,n}function M_(n){var e=(n.x-this.x0)*(1/this.a),t=(n.y-this.y0)*(1/this.a);t=(t-this.Zb)/this.Qn,e=e/this.Qn;var i,r;if(Math.abs(e)<=2.623395162778){var a=ah(this.utg,2*t,2*e);t=t+a[0],e=e+a[1],e=Math.atan(rh(e));var s=Math.sin(t),o=Math.cos(t),h=Math.sin(e),l=Math.cos(e);t=Math.atan2(s*l,Un(h,l*o)),e=Math.atan2(h,l*o),i=w(e+this.long0),r=oa(this.cgb,t)}else i=1/0,r=1/0;return n.x=i,n.y=r,n}var E_=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","tmerc"],zn={init:y_,forward:m_,inverse:M_,names:E_};function x_(n,e){if(n===void 0){if(n=Math.floor((w(e)+Math.PI)*30/Math.PI)+1,n<0)return 0;if(n>60)return 60}return n}var C_="etmerc";function I_(){var n=x_(this.zone,this.long0);if(n===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(n)-183)*ft,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,zn.init.apply(this),this.forward=zn.forward,this.inverse=zn.inverse}var O_=["Universal Transverse Mercator System","utm"],R_={init:I_,names:O_,dependsOn:C_};function ha(n,e){return Math.pow((1-n)/(1+n),e)}var w_=20;function S_(){var n=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*n*n),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(n/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+j)/(Math.pow(Math.tan(.5*this.lat0+j),this.C)*ha(this.e*n,this.ratexp))}function T_(n){var e=n.x,t=n.y;return n.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*t+j),this.C)*ha(this.e*Math.sin(t),this.ratexp))-x,n.x=this.C*e,n}function P_(n){for(var e=1e-14,t=n.x/this.C,i=n.y,r=Math.pow(Math.tan(.5*i+j)/this.K,1/this.C),a=w_;a>0&&(i=2*Math.atan(r*ha(this.e*Math.sin(n.y),-.5*this.e))-x,!(Math.abs(i-n.y)<e));--a)n.y=i;return a?(n.x=t,n.y=i,n):null}var A_=["gauss"],la={init:S_,forward:T_,inverse:P_,names:A_};function L_(){la.init.apply(this),!!this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function N_(n){var e,t,i,r;return n.x=w(n.x-this.long0),la.forward.apply(this,[n]),e=Math.sin(n.y),t=Math.cos(n.y),i=Math.cos(n.x),r=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*t*i),n.x=r*t*Math.sin(n.x),n.y=r*(this.cosc0*e-this.sinc0*t*i),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function D_(n){var e,t,i,r,a;if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,a=Math.sqrt(n.x*n.x+n.y*n.y)){var s=2*Math.atan2(a,this.R2);e=Math.sin(s),t=Math.cos(s),r=Math.asin(t*this.sinc0+n.y*e*this.cosc0/a),i=Math.atan2(n.x*e,a*this.cosc0*t-n.y*this.sinc0*e)}else r=this.phic0,i=0;return n.x=i,n.y=r,la.inverse.apply(this,[n]),n.x=w(n.x+this.long0),n}var F_=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"],G_={init:L_,forward:N_,inverse:D_,names:F_};function b_(n,e,t){return e*=t,Math.tan(.5*(x+n))*Math.pow((1-e)/(1+e),.5*t)}function k_(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=R&&(this.k0=.5*(1+ki(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=R&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=R&&(this.k0=.5*this.cons*bt(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Tt(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=bt(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-x,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function B_(n){var e=n.x,t=n.y,i=Math.sin(t),r=Math.cos(t),a,s,o,h,l,u,f=w(e-this.long0);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=R&&Math.abs(t+this.lat0)<=R?(n.x=NaN,n.y=NaN,n):this.sphere?(a=2*this.k0/(1+this.sinlat0*i+this.coslat0*r*Math.cos(f)),n.x=this.a*a*r*Math.sin(f)+this.x0,n.y=this.a*a*(this.coslat0*i-this.sinlat0*r*Math.cos(f))+this.y0,n):(s=2*Math.atan(this.ssfn_(t,i,this.e))-x,h=Math.cos(s),o=Math.sin(s),Math.abs(this.coslat0)<=R?(l=Tt(this.e,t*this.con,this.con*i),u=2*this.a*this.k0*l/this.cons,n.x=this.x0+u*Math.sin(e-this.long0),n.y=this.y0-this.con*u*Math.cos(e-this.long0),n):(Math.abs(this.sinlat0)<R?(a=2*this.a*this.k0/(1+h*Math.cos(f)),n.y=a*o):(a=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*o+this.cosX0*h*Math.cos(f))),n.y=a*(this.cosX0*o-this.sinX0*h*Math.cos(f))+this.y0),n.x=a*h*Math.sin(f)+this.x0,n))}function j_(n){n.x-=this.x0,n.y-=this.y0;var e,t,i,r,a,s=Math.sqrt(n.x*n.x+n.y*n.y);if(this.sphere){var o=2*Math.atan(s/(2*this.a*this.k0));return e=this.long0,t=this.lat0,s<=R?(n.x=e,n.y=t,n):(t=Math.asin(Math.cos(o)*this.sinlat0+n.y*Math.sin(o)*this.coslat0/s),Math.abs(this.coslat0)<R?this.lat0>0?e=w(this.long0+Math.atan2(n.x,-1*n.y)):e=w(this.long0+Math.atan2(n.x,n.y)):e=w(this.long0+Math.atan2(n.x*Math.sin(o),s*this.coslat0*Math.cos(o)-n.y*this.sinlat0*Math.sin(o))),n.x=e,n.y=t,n)}else if(Math.abs(this.coslat0)<=R){if(s<=R)return t=this.lat0,e=this.long0,n.x=e,n.y=t,n;n.x*=this.con,n.y*=this.con,i=s*this.cons/(2*this.a*this.k0),t=this.con*Bi(this.e,i),e=this.con*w(this.con*this.long0+Math.atan2(n.x,-1*n.y))}else r=2*Math.atan(s*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,s<=R?a=this.X0:(a=Math.asin(Math.cos(r)*this.sinX0+n.y*Math.sin(r)*this.cosX0/s),e=w(this.long0+Math.atan2(n.x*Math.sin(r),s*this.cosX0*Math.cos(r)-n.y*this.sinX0*Math.sin(r)))),t=-1*Bi(this.e,Math.tan(.5*(x+a)));return n.x=e,n.y=t,n}var $_=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],U_={init:k_,forward:B_,inverse:j_,names:$_,ssfn_:b_};function z_(){var n=this.lat0;this.lambda0=this.long0;var e=Math.sin(n),t=this.a,i=this.rf,r=1/i,a=2*r-Math.pow(r,2),s=this.e=Math.sqrt(a);this.R=this.k0*t*Math.sqrt(1-a)/(1-a*Math.pow(e,2)),this.alpha=Math.sqrt(1+a/(1-a)*Math.pow(Math.cos(n),4)),this.b0=Math.asin(e/this.alpha);var o=Math.log(Math.tan(Math.PI/4+this.b0/2)),h=Math.log(Math.tan(Math.PI/4+n/2)),l=Math.log((1+s*e)/(1-s*e));this.K=o-this.alpha*h+this.alpha*s/2*l}function X_(n){var e=Math.log(Math.tan(Math.PI/4-n.y/2)),t=this.e/2*Math.log((1+this.e*Math.sin(n.y))/(1-this.e*Math.sin(n.y))),i=-this.alpha*(e+t)+this.K,r=2*(Math.atan(Math.exp(i))-Math.PI/4),a=this.alpha*(n.x-this.lambda0),s=Math.atan(Math.sin(a)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(a))),o=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(a));return n.y=this.R/2*Math.log((1+Math.sin(o))/(1-Math.sin(o)))+this.y0,n.x=this.R*s+this.x0,n}function W_(n){for(var e=n.x-this.x0,t=n.y-this.y0,i=e/this.R,r=2*(Math.atan(Math.exp(t/this.R))-Math.PI/4),a=Math.asin(Math.cos(this.b0)*Math.sin(r)+Math.sin(this.b0)*Math.cos(r)*Math.cos(i)),s=Math.atan(Math.sin(i)/(Math.cos(this.b0)*Math.cos(i)-Math.sin(this.b0)*Math.tan(r))),o=this.lambda0+s/this.alpha,h=0,l=a,u=-1e3,f=0;Math.abs(l-u)>1e-7;){if(++f>20)return;h=1/this.alpha*(Math.log(Math.tan(Math.PI/4+a/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(l))/2)),u=l,l=2*Math.atan(Math.exp(h))-Math.PI/2}return n.x=o,n.y=l,n}var Y_=["somerc"],V_={init:z_,forward:X_,inverse:W_,names:Y_},ei=1e-7;function K_(n){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],t=typeof n.PROJECTION=="object"?Object.keys(n.PROJECTION)[0]:n.PROJECTION;return"no_uoff"in n||"no_off"in n||e.indexOf(t)!==-1}function q_(){var n,e,t,i,r,a,s,o,h,l,u=0,f,c=0,d=0,v=0,p=0,_=0,y=0;this.no_off=K_(this),this.no_rot="no_rot"in this;var g=!1;"alpha"in this&&(g=!0);var m=!1;if("rectified_grid_angle"in this&&(m=!0),g&&(y=this.alpha),m&&(u=this.rectified_grid_angle*ft),g||m)c=this.longc;else if(d=this.long1,p=this.lat1,v=this.long2,_=this.lat2,Math.abs(p-_)<=ei||(n=Math.abs(p))<=ei||Math.abs(n-x)<=ei||Math.abs(Math.abs(this.lat0)-x)<=ei||Math.abs(Math.abs(_)-x)<=ei)throw new Error;var M=1-this.es;e=Math.sqrt(M),Math.abs(this.lat0)>R?(o=Math.sin(this.lat0),t=Math.cos(this.lat0),n=1-this.es*o*o,this.B=t*t,this.B=Math.sqrt(1+this.es*this.B*this.B/M),this.A=this.B*this.k0*e/n,i=this.B*e/(t*Math.sqrt(n)),r=i*i-1,r<=0?r=0:(r=Math.sqrt(r),this.lat0<0&&(r=-r)),this.E=r+=i,this.E*=Math.pow(Tt(this.e,this.lat0,o),this.B)):(this.B=1/e,this.A=this.k0,this.E=i=r=1),g||m?(g?(f=Math.asin(Math.sin(y)/i),m||(u=y)):(f=u,y=Math.asin(i*Math.sin(f))),this.lam0=c-Math.asin(.5*(r-1/r)*Math.tan(f))/this.B):(a=Math.pow(Tt(this.e,p,Math.sin(p)),this.B),s=Math.pow(Tt(this.e,_,Math.sin(_)),this.B),r=this.E/a,h=(s-a)/(s+a),l=this.E*this.E,l=(l-s*a)/(l+s*a),n=d-v,n<-Math.pi?v-=Gi:n>Math.pi&&(v+=Gi),this.lam0=w(.5*(d+v)-Math.atan(l*Math.tan(.5*this.B*(d-v))/h)/this.B),f=Math.atan(2*Math.sin(this.B*w(d-this.lam0))/(r-1/r)),u=y=Math.asin(i*Math.sin(f))),this.singam=Math.sin(f),this.cosgam=Math.cos(f),this.sinrot=Math.sin(u),this.cosrot=Math.cos(u),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A*this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(i*i-1)/Math.cos(y))),this.lat0<0&&(this.u_0=-this.u_0)),r=.5*f,this.v_pole_n=this.ArB*Math.log(Math.tan(j-r)),this.v_pole_s=this.ArB*Math.log(Math.tan(j+r))}function H_(n){var e={},t,i,r,a,s,o,h,l;if(n.x=n.x-this.lam0,Math.abs(Math.abs(n.y)-x)>R){if(s=this.E/Math.pow(Tt(this.e,n.y,Math.sin(n.y)),this.B),o=1/s,t=.5*(s-o),i=.5*(s+o),a=Math.sin(this.B*n.x),r=(t*this.singam-a*this.cosgam)/i,Math.abs(Math.abs(r)-1)<R)throw new Error;l=.5*this.ArB*Math.log((1-r)/(1+r)),o=Math.cos(this.B*n.x),Math.abs(o)<ei?h=this.A*n.x:h=this.ArB*Math.atan2(t*this.cosgam+a*this.singam,o)}else l=n.y>0?this.v_pole_n:this.v_pole_s,h=this.ArB*n.y;return this.no_rot?(e.x=h,e.y=l):(h-=this.u_0,e.x=l*this.cosrot+h*this.sinrot,e.y=h*this.cosrot-l*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function Z_(n){var e,t,i,r,a,s,o,h={};if(n.x=(n.x-this.x0)*(1/this.a),n.y=(n.y-this.y0)*(1/this.a),this.no_rot?(t=n.y,e=n.x):(t=n.x*this.cosrot-n.y*this.sinrot,e=n.y*this.cosrot+n.x*this.sinrot+this.u_0),i=Math.exp(-this.BrA*t),r=.5*(i-1/i),a=.5*(i+1/i),s=Math.sin(this.BrA*e),o=(s*this.cosgam+r*this.singam)/a,Math.abs(Math.abs(o)-1)<R)h.x=0,h.y=o<0?-x:x;else{if(h.y=this.E/Math.sqrt((1+o)/(1-o)),h.y=Bi(this.e,Math.pow(h.y,1/this.B)),h.y===1/0)throw new Error;h.x=-this.rB*Math.atan2(r*this.cosgam-s*this.singam,Math.cos(this.BrA*e))}return h.x+=this.lam0,h}var J_=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"],Q_={init:q_,forward:H_,inverse:Z_,names:J_};function tg(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<R)){var n=this.b/this.a;this.e=Math.sqrt(1-n*n);var e=Math.sin(this.lat1),t=Math.cos(this.lat1),i=bt(this.e,e,t),r=Tt(this.e,this.lat1,e),a=Math.sin(this.lat2),s=Math.cos(this.lat2),o=bt(this.e,a,s),h=Tt(this.e,this.lat2,a),l=Tt(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>R?this.ns=Math.log(i/o)/Math.log(r/h):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=i/(this.ns*Math.pow(r,this.ns)),this.rh=this.a*this.f0*Math.pow(l,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function eg(n){var e=n.x,t=n.y;Math.abs(2*Math.abs(t)-Math.PI)<=R&&(t=ki(t)*(x-2*R));var i=Math.abs(Math.abs(t)-x),r,a;if(i>R)r=Tt(this.e,t,Math.sin(t)),a=this.a*this.f0*Math.pow(r,this.ns);else{if(i=t*this.ns,i<=0)return null;a=0}var s=this.ns*w(e-this.long0);return n.x=this.k0*(a*Math.sin(s))+this.x0,n.y=this.k0*(this.rh-a*Math.cos(s))+this.y0,n}function ig(n){var e,t,i,r,a,s=(n.x-this.x0)/this.k0,o=this.rh-(n.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(s*s+o*o),t=1):(e=-Math.sqrt(s*s+o*o),t=-1);var h=0;if(e!==0&&(h=Math.atan2(t*s,t*o)),e!==0||this.ns>0){if(t=1/this.ns,i=Math.pow(e/(this.a*this.f0),t),r=Bi(this.e,i),r===-9999)return null}else r=-x;return a=w(h/this.ns+this.long0),n.x=a,n.y=r,n}var ng=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc"],rg={init:tg,forward:eg,inverse:ig,names:ng};function ag(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function sg(n){var e,t,i,r,a,s,o,h=n.x,l=n.y,u=w(h-this.long0);return e=Math.pow((1+this.e*Math.sin(l))/(1-this.e*Math.sin(l)),this.alfa*this.e/2),t=2*(Math.atan(this.k*Math.pow(Math.tan(l/2+this.s45),this.alfa)/e)-this.s45),i=-u*this.alfa,r=Math.asin(Math.cos(this.ad)*Math.sin(t)+Math.sin(this.ad)*Math.cos(t)*Math.cos(i)),a=Math.asin(Math.cos(t)*Math.sin(i)/Math.cos(r)),s=this.n*a,o=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(r/2+this.s45),this.n),n.y=o*Math.cos(s)/1,n.x=o*Math.sin(s)/1,this.czech||(n.y*=-1,n.x*=-1),n}function og(n){var e,t,i,r,a,s,o,h,l=n.x;n.x=n.y,n.y=l,this.czech||(n.y*=-1,n.x*=-1),s=Math.sqrt(n.x*n.x+n.y*n.y),a=Math.atan2(n.y,n.x),r=a/Math.sin(this.s0),i=2*(Math.atan(Math.pow(this.ro0/s,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(i)-Math.sin(this.ad)*Math.cos(i)*Math.cos(r)),t=Math.asin(Math.cos(i)*Math.sin(r)/Math.cos(e)),n.x=this.long0-t/this.alfa,o=e,h=0;var u=0;do n.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(o))/(1-this.e*Math.sin(o)),this.e/2))-this.s45),Math.abs(o-n.y)<1e-10&&(h=1),o=n.y,u+=1;while(h===0&&u<15);return u>=15?null:n}var hg=["Krovak","krovak"],lg={init:ag,forward:sg,inverse:og,names:hg};function gt(n,e,t,i,r){return n*r-e*Math.sin(2*r)+t*Math.sin(4*r)-i*Math.sin(6*r)}function Ui(n){return 1-.25*n*(1+n/16*(3+1.25*n))}function zi(n){return .375*n*(1+.25*n*(1+.46875*n))}function Xi(n){return .05859375*n*n*(1+.75*n)}function Wi(n){return n*n*n*(35/3072)}function ii(n,e,t){var i=e*t;return n/Math.sqrt(1-i*i)}function ni(n){return Math.abs(n)<x?n:n-ki(n)*Math.PI}function Xn(n,e,t,i,r){var a,s;a=n/e;for(var o=0;o<15;o++)if(s=(n-(e*a-t*Math.sin(2*a)+i*Math.sin(4*a)-r*Math.sin(6*a)))/(e-2*t*Math.cos(2*a)+4*i*Math.cos(4*a)-6*r*Math.cos(6*a)),a+=s,Math.abs(s)<=1e-10)return a;return NaN}function ug(){this.sphere||(this.e0=Ui(this.es),this.e1=zi(this.es),this.e2=Xi(this.es),this.e3=Wi(this.es),this.ml0=this.a*gt(this.e0,this.e1,this.e2,this.e3,this.lat0))}function fg(n){var e,t,i=n.x,r=n.y;if(i=w(i-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(r)*Math.sin(i)),t=this.a*(Math.atan2(Math.tan(r),Math.cos(i))-this.lat0);else{var a=Math.sin(r),s=Math.cos(r),o=ii(this.a,this.e,a),h=Math.tan(r)*Math.tan(r),l=i*Math.cos(r),u=l*l,f=this.es*s*s/(1-this.es),c=this.a*gt(this.e0,this.e1,this.e2,this.e3,r);e=o*l*(1-u*h*(1/6-(8-h+8*f)*u/120)),t=c-this.ml0+o*a/s*u*(.5+(5-h+6*f)*u/24)}return n.x=e+this.x0,n.y=t+this.y0,n}function cg(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,i,r;if(this.sphere){var a=t+this.lat0;i=Math.asin(Math.sin(a)*Math.cos(e)),r=Math.atan2(Math.tan(e),Math.cos(a))}else{var s=this.ml0/this.a+t,o=Xn(s,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-x)<=R)return n.x=this.long0,n.y=x,t<0&&(n.y*=-1),n;var h=ii(this.a,this.e,Math.sin(o)),l=h*h*h/this.a/this.a*(1-this.es),u=Math.pow(Math.tan(o),2),f=e*this.a/h,c=f*f;i=o-h*Math.tan(o)/l*f*f*(.5-(1+3*u)*f*f/24),r=f*(1-c*(u/3+(1+3*u)*u*c/15))/Math.cos(o)}return n.x=w(r+this.long0),n.y=ni(i),n}var dg=["Cassini","Cassini_Soldner","cass"],vg={init:ug,forward:fg,inverse:cg,names:dg};function he(n,e){var t;return n>1e-7?(t=n*e,(1-n*n)*(e/(1-t*t)-.5/n*Math.log((1-t)/(1+t)))):2*e}var pg=1,_g=2,gg=3,yg=4;function mg(){var n=Math.abs(this.lat0);if(Math.abs(n-x)<R?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(n)<R?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var e;switch(this.qp=he(this.e,1),this.mmf=.5/(1-this.es),this.apa=Sg(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=he(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function Mg(n){var e,t,i,r,a,s,o,h,l,u,f=n.x,c=n.y;if(f=w(f-this.long0),this.sphere){if(a=Math.sin(c),u=Math.cos(c),i=Math.cos(f),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t=this.mode===this.EQUIT?1+u*i:1+this.sinph0*a+this.cosph0*u*i,t<=R)return null;t=Math.sqrt(2/t),e=t*u*Math.sin(f),t*=this.mode===this.EQUIT?a:this.cosph0*a-this.sinph0*u*i}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),Math.abs(c+this.lat0)<R)return null;t=j-c*.5,t=2*(this.mode===this.S_POLE?Math.cos(t):Math.sin(t)),e=t*Math.sin(f),t*=i}}else{switch(o=0,h=0,l=0,i=Math.cos(f),r=Math.sin(f),a=Math.sin(c),s=he(this.e,a),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(o=s/this.qp,h=Math.sqrt(1-o*o)),this.mode){case this.OBLIQ:l=1+this.sinb1*o+this.cosb1*h*i;break;case this.EQUIT:l=1+h*i;break;case this.N_POLE:l=x+c,s=this.qp-s;break;case this.S_POLE:l=c-x,s=this.qp+s;break}if(Math.abs(l)<R)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:l=Math.sqrt(2/l),this.mode===this.OBLIQ?t=this.ymf*l*(this.cosb1*o-this.sinb1*h*i):t=(l=Math.sqrt(2/(1+h*i)))*o*this.ymf,e=this.xmf*l*h*r;break;case this.N_POLE:case this.S_POLE:s>=0?(e=(l=Math.sqrt(s))*r,t=i*(this.mode===this.S_POLE?l:-l)):e=t=0;break}}return n.x=this.a*e+this.x0,n.y=this.a*t+this.y0,n}function Eg(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,i,r,a,s,o,h,l;if(this.sphere){var u=0,f,c=0;if(f=Math.sqrt(e*e+t*t),r=f*.5,r>1)return null;switch(r=2*Math.asin(r),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(c=Math.sin(r),u=Math.cos(r)),this.mode){case this.EQUIT:r=Math.abs(f)<=R?0:Math.asin(t*c/f),e*=c,t=u*f;break;case this.OBLIQ:r=Math.abs(f)<=R?this.lat0:Math.asin(u*this.sinph0+t*c*this.cosph0/f),e*=c*this.cosph0,t=(u-Math.sin(r)*this.sinph0)*f;break;case this.N_POLE:t=-t,r=x-r;break;case this.S_POLE:r-=x;break}i=t===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,t)}else{if(l=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,t*=this.dd,h=Math.sqrt(e*e+t*t),h<R)return n.x=this.long0,n.y=this.lat0,n;s=2*Math.asin(.5*h/this.rq),a=Math.cos(s),e*=s=Math.sin(s),this.mode===this.OBLIQ?(l=a*this.sinb1+t*s*this.cosb1/h,o=this.qp*l,t=h*this.cosb1*a-t*this.sinb1*s):(l=t*s/h,o=this.qp*l,t=h*a)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(t=-t),o=e*e+t*t,!o)return n.x=this.long0,n.y=this.lat0,n;l=1-o/this.qp,this.mode===this.S_POLE&&(l=-l)}i=Math.atan2(e,t),r=Tg(Math.asin(l),this.apa)}return n.x=w(this.long0+i),n.y=r,n}var xg=.3333333333333333,Cg=.17222222222222222,Ig=.10257936507936508,Og=.06388888888888888,Rg=.0664021164021164,wg=.016415012942191543;function Sg(n){var e,t=[];return t[0]=n*xg,e=n*n,t[0]+=e*Cg,t[1]=e*Og,e*=n,t[0]+=e*Ig,t[1]+=e*Rg,t[2]=e*wg,t}function Tg(n,e){var t=n+n;return n+e[0]*Math.sin(t)+e[1]*Math.sin(t+t)+e[2]*Math.sin(t+t+t)}var Pg=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],Ag={init:mg,forward:Mg,inverse:Eg,names:Pg,S_POLE:pg,N_POLE:_g,EQUIT:gg,OBLIQ:yg};function le(n){return Math.abs(n)>1&&(n=n>1?1:-1),Math.asin(n)}function Lg(){Math.abs(this.lat1+this.lat2)<R||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=bt(this.e3,this.sin_po,this.cos_po),this.qs1=he(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=bt(this.e3,this.sin_po,this.cos_po),this.qs2=he(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=he(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>R?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function Ng(n){var e=n.x,t=n.y;this.sin_phi=Math.sin(t),this.cos_phi=Math.cos(t);var i=he(this.e3,this.sin_phi,this.cos_phi),r=this.a*Math.sqrt(this.c-this.ns0*i)/this.ns0,a=this.ns0*w(e-this.long0),s=r*Math.sin(a)+this.x0,o=this.rh-r*Math.cos(a)+this.y0;return n.x=s,n.y=o,n}function Dg(n){var e,t,i,r,a,s;return n.x-=this.x0,n.y=this.rh-n.y+this.y0,this.ns0>=0?(e=Math.sqrt(n.x*n.x+n.y*n.y),i=1):(e=-Math.sqrt(n.x*n.x+n.y*n.y),i=-1),r=0,e!==0&&(r=Math.atan2(i*n.x,i*n.y)),i=e*this.ns0/this.a,this.sphere?s=Math.asin((this.c-i*i)/(2*this.ns0)):(t=(this.c-i*i)/this.ns0,s=this.phi1z(this.e3,t)),a=w(r/this.ns0+this.long0),n.x=a,n.y=s,n}function Fg(n,e){var t,i,r,a,s,o=le(.5*e);if(n<R)return o;for(var h=n*n,l=1;l<=25;l++)if(t=Math.sin(o),i=Math.cos(o),r=n*t,a=1-r*r,s=.5*a*a/i*(e/(1-h)-t/a+.5/n*Math.log((1-r)/(1+r))),o=o+s,Math.abs(s)<=1e-7)return o;return null}var Gg=["Albers_Conic_Equal_Area","Albers","aea"],bg={init:Lg,forward:Ng,inverse:Dg,names:Gg,phi1z:Fg};function kg(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function Bg(n){var e,t,i,r,a,s,o,h,l=n.x,u=n.y;return i=w(l-this.long0),e=Math.sin(u),t=Math.cos(u),r=Math.cos(i),s=this.sin_p14*e+this.cos_p14*t*r,a=1,s>0||Math.abs(s)<=R?(o=this.x0+this.a*a*t*Math.sin(i)/s,h=this.y0+this.a*a*(this.cos_p14*e-this.sin_p14*t*r)/s):(o=this.x0+this.infinity_dist*t*Math.sin(i),h=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*t*r)),n.x=o,n.y=h,n}function jg(n){var e,t,i,r,a,s;return n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,(e=Math.sqrt(n.x*n.x+n.y*n.y))?(r=Math.atan2(e,this.rc),t=Math.sin(r),i=Math.cos(r),s=le(i*this.sin_p14+n.y*t*this.cos_p14/e),a=Math.atan2(n.x*t,e*this.cos_p14*i-n.y*this.sin_p14*t),a=w(this.long0+a)):(s=this.phic0,a=0),n.x=a,n.y=s,n}var $g=["gnom"],Ug={init:kg,forward:Bg,inverse:jg,names:$g};function zg(n,e){var t=1-(1-n*n)/(2*n)*Math.log((1-n)/(1+n));if(Math.abs(Math.abs(e)-t)<1e-6)return e<0?-1*x:x;for(var i=Math.asin(.5*e),r,a,s,o,h=0;h<30;h++)if(a=Math.sin(i),s=Math.cos(i),o=n*a,r=Math.pow(1-o*o,2)/(2*s)*(e/(1-n*n)-a/(1-o*o)+.5/n*Math.log((1-o)/(1+o))),i+=r,Math.abs(r)<=1e-10)return i;return NaN}function Xg(){this.sphere||(this.k0=bt(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function Wg(n){var e=n.x,t=n.y,i,r,a=w(e-this.long0);if(this.sphere)i=this.x0+this.a*a*Math.cos(this.lat_ts),r=this.y0+this.a*Math.sin(t)/Math.cos(this.lat_ts);else{var s=he(this.e,Math.sin(t));i=this.x0+this.a*this.k0*a,r=this.y0+this.a*s*.5/this.k0}return n.x=i,n.y=r,n}function Yg(n){n.x-=this.x0,n.y-=this.y0;var e,t;return this.sphere?(e=w(this.long0+n.x/this.a/Math.cos(this.lat_ts)),t=Math.asin(n.y/this.a*Math.cos(this.lat_ts))):(t=zg(this.e,2*n.y*this.k0/this.a),e=w(this.long0+n.x/(this.a*this.k0))),n.x=e,n.y=t,n}var Vg=["cea"],Kg={init:Xg,forward:Wg,inverse:Yg,names:Vg};function qg(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function Hg(n){var e=n.x,t=n.y,i=w(e-this.long0),r=ni(t-this.lat0);return n.x=this.x0+this.a*i*this.rc,n.y=this.y0+this.a*r,n}function Zg(n){var e=n.x,t=n.y;return n.x=w(this.long0+(e-this.x0)/(this.a*this.rc)),n.y=ni(this.lat0+(t-this.y0)/this.a),n}var Jg=["Equirectangular","Equidistant_Cylindrical","eqc"],Qg={init:qg,forward:Hg,inverse:Zg,names:Jg},sh=20;function t0(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Ui(this.es),this.e1=zi(this.es),this.e2=Xi(this.es),this.e3=Wi(this.es),this.ml0=this.a*gt(this.e0,this.e1,this.e2,this.e3,this.lat0)}function e0(n){var e=n.x,t=n.y,i,r,a,s=w(e-this.long0);if(a=s*Math.sin(t),this.sphere)Math.abs(t)<=R?(i=this.a*s,r=-1*this.a*this.lat0):(i=this.a*Math.sin(a)/Math.tan(t),r=this.a*(ni(t-this.lat0)+(1-Math.cos(a))/Math.tan(t)));else if(Math.abs(t)<=R)i=this.a*s,r=-1*this.ml0;else{var o=ii(this.a,this.e,Math.sin(t))/Math.tan(t);i=o*Math.sin(a),r=this.a*gt(this.e0,this.e1,this.e2,this.e3,t)-this.ml0+o*(1-Math.cos(a))}return n.x=i+this.x0,n.y=r+this.y0,n}function i0(n){var e,t,i,r,a,s,o,h,l;if(i=n.x-this.x0,r=n.y-this.y0,this.sphere)if(Math.abs(r+this.a*this.lat0)<=R)e=w(i/this.a+this.long0),t=0;else{s=this.lat0+r/this.a,o=i*i/this.a/this.a+s*s,h=s;var u;for(a=sh;a;--a)if(u=Math.tan(h),l=-1*(s*(h*u+1)-h-.5*(h*h+o)*u)/((h-s)/u-1),h+=l,Math.abs(l)<=R){t=h;break}e=w(this.long0+Math.asin(i*Math.tan(h)/this.a)/Math.sin(t))}else if(Math.abs(r+this.ml0)<=R)t=0,e=w(this.long0+i/this.a);else{s=(this.ml0+r)/this.a,o=i*i/this.a/this.a+s*s,h=s;var f,c,d,v,p;for(a=sh;a;--a)if(p=this.e*Math.sin(h),f=Math.sqrt(1-p*p)*Math.tan(h),c=this.a*gt(this.e0,this.e1,this.e2,this.e3,h),d=this.e0-2*this.e1*Math.cos(2*h)+4*this.e2*Math.cos(4*h)-6*this.e3*Math.cos(6*h),v=c/this.a,l=(s*(f*v+1)-v-.5*f*(v*v+o))/(this.es*Math.sin(2*h)*(v*v+o-2*s*v)/(4*f)+(s-v)*(f*d-2/Math.sin(2*h))-d),h-=l,Math.abs(l)<=R){t=h;break}f=Math.sqrt(1-this.es*Math.pow(Math.sin(t),2))*Math.tan(t),e=w(this.long0+Math.asin(i*f/this.a)/Math.sin(t))}return n.x=e,n.y=t,n}var n0=["Polyconic","poly"],r0={init:t0,forward:e0,inverse:i0,names:n0};function a0(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function s0(n){var e,t=n.x,i=n.y,r=i-this.lat0,a=t-this.long0,s=r/Fi*1e-5,o=a,h=1,l=0;for(e=1;e<=10;e++)h=h*s,l=l+this.A[e]*h;var u=l,f=o,c=1,d=0,v,p,_=0,y=0;for(e=1;e<=6;e++)v=c*u-d*f,p=d*u+c*f,c=v,d=p,_=_+this.B_re[e]*c-this.B_im[e]*d,y=y+this.B_im[e]*c+this.B_re[e]*d;return n.x=y*this.a+this.x0,n.y=_*this.a+this.y0,n}function o0(n){var e,t=n.x,i=n.y,r=t-this.x0,a=i-this.y0,s=a/this.a,o=r/this.a,h=1,l=0,u,f,c=0,d=0;for(e=1;e<=6;e++)u=h*s-l*o,f=l*s+h*o,h=u,l=f,c=c+this.C_re[e]*h-this.C_im[e]*l,d=d+this.C_im[e]*h+this.C_re[e]*l;for(var v=0;v<this.iterations;v++){var p=c,_=d,y,g,m=s,M=o;for(e=2;e<=6;e++)y=p*c-_*d,g=_*c+p*d,p=y,_=g,m=m+(e-1)*(this.B_re[e]*p-this.B_im[e]*_),M=M+(e-1)*(this.B_im[e]*p+this.B_re[e]*_);p=1,_=0;var E=this.B_re[1],C=this.B_im[1];for(e=2;e<=6;e++)y=p*c-_*d,g=_*c+p*d,p=y,_=g,E=E+e*(this.B_re[e]*p-this.B_im[e]*_),C=C+e*(this.B_im[e]*p+this.B_re[e]*_);var S=E*E+C*C;c=(m*E+M*C)/S,d=(M*E-m*C)/S}var O=c,P=d,F=1,N=0;for(e=1;e<=9;e++)F=F*O,N=N+this.D[e]*F;var G=this.lat0+N*Fi*1e5,k=this.long0+P;return n.x=k,n.y=G,n}var h0=["New_Zealand_Map_Grid","nzmg"],l0={init:a0,forward:s0,inverse:o0,names:h0};function u0(){}function f0(n){var e=n.x,t=n.y,i=w(e-this.long0),r=this.x0+this.a*i,a=this.y0+this.a*Math.log(Math.tan(Math.PI/4+t/2.5))*1.25;return n.x=r,n.y=a,n}function c0(n){n.x-=this.x0,n.y-=this.y0;var e=w(this.long0+n.x/this.a),t=2.5*(Math.atan(Math.exp(.8*n.y/this.a))-Math.PI/4);return n.x=e,n.y=t,n}var d0=["Miller_Cylindrical","mill"],v0={init:u0,forward:f0,inverse:c0,names:d0},p0=20;function _0(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=ih(this.es)}function g0(n){var e,t,i=n.x,r=n.y;if(i=w(i-this.long0),this.sphere){if(!this.m)r=this.n!==1?Math.asin(this.n*Math.sin(r)):r;else for(var a=this.n*Math.sin(r),s=p0;s;--s){var o=(this.m*r+Math.sin(r)-a)/(this.m+Math.cos(r));if(r-=o,Math.abs(o)<R)break}e=this.a*this.C_x*i*(this.m+Math.cos(r)),t=this.a*this.C_y*r}else{var h=Math.sin(r),l=Math.cos(r);t=this.a*jn(r,h,l,this.en),e=this.a*i*l/Math.sqrt(1-this.es*h*h)}return n.x=e,n.y=t,n}function y0(n){var e,t,i,r;return n.x-=this.x0,i=n.x/this.a,n.y-=this.y0,e=n.y/this.a,this.sphere?(e/=this.C_y,i=i/(this.C_x*(this.m+Math.cos(e))),this.m?e=le((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=le(Math.sin(e)/this.n)),i=w(i+this.long0),e=ni(e)):(e=nh(n.y/this.a,this.es,this.en),r=Math.abs(e),r<x?(r=Math.sin(e),t=this.long0+n.x*Math.sqrt(1-this.es*r*r)/(this.a*Math.cos(e)),i=w(t)):r-R<x&&(i=this.long0)),n.x=i,n.y=e,n}var m0=["Sinusoidal","sinu"],M0={init:_0,forward:g0,inverse:y0,names:m0};function E0(){}function x0(n){for(var e=n.x,t=n.y,i=w(e-this.long0),r=t,a=Math.PI*Math.sin(t);;){var s=-(r+Math.sin(r)-a)/(1+Math.cos(r));if(r+=s,Math.abs(s)<R)break}r/=2,Math.PI/2-Math.abs(t)<R&&(i=0);var o=.900316316158*this.a*i*Math.cos(r)+this.x0,h=1.4142135623731*this.a*Math.sin(r)+this.y0;return n.x=o,n.y=h,n}function C0(n){var e,t;n.x-=this.x0,n.y-=this.y0,t=n.y/(1.4142135623731*this.a),Math.abs(t)>.999999999999&&(t=.999999999999),e=Math.asin(t);var i=w(this.long0+n.x/(.900316316158*this.a*Math.cos(e)));i<-Math.PI&&(i=-Math.PI),i>Math.PI&&(i=Math.PI),t=(2*e+Math.sin(2*e))/Math.PI,Math.abs(t)>1&&(t=1);var r=Math.asin(t);return n.x=i,n.y=r,n}var I0=["Mollweide","moll"],O0={init:E0,forward:x0,inverse:C0,names:I0};function R0(){Math.abs(this.lat1+this.lat2)<R||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Ui(this.es),this.e1=zi(this.es),this.e2=Xi(this.es),this.e3=Wi(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=bt(this.e,this.sinphi,this.cosphi),this.ml1=gt(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<R?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=bt(this.e,this.sinphi,this.cosphi),this.ml2=gt(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=gt(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function w0(n){var e=n.x,t=n.y,i;if(this.sphere)i=this.a*(this.g-t);else{var r=gt(this.e0,this.e1,this.e2,this.e3,t);i=this.a*(this.g-r)}var a=this.ns*w(e-this.long0),s=this.x0+i*Math.sin(a),o=this.y0+this.rh-i*Math.cos(a);return n.x=s,n.y=o,n}function S0(n){n.x-=this.x0,n.y=this.rh-n.y+this.y0;var e,t,i,r;this.ns>=0?(t=Math.sqrt(n.x*n.x+n.y*n.y),e=1):(t=-Math.sqrt(n.x*n.x+n.y*n.y),e=-1);var a=0;if(t!==0&&(a=Math.atan2(e*n.x,e*n.y)),this.sphere)return r=w(this.long0+a/this.ns),i=ni(this.g-t/this.a),n.x=r,n.y=i,n;var s=this.g-t/this.a;return i=Xn(s,this.e0,this.e1,this.e2,this.e3),r=w(this.long0+a/this.ns),n.x=r,n.y=i,n}var T0=["Equidistant_Conic","eqdc"],P0={init:R0,forward:w0,inverse:S0,names:T0};function A0(){this.R=this.a}function L0(n){var e=n.x,t=n.y,i=w(e-this.long0),r,a;Math.abs(t)<=R&&(r=this.x0+this.R*i,a=this.y0);var s=le(2*Math.abs(t/Math.PI));(Math.abs(i)<=R||Math.abs(Math.abs(t)-x)<=R)&&(r=this.x0,t>=0?a=this.y0+Math.PI*this.R*Math.tan(.5*s):a=this.y0+Math.PI*this.R*-Math.tan(.5*s));var o=.5*Math.abs(Math.PI/i-i/Math.PI),h=o*o,l=Math.sin(s),u=Math.cos(s),f=u/(l+u-1),c=f*f,d=f*(2/l-1),v=d*d,p=Math.PI*this.R*(o*(f-v)+Math.sqrt(h*(f-v)*(f-v)-(v+h)*(c-v)))/(v+h);i<0&&(p=-p),r=this.x0+p;var _=h+f;return p=Math.PI*this.R*(d*_-o*Math.sqrt((v+h)*(h+1)-_*_))/(v+h),t>=0?a=this.y0+p:a=this.y0-p,n.x=r,n.y=a,n}function N0(n){var e,t,i,r,a,s,o,h,l,u,f,c,d;return n.x-=this.x0,n.y-=this.y0,f=Math.PI*this.R,i=n.x/f,r=n.y/f,a=i*i+r*r,s=-Math.abs(r)*(1+a),o=s-2*r*r+i*i,h=-2*s+1+2*r*r+a*a,d=r*r/h+(2*o*o*o/h/h/h-9*s*o/h/h)/27,l=(s-o*o/3/h)/h,u=2*Math.sqrt(-l/3),f=3*d/l/u,Math.abs(f)>1&&(f>=0?f=1:f=-1),c=Math.acos(f)/3,n.y>=0?t=(-u*Math.cos(c+Math.PI/3)-o/3/h)*Math.PI:t=-(-u*Math.cos(c+Math.PI/3)-o/3/h)*Math.PI,Math.abs(i)<R?e=this.long0:e=w(this.long0+Math.PI*(a-1+Math.sqrt(1+2*(i*i-r*r)+a*a))/2/i),n.x=e,n.y=t,n}var D0=["Van_der_Grinten_I","VanDerGrinten","vandg"],F0={init:A0,forward:L0,inverse:N0,names:D0};function G0(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)}function b0(n){var e=n.x,t=n.y,i=Math.sin(n.y),r=Math.cos(n.y),a=w(e-this.long0),s,o,h,l,u,f,c,d,v,p,_,y,g,m,M,E,C,S,O,P,F,N,G;return this.sphere?Math.abs(this.sin_p12-1)<=R?(n.x=this.x0+this.a*(x-t)*Math.sin(a),n.y=this.y0-this.a*(x-t)*Math.cos(a),n):Math.abs(this.sin_p12+1)<=R?(n.x=this.x0+this.a*(x+t)*Math.sin(a),n.y=this.y0+this.a*(x+t)*Math.cos(a),n):(S=this.sin_p12*i+this.cos_p12*r*Math.cos(a),E=Math.acos(S),C=E?E/Math.sin(E):1,n.x=this.x0+this.a*C*r*Math.sin(a),n.y=this.y0+this.a*C*(this.cos_p12*i-this.sin_p12*r*Math.cos(a)),n):(s=Ui(this.es),o=zi(this.es),h=Xi(this.es),l=Wi(this.es),Math.abs(this.sin_p12-1)<=R?(u=this.a*gt(s,o,h,l,x),f=this.a*gt(s,o,h,l,t),n.x=this.x0+(u-f)*Math.sin(a),n.y=this.y0-(u-f)*Math.cos(a),n):Math.abs(this.sin_p12+1)<=R?(u=this.a*gt(s,o,h,l,x),f=this.a*gt(s,o,h,l,t),n.x=this.x0+(u+f)*Math.sin(a),n.y=this.y0+(u+f)*Math.cos(a),n):(c=i/r,d=ii(this.a,this.e,this.sin_p12),v=ii(this.a,this.e,i),p=Math.atan((1-this.es)*c+this.es*d*this.sin_p12/(v*r)),_=Math.atan2(Math.sin(a),this.cos_p12*Math.tan(p)-this.sin_p12*Math.cos(a)),_===0?O=Math.asin(this.cos_p12*Math.sin(p)-this.sin_p12*Math.cos(p)):Math.abs(Math.abs(_)-Math.PI)<=R?O=-Math.asin(this.cos_p12*Math.sin(p)-this.sin_p12*Math.cos(p)):O=Math.asin(Math.sin(a)*Math.cos(p)/Math.sin(_)),y=this.e*this.sin_p12/Math.sqrt(1-this.es),g=this.e*this.cos_p12*Math.cos(_)/Math.sqrt(1-this.es),m=y*g,M=g*g,P=O*O,F=P*O,N=F*O,G=N*O,E=d*O*(1-P*M*(1-M)/6+F/8*m*(1-2*M)+N/120*(M*(4-7*M)-3*y*y*(1-7*M))-G/48*m),n.x=this.x0+E*Math.sin(_),n.y=this.y0+E*Math.cos(_),n))}function k0(n){n.x-=this.x0,n.y-=this.y0;var e,t,i,r,a,s,o,h,l,u,f,c,d,v,p,_,y,g,m,M,E,C,S,O;return this.sphere?(e=Math.sqrt(n.x*n.x+n.y*n.y),e>2*x*this.a?void 0:(t=e/this.a,i=Math.sin(t),r=Math.cos(t),a=this.long0,Math.abs(e)<=R?s=this.lat0:(s=le(r*this.sin_p12+n.y*i*this.cos_p12/e),o=Math.abs(this.lat0)-x,Math.abs(o)<=R?this.lat0>=0?a=w(this.long0+Math.atan2(n.x,-n.y)):a=w(this.long0-Math.atan2(-n.x,n.y)):a=w(this.long0+Math.atan2(n.x*i,e*this.cos_p12*r-n.y*this.sin_p12*i))),n.x=a,n.y=s,n)):(h=Ui(this.es),l=zi(this.es),u=Xi(this.es),f=Wi(this.es),Math.abs(this.sin_p12-1)<=R?(c=this.a*gt(h,l,u,f,x),e=Math.sqrt(n.x*n.x+n.y*n.y),d=c-e,s=Xn(d/this.a,h,l,u,f),a=w(this.long0+Math.atan2(n.x,-1*n.y)),n.x=a,n.y=s,n):Math.abs(this.sin_p12+1)<=R?(c=this.a*gt(h,l,u,f,x),e=Math.sqrt(n.x*n.x+n.y*n.y),d=e-c,s=Xn(d/this.a,h,l,u,f),a=w(this.long0+Math.atan2(n.x,n.y)),n.x=a,n.y=s,n):(e=Math.sqrt(n.x*n.x+n.y*n.y),_=Math.atan2(n.x,n.y),v=ii(this.a,this.e,this.sin_p12),y=Math.cos(_),g=this.e*this.cos_p12*y,m=-g*g/(1-this.es),M=3*this.es*(1-m)*this.sin_p12*this.cos_p12*y/(1-this.es),E=e/v,C=E-m*(1+m)*Math.pow(E,3)/6-M*(1+3*m)*Math.pow(E,4)/24,S=1-m*C*C/2-E*C*C*C/6,p=Math.asin(this.sin_p12*Math.cos(C)+this.cos_p12*Math.sin(C)*y),a=w(this.long0+Math.asin(Math.sin(_)*Math.sin(C)/Math.cos(p))),O=Math.sin(p),s=Math.atan2((O-this.es*S*this.sin_p12)*Math.tan(p),O*(1-this.es)),n.x=a,n.y=s,n))}var B0=["Azimuthal_Equidistant","aeqd"],j0={init:G0,forward:b0,inverse:k0,names:B0};function $0(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function U0(n){var e,t,i,r,a,s,o,h,l=n.x,u=n.y;return i=w(l-this.long0),e=Math.sin(u),t=Math.cos(u),r=Math.cos(i),s=this.sin_p14*e+this.cos_p14*t*r,a=1,(s>0||Math.abs(s)<=R)&&(o=this.a*a*t*Math.sin(i),h=this.y0+this.a*a*(this.cos_p14*e-this.sin_p14*t*r)),n.x=o,n.y=h,n}function z0(n){var e,t,i,r,a,s,o;return n.x-=this.x0,n.y-=this.y0,e=Math.sqrt(n.x*n.x+n.y*n.y),t=le(e/this.a),i=Math.sin(t),r=Math.cos(t),s=this.long0,Math.abs(e)<=R?(o=this.lat0,n.x=s,n.y=o,n):(o=le(r*this.sin_p14+n.y*i*this.cos_p14/e),a=Math.abs(this.lat0)-x,Math.abs(a)<=R?(this.lat0>=0?s=w(this.long0+Math.atan2(n.x,-n.y)):s=w(this.long0-Math.atan2(-n.x,n.y)),n.x=s,n.y=o,n):(s=w(this.long0+Math.atan2(n.x*i,e*this.cos_p14*r-n.y*this.sin_p14*i)),n.x=s,n.y=o,n))}var X0=["ortho"],W0={init:$0,forward:U0,inverse:z0,names:X0},Q={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},$={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function Y0(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=x-j/2?this.face=Q.TOP:this.lat0<=-(x-j/2)?this.face=Q.BOTTOM:Math.abs(this.long0)<=j?this.face=Q.FRONT:Math.abs(this.long0)<=x+j?this.face=this.long0>0?Q.RIGHT:Q.LEFT:this.face=Q.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function V0(n){var e={x:0,y:0},t,i,r,a,s,o,h={value:0};if(n.x-=this.long0,this.es!==0?t=Math.atan(this.one_minus_f_squared*Math.tan(n.y)):t=n.y,i=n.x,this.face===Q.TOP)a=x-t,i>=j&&i<=x+j?(h.value=$.AREA_0,r=i-x):i>x+j||i<=-(x+j)?(h.value=$.AREA_1,r=i>0?i-rt:i+rt):i>-(x+j)&&i<=-j?(h.value=$.AREA_2,r=i+x):(h.value=$.AREA_3,r=i);else if(this.face===Q.BOTTOM)a=x+t,i>=j&&i<=x+j?(h.value=$.AREA_0,r=-i+x):i<j&&i>=-j?(h.value=$.AREA_1,r=-i):i<-j&&i>=-(x+j)?(h.value=$.AREA_2,r=-i-x):(h.value=$.AREA_3,r=i>0?-i+rt:-i-rt);else{var l,u,f,c,d,v,p;this.face===Q.RIGHT?i=ri(i,+x):this.face===Q.BACK?i=ri(i,+rt):this.face===Q.LEFT&&(i=ri(i,-x)),c=Math.sin(t),d=Math.cos(t),v=Math.sin(i),p=Math.cos(i),l=d*p,u=d*v,f=c,this.face===Q.FRONT?(a=Math.acos(l),r=Wn(a,f,u,h)):this.face===Q.RIGHT?(a=Math.acos(u),r=Wn(a,f,-l,h)):this.face===Q.BACK?(a=Math.acos(-l),r=Wn(a,f,-u,h)):this.face===Q.LEFT?(a=Math.acos(-u),r=Wn(a,f,l,h)):(a=r=0,h.value=$.AREA_0)}return o=Math.atan(12/rt*(r+Math.acos(Math.sin(r)*Math.cos(j))-x)),s=Math.sqrt((1-Math.cos(a))/(Math.cos(o)*Math.cos(o))/(1-Math.cos(Math.atan(1/Math.cos(r))))),h.value===$.AREA_1?o+=x:h.value===$.AREA_2?o+=rt:h.value===$.AREA_3&&(o+=1.5*rt),e.x=s*Math.cos(o),e.y=s*Math.sin(o),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,n.x=e.x,n.y=e.y,n}function K0(n){var e={lam:0,phi:0},t,i,r,a,s,o,h,l,u,f={value:0};if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,i=Math.atan(Math.sqrt(n.x*n.x+n.y*n.y)),t=Math.atan2(n.y,n.x),n.x>=0&&n.x>=Math.abs(n.y)?f.value=$.AREA_0:n.y>=0&&n.y>=Math.abs(n.x)?(f.value=$.AREA_1,t-=x):n.x<0&&-n.x>=Math.abs(n.y)?(f.value=$.AREA_2,t=t<0?t+rt:t-rt):(f.value=$.AREA_3,t+=x),u=rt/12*Math.tan(t),s=Math.sin(u)/(Math.cos(u)-1/Math.sqrt(2)),o=Math.atan(s),r=Math.cos(t),a=Math.tan(i),h=1-r*r*a*a*(1-Math.cos(Math.atan(1/Math.cos(o)))),h<-1?h=-1:h>1&&(h=1),this.face===Q.TOP)l=Math.acos(h),e.phi=x-l,f.value===$.AREA_0?e.lam=o+x:f.value===$.AREA_1?e.lam=o<0?o+rt:o-rt:f.value===$.AREA_2?e.lam=o-x:e.lam=o;else if(this.face===Q.BOTTOM)l=Math.acos(h),e.phi=l-x,f.value===$.AREA_0?e.lam=-o+x:f.value===$.AREA_1?e.lam=-o:f.value===$.AREA_2?e.lam=-o-x:e.lam=o<0?-o-rt:-o+rt;else{var c,d,v;c=h,u=c*c,u>=1?v=0:v=Math.sqrt(1-u)*Math.sin(o),u+=v*v,u>=1?d=0:d=Math.sqrt(1-u),f.value===$.AREA_1?(u=d,d=-v,v=u):f.value===$.AREA_2?(d=-d,v=-v):f.value===$.AREA_3&&(u=d,d=v,v=-u),this.face===Q.RIGHT?(u=c,c=-d,d=u):this.face===Q.BACK?(c=-c,d=-d):this.face===Q.LEFT&&(u=c,c=d,d=-u),e.phi=Math.acos(-v)-x,e.lam=Math.atan2(d,c),this.face===Q.RIGHT?e.lam=ri(e.lam,-x):this.face===Q.BACK?e.lam=ri(e.lam,-rt):this.face===Q.LEFT&&(e.lam=ri(e.lam,+x))}if(this.es!==0){var p,_,y;p=e.phi<0?1:0,_=Math.tan(e.phi),y=this.b/Math.sqrt(_*_+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-y*y)/(this.one_minus_f*y)),p&&(e.phi=-e.phi)}return e.lam+=this.long0,n.x=e.lam,n.y=e.phi,n}function Wn(n,e,t,i){var r;return n<R?(i.value=$.AREA_0,r=0):(r=Math.atan2(e,t),Math.abs(r)<=j?i.value=$.AREA_0:r>j&&r<=x+j?(i.value=$.AREA_1,r-=x):r>x+j||r<=-(x+j)?(i.value=$.AREA_2,r=r>=0?r-rt:r+rt):(i.value=$.AREA_3,r+=x)),r}function ri(n,e){var t=n+e;return t<-rt?t+=Gi:t>+rt&&(t-=Gi),t}var q0=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"],H0={init:Y0,forward:V0,inverse:K0,names:q0},ua=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Yi=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],oh=.8487,hh=1.3523,lh=Gt/5,Z0=1/lh,ai=18,Yn=function(n,e){return n[0]+e*(n[1]+e*(n[2]+e*n[3]))},J0=function(n,e){return n[1]+e*(2*n[2]+e*3*n[3])};function Q0(n,e,t,i){for(var r=e;i;--i){var a=n(r);if(r-=a,Math.abs(a)<t)break}return r}function ty(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function ey(n){var e=w(n.x-this.long0),t=Math.abs(n.y),i=Math.floor(t*lh);i<0?i=0:i>=ai&&(i=ai-1),t=Gt*(t-Z0*i);var r={x:Yn(ua[i],t)*e,y:Yn(Yi[i],t)};return n.y<0&&(r.y=-r.y),r.x=r.x*this.a*oh+this.x0,r.y=r.y*this.a*hh+this.y0,r}function iy(n){var e={x:(n.x-this.x0)/(this.a*oh),y:Math.abs(n.y-this.y0)/(this.a*hh)};if(e.y>=1)e.x/=ua[ai][0],e.y=n.y<0?-x:x;else{var t=Math.floor(e.y*ai);for(t<0?t=0:t>=ai&&(t=ai-1);;)if(Yi[t][0]>e.y)--t;else if(Yi[t+1][0]<=e.y)++t;else break;var i=Yi[t],r=5*(e.y-i[0])/(Yi[t+1][0]-i[0]);r=Q0(function(a){return(Yn(i,a)-e.y)/J0(i,a)},r,R,100),e.x/=Yn(ua[t],r),e.y=(5*t+r)*ft,n.y<0&&(e.y=-e.y)}return e.x=w(e.x+this.long0),e}var ny=["Robinson","robin"],ry={init:ty,forward:ey,inverse:iy,names:ny};function ay(){this.name="geocent"}function sy(n){var e=Go(n,this.es,this.a);return e}function oy(n){var e=bo(n,this.es,this.a,this.b);return e}var hy=["Geocentric","geocentric","geocent","Geocent"],ly={init:ay,forward:sy,inverse:oy,names:hy},vt={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},Vi={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function uy(){if(Object.keys(Vi).forEach(function(t){if(typeof this[t]=="undefined")this[t]=Vi[t].def;else{if(Vi[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);Vi[t].num&&(this[t]=parseFloat(this[t]))}Vi[t].degrees&&(this[t]=this[t]*ft)}.bind(this)),Math.abs(Math.abs(this.lat0)-x)<R?this.mode=this.lat0<0?vt.S_POLE:vt.N_POLE:Math.abs(this.lat0)<R?this.mode=vt.EQUIT:(this.mode=vt.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var n=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(n),this.sw=Math.sin(n)}function fy(n){n.x-=this.long0;var e=Math.sin(n.y),t=Math.cos(n.y),i=Math.cos(n.x),r,a;switch(this.mode){case vt.OBLIQ:a=this.sinph0*e+this.cosph0*t*i;break;case vt.EQUIT:a=t*i;break;case vt.S_POLE:a=-e;break;case vt.N_POLE:a=e;break}switch(a=this.pn1/(this.p-a),r=a*t*Math.sin(n.x),this.mode){case vt.OBLIQ:a*=this.cosph0*e-this.sinph0*t*i;break;case vt.EQUIT:a*=e;break;case vt.N_POLE:a*=-(t*i);break;case vt.S_POLE:a*=t*i;break}var s,o;return s=a*this.cg+r*this.sg,o=1/(s*this.sw*this.h1+this.cw),r=(r*this.cg-a*this.sg)*this.cw*o,a=s*o,n.x=r*this.a,n.y=a*this.a,n}function cy(n){n.x/=this.a,n.y/=this.a;var e={x:n.x,y:n.y},t,i,r;r=1/(this.pn1-n.y*this.sw),t=this.pn1*n.x*r,i=this.pn1*n.y*this.cw*r,n.x=t*this.cg+i*this.sg,n.y=i*this.cg-t*this.sg;var a=Un(n.x,n.y);if(Math.abs(a)<R)e.x=0,e.y=n.y;else{var s,o;switch(o=1-a*a*this.pfact,o=(this.p-Math.sqrt(o))/(this.pn1/a+a/this.pn1),s=Math.sqrt(1-o*o),this.mode){case vt.OBLIQ:e.y=Math.asin(s*this.sinph0+n.y*o*this.cosph0/a),n.y=(s-this.sinph0*Math.sin(e.y))*a,n.x*=o*this.cosph0;break;case vt.EQUIT:e.y=Math.asin(n.y*o/a),n.y=s*a,n.x*=o;break;case vt.N_POLE:e.y=Math.asin(s),n.y=-n.y;break;case vt.S_POLE:e.y=-Math.asin(s);break}e.x=Math.atan2(n.x,n.y)}return n.x=e.x+this.long0,n.y=e.y,n}var dy=["Tilted_Perspective","tpers"],vy={init:uy,forward:fy,inverse:cy,names:dy};function py(n){n.Proj.projections.add($n),n.Proj.projections.add(zn),n.Proj.projections.add(R_),n.Proj.projections.add(G_),n.Proj.projections.add(U_),n.Proj.projections.add(V_),n.Proj.projections.add(Q_),n.Proj.projections.add(rg),n.Proj.projections.add(lg),n.Proj.projections.add(vg),n.Proj.projections.add(Ag),n.Proj.projections.add(bg),n.Proj.projections.add(Ug),n.Proj.projections.add(Kg),n.Proj.projections.add(Qg),n.Proj.projections.add(r0),n.Proj.projections.add(l0),n.Proj.projections.add(v0),n.Proj.projections.add(M0),n.Proj.projections.add(O0),n.Proj.projections.add(P0),n.Proj.projections.add(F0),n.Proj.projections.add(j0),n.Proj.projections.add(W0),n.Proj.projections.add(H0),n.Proj.projections.add(ry),n.Proj.projections.add(ly),n.Proj.projections.add(vy)}wt.defaultDatum="WGS84";wt.Proj=kt;wt.WGS84=new wt.Proj("WGS84");wt.Point=ti;wt.toPoint=$o;wt.defs=_t;wt.nadgrid=Sp;wt.transform=Bn;wt.mgrs=Xp;wt.version="__VERSION__";py(wt);function xy(n){var e=Object.keys(n.defs),t=e.length,i,r;for(i=0;i<t;++i){var a=e[i];if(!st(a)){var s=n.defs(a),o=s.units;!o&&s.projName==="longlat"&&(o=Fe.DEGREES),Za(new lr({code:a,axisOrientation:s.axis,metersPerUnit:s.to_meter,units:o}))}}for(i=0;i<t;++i){var h=e[i],l=st(h);for(r=0;r<t;++r){var u=e[r],f=st(u);if(!Ka(h,u))if(n.defs[h]===n.defs[u])vr([l,f]);else{var c=n(h,u);Ol(l,f,is(l,f,c.forward),is(f,l,c.inverse))}}}}export{ws as F,_y as G,Ey as M,gy as S,yy as T,My as V,zu as a,my as b,we as c,wt as p,xy as r};
